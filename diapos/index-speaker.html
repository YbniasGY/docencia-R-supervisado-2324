<!DOCTYPE html>
<html lang="es"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.294">

  <meta name="author" content="Grado en Ciencia de Datos Aplicada ‚Ä¢ curso 2023-2024">
  <title>Aprendizaje Supervisado I</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/data-science-2.jpeg" data-background-opacity="0.2" data-background-size="cover" class="quarto-title-block center">
  <h1 class="title">Aprendizaje Supervisado I</h1>
  <p class="subtitle">M√©todos de predicci√≥n lineal</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Grado en Ciencia de Datos Aplicada ‚Ä¢ curso 2023-2024 
</div>
</div>
</div>

</section>
<section>
<section id="empieza-lo-buenoempieza-la-modelizaci√≥n" class="title-slide slide level1 center">
<h1>Empieza lo bueno‚Ä¶empieza la modelizaci√≥n</h1>
<p><span style="color:#444442;"><strong>Vamos a juntar las piezas del puzzle para hacer ¬´magia¬ª</strong></span></p>
</section>
<section id="buenas" class="slide level2">
<h2>¬°Buenas!</h2>
<p><span class="hl-green"><strong>Correo</strong></span>: <strong><a href="mailto:javalv09@ucm.es" class="email">javalv09@ucm.es</a></strong>. <span class="hl-green"><strong>Despacho</strong></span>: 722 (3¬™ planta). <span class="hl-green"><strong>Tutor√≠as</strong></span>: lunes (14:30-16:00), martes (13:00-15:00) y viernes (13:00-14:00).</p>
<div class="columns">
<div class="column" style="width:30%;">
<p><img data-src="img/me.jpeg" class="quarto-discovered-preview-image"></p>
</div><div class="column" style="width:70%;">
<div>
<ul>
<li class="fragment"><p><span class="hl-yellow"><strong>Javier √Ålvarez Li√©bana</strong></span>, de Carabanchel (Bajo).</p></li>
<li class="fragment"><p>Licenciado en Matem√°ticas (UCM). <span class="hl-yellow"><strong>Doctorado en estad√≠stica</strong></span> (UGR).</p></li>
<li class="fragment"><p>Encargado de la <span class="hl-yellow"><strong>visualizaci√≥n y an√°lisis de datos covid</strong></span> del Principado de Asturias (2021-2022).</p></li>
<li class="fragment"><p>Miembro de la <span class="hl-yellow"><strong>Sociedad Espa√±ola de Estad√≠stica e IO</strong></span> y la <span class="hl-yellow"><strong>Real Sociedad Matem√°tica Espa√±ola</strong></span>.</p></li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<p>Actualmente, <span class="hl-yellow"><strong>investigador y docente en la Facultad de Estad√≠stica de la UCM</strong></span>. Divulgando por <a href="https://twitter.com/dadosdelaplace"><strong>Twitter</strong></a> e <a href="https://instagram.com/javieralvarezliebana"><strong>Instagram</strong></a></p>
</div>
</section>
<section id="objetivos" class="slide level2">
<h2>Objetivos</h2>
<div class="columns">
<div class="column" style="width:37%;">
<p><img data-src="https://assets-global.website-files.com/6092cb6b4ac959f39728dd26/6188a97fa499b5fbfe410417_target%20(1).png"></p>
</div><div class="column" style="width:63%;">
<div>
<ul>
<li class="fragment"><p>Empezar a <span class="hl-yellow"><strong>relacionar asignaturas</strong></span> como matem√°ticas, inferencia y R.</p></li>
<li class="fragment"><p>Aprender los fundamentos del <span class="hl-yellow"><strong>aprendizaje estad√≠stico</strong></span> (ahora llamado Machine Learning o data science)</p></li>
<li class="fragment"><p>Pasar de los descriptivo a lo predictivo: <span class="hl-yellow"><strong>construir nuestros primeros modelos</strong></span></p></li>
<li class="fragment"><p>Entender en profundidad el contexto de la <span class="hl-yellow"><strong>predicci√≥n lineal</strong></span>.</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="evaluaci√≥n" class="slide level2">
<h2>Evaluaci√≥n</h2>
<ul>
<li><span class="hl-yellow"><strong>Asistencia</strong></span>. Se <span class="hl-purple"><strong>valorar√° muy positivamente</strong></span> la participaci√≥n. Si se <span class="hl-purple"><strong>restar√°n puntos si eres expulsado de clase</strong></span>: -0.3 la 1¬™ vez, -0.6 la 2¬™, -1.2 la 3¬™‚Ä¶</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Evaluaci√≥n continua</strong></span>: 1 <strong>examen a papel</strong> (25%), <strong>2 entregas R en clase</strong> (20%-30%) y <strong>entrega grupal √∫ltimo d√≠a</strong> (3-6p obligatoriamente, 25%)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Examen final</strong></span>:
<ul>
<li><span class="hl-purple"><strong>Menos de un 6 (sin la grupal)</strong></span> -&gt; examen de R en lugar de la grupal.</li>
<li><span class="hl-purple"><strong>M√°s de un 6.5 (con la grupal)</strong></span> -&gt; podr√°s decidir <strong>peso del final entre un 20% y un 100%</strong>.</li>
<li><span class="hl-purple"><strong>Entre 5 y 6.5 (con la grupal)</strong></span> -&gt; podr√°s decidir <strong>peso del final entre un 40% y un 100%</strong>.</li>
<li><span class="hl-purple"><strong>Por debajo de 5 (con la grupal)</strong></span> -&gt; podr√°s decidir <strong>peso del final entre un 70% y un 100%</strong>.</li>
</ul></li>
</ul>
</div>
</section>
<section id="planificaci√≥n" class="slide level2">
<h2>Planificaci√≥n</h2>
<ul>
<li><p><span class="hl-yellow"><strong>Entrega I (20%)</strong></span>: semana 27-29 de febrero de 2024</p></li>
<li><p><span class="hl-yellow"><strong>Entrega II (30%)</strong></span>: semana 2-4 de abril de 2024</p></li>
<li><p><span class="hl-yellow"><strong>Parcial con papel y boli (25%)</strong></span>: 16-18 de abril de 2024</p></li>
<li><p><span class="hl-yellow"><strong>Entrega grupal (25%)</strong></span>: 9 de mayo de 2024 (incluyendo lo visto hasta el 30 de abril)</p></li>
</ul>
<p>&nbsp;</p>
<p>(se admiten propuestas)</p>
<div class="fragment">
<p><span class="hl-yellow"><strong>Clase a recuperar otro d√≠a</strong></span>: clase del 21 de marzo.</p>
</div>
</section>
<section id="materiales" class="slide level2">
<h2>Materiales</h2>
<ul>
<li><span class="hl-yellow"><strong>Diapositivas</strong></span>: las diapositivas que usaremos en el aula a lo largo del curso, estructuradas por clases, estar√°n disponibles y actualizadas en <strong><a href="https://javieralvarezliebana.es/docencia-R-supervisado-2324/diapos" class="uri">https://javieralvarezliebana.es/docencia-R-supervisado-2324/diapos</a></strong></li>
</ul>
<p>En el men√∫ de las diapositivas (abajo a la izquierda) tienes una <span class="hl-yellow"><strong>opci√≥n para descargarlas en pdf</strong></span> en <code>Tools</code> (consejo: no lo hagas hasta el final del curso ya que ir√°n modific√°ndose)</p>
<p>&nbsp;</p>
<ul>
<li><p><span class="hl-yellow"><strong>Material</strong></span>: <a href="https://github.com/dadosdelaplace/docencia-R-supervisado-2324/tree/main/material"><strong>scripts de cada tema</strong></a> y materiales extras</p></li>
<li><p><span class="hl-yellow"><strong>Res√∫menes de paquetes</strong></span>: <a href="https://github.com/dadosdelaplace/docencia-R-supervisado-2324/tree/main/fichas%20paquetes"><strong>chuletas de los paquetes</strong></a> en formato .pdf</p></li>
</ul>
</section>
<section id="requisitos" class="slide level2">
<h2>Requisitos</h2>
<p>Para el curso los √∫nicos requisitos ser√°n:</p>
<ol type="1">
<li><p><span class="hl-yellow"><strong>Conexi√≥n a internet</strong></span> (para la descarga de algunos datos y paquetes).</p></li>
<li><p><span class="hl-yellow"><strong>Instalar R y RStudio</strong></span>: la descarga la haremos (gratuitamente) desde <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a> y <a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></p></li>
<li><p>Se dar√°n por asumido conocimientos aprendidos de <span class="hl-yellow"><strong>R base, tidyverse y ggplot</strong></span></p></li>
<li><p>Se dar√°n por asumido conocimientos aprendidos de <span class="hl-yellow"><strong>Quarto, diapositivas en Quarto y Github</strong></span>. Para las entregas <span class="hl-purple"><strong>SOLO SE VALORAR√Å</strong></span> la salida html correspodiente.</p></li>
<li><p><span class="hl-yellow"><strong>Recomendable</strong></span>: saber usar la calculadora en modo estad√≠stico.</p></li>
</ol>
</section>
<section id="listado-de-clases" class="slide level2">
<h2>Listado de clases</h2>
<ul>
<li><a href="#/clase-1"><strong>Clase 1</strong></a>: repaso de descriptiva</li>
<li><a href="#/clase-2"><strong>Clase 2</strong></a>: importancia de la visualizaci√≥n</li>
<li><a href="#/clase-3"><strong>Clase 3</strong></a>: intro al aprendizaje estad√≠stico. Sesgo vs varianza. Supervisado vs no supervisado. Correlaci√≥n vs dependencia vs causalidad.</li>
</ul>
</section></section>
<section>
<section id="clase-1" class="title-slide slide level1 center">
<h1>Clase 1: repaso</h1>
<p><span style="color:#444442;"><strong>Objetivo de la predicci√≥n lineal. Concepto de linealidad. Repaso de estad√≠stica descriptiva</strong></span></p>
</section>
<section id="qu√©-es-predecir" class="slide level2">
<h2>¬øQu√© es predecir?</h2>
<p>Como veremos m√°s adelante, en esta asignatura vamos a tratar principalmente lo que se conoce el aprendizaje estad√≠stico como <span class="hl-yellow"><strong>predicci√≥n (continua)</strong></span></p>
<div class="fragment">
<p>Dada una <span class="hl-yellow"><strong>variable objetivo (variable dependiente)</strong></span>, y con la informaci√≥n aportada por un conjunto de <span class="hl-yellow"><strong>variables predictoras (covariables)</strong></span>, el objetivo ser√° construir un modelo que consiga dar una estimaci√≥n/predicci√≥n lo ¬´mejor posible¬ª</p>
</div>
<div class="fragment">
<p>Es importante que - de momento - distingamos dos conceptos:</p>
<ul>
<li><span class="hl-yellow"><strong>Estimaci√≥n</strong></span>: el modelo aprende de unos datos e intenta estimar dichos valores que ha usado.</li>
<li><span class="hl-yellow"><strong>Predicci√≥n</strong></span>: el modelo aprende de unos datos e intenta estimar valores que el <strong>modelo no conoce</strong>.</li>
</ul>
<p>M√°s adelante los llamaremos ¬´predicci√≥n en train¬ª y ¬´predicci√≥n en test¬ª</p>
</div>
</section>
<section id="qu√©-es-la-linealidad" class="slide level2">
<h2>¬øQu√© es la linealidad?</h2>
<p>En matem√°ticas decimos que una funci√≥n <span class="math inline">\(f(x)\)</span> es <span class="hl-yellow"><strong>lineal</strong></span> cuando se cumple:</p>
<ul>
<li><p><span class="hl-purple"><strong>Propiedad aditiva</strong></span>: <span class="math inline">\(f(x + y) = f(x) + f(y)\)</span></p></li>
<li><p><span class="hl-purple"><strong>Propiedad homog√©nea</strong></span>: <span class="math inline">\(f(k*x) = k*f(x)\)</span> (donde <span class="math inline">\(k\)</span> es una constante en <span class="math inline">\(\mathbb{R}\)</span>).</p></li>
</ul>
<p>Ambas se pueden resumir en <span class="math inline">\(f(a*x + b*y) = a*f(x) + b*f(y)\)</span></p>
<div class="fragment">
<p>En estad√≠stica llamamos <span class="hl-yellow"><strong>modelo de predicci√≥n lineal</strong></span> a un modelo que usa la informaci√≥n de covariables <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span>, de manera que su informaci√≥n siempre <span class="hl-yellow"><strong>se relacionen entre s√≠ con sumas y restas</strong></span>.</p>
<ul>
<li><p><span class="hl-green"><strong>Ejemplos lineales</strong></span>: <span class="math inline">\(y = 2*x_1 - 3\)</span> o <span class="math inline">\(y = 4 - \frac{x_1}{2} + 3*x_2\)</span></p></li>
<li><p><span class="hl-red"><strong>Ejemplos no lineales</strong></span>: <span class="math inline">\(y = 2*\frac{1}{x_1}\)</span> o <span class="math inline">\(y = 4 - x_{1}^{2} - x_2\)</span> o <span class="math inline">\(y = ln(x_1) + cos(x_2)\)</span></p></li>
</ul>
<p>En general son modelos que se pueden representar con rectas (una sola predictora), planos (dos predictoras), etc.</p>
</div>
</section>
<section id="repaso-continua-vs-discreta" class="slide level2">
<h2>Repaso: continua vs discreta</h2>
<ul>
<li><p><strong>Caracteres</strong>: cada una de las caracter√≠sticas o cualidades que se podr√≠an medir o analizar para cada individuo de la poblaci√≥n (y de los que disponemos el valor para cada individuo de la muestra).</p></li>
<li><p><strong>Modalidades</strong>: diferentes valores que puede adoptar una caracter√≠stica o variable.</p></li>
</ul>
<p>&nbsp;</p>
<p>Como veremos m√°s adelante, en el √°mbito del aprendizaje estad√≠stico va a ser fundamental tener clara la diferencia entre una <span class="hl-purple"><strong>variable cualitativa y cuantitativa</strong></span> y entre <span class="hl-yellow"><strong>variable continua y otra discreta</strong></span>. ¬øCu√°l es la diferencia?</p>
</section>
<section id="repaso-continua-vs-discreta-1" class="slide level2">
<h2>Repaso: continua vs discreta</h2>
<p>Imagina las siguientes variables:</p>
<ul>
<li>¬øTienes hermanos? (si/no)</li>
<li>Color de zapatillas</li>
<li>Nivel de estudios</li>
<li>N√∫mero de hermanos</li>
<li>N√∫mero de pelos en la cabeza</li>
<li>Resultado de un dado</li>
<li>Temperatura ¬∫C</li>
<li>Estatura o peso</li>
</ul>
<p>&nbsp;</p>
<p><span class="hl-yellow"><strong>¬øCu√°l es la diferencia entre ellas</strong></span></p>
</section>
<section id="repaso-continua-vs-discreta-2" class="slide level2">
<h2>Repaso: continua vs discreta</h2>
<ul>
<li><span class="hl-yellow"><strong>Cualitativas</strong></span>: <strong>cualidades o categor√≠as</strong>. Ejemplos: sexo, estado civil, estudios, etc.
<ul>
<li><span class="hl-purple"><strong>Ordinales</strong></span>: admiten relaci√≥n jerarquica (suspenso-aprobado-bien, sano-leve-grave).</li>
<li><span class="hl-purple"><strong>Nominales</strong></span>: no tienen asociada una jerarqu√≠a (sexo, religi√≥n, color de zapatillas, etc).</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Cuantitativas</strong></span>: cuantificaci√≥n num√©rica.
<ul>
<li><span class="hl-purple"><strong>Discretas</strong></span> (barras): se pueden contar y enumerar (aunque sean infinitos) (granos de arena, n¬∫ hermanos, etc) ‚Üí se <strong>suman</strong></li>
<li><span class="hl-purple"><strong>Continuas</strong></span>: toman infinitos valores y entre dos valores cualesquiera hay a su vez infinitas opciones (estatura, peso, etc) ‚Üí se <strong>integran</strong></li>
</ul></li>
</ul>
</div>
</section>
<section id="repaso-continua-vs-discreta-3" class="slide level2">
<h2>Repaso: continua vs discreta</h2>

<img data-src="img/vitro-fuego-discretas.jpg" class="r-stretch"></section>
<section id="repaso-poblaci√≥n-vs-muestra" class="slide level2">
<h2>Repaso: poblaci√≥n vs muestra</h2>
<p>En estad√≠stica llamaremos <span class="hl-yellow"><strong>poblaci√≥n</strong></span> al universo te√≥rico, al colectivo de individuos a estudiar, o de posibles elementos/eventos de los podr√≠amos tener observaciones (ejemplo: 47 millones de espa√±oles).</p>
<div class="fragment">
<p>Cada uno de esos elementos o eventos se llaman <strong>individuos</strong>.</p>
</div>
<div class="fragment">
<p>Aunque nuestro objetivo ser√° conocer algunas de las propiedades de la poblaci√≥n, la <span class="hl-red"><strong>poblaci√≥n suele ser inaccesible</strong></span> en su totalidad ‚Üí <span class="hl-green"><strong>SELECCI√ìN</strong></span> de un conjunto de individuos</p>
</div>
</section>
<section id="repaso-poblaci√≥n-vs-muestra-1" class="slide level2">
<h2>Repaso: poblaci√≥n vs muestra</h2>
<p>Para ello en estad√≠stica usamos lo que se conoce como <span class="hl-yellow"><strong>muestra</strong></span>: un subconjunto finito, de tama√±o <span class="math inline">\(n\)</span>, ¬´representativo¬ª de la poblaci√≥n (en estudio estad√≠stico realizado sobre la totalidad de una poblaci√≥n se denomina <strong>censo</strong>).</p>
<div class="fragment">
<p>Para ello existe una rama conocida como <span class="hl-yellow"><strong>muestreo</strong></span></p>
<ul>
<li><p><span class="hl-purple"><strong>Probabil√≠stico</strong></span>: todos los individuos tienen oportunidad de ser seleccionados, y la probabilidad de que suceda puede ser modelizada (al azar, por estratos, etc).</p></li>
<li><p><span class="hl-purple"><strong>No probabil√≠stico</strong></span>: algunos elementos de la poblaci√≥n no tienen posibilidad de selecci√≥n (sesgo de exclusi√≥n), o su probabilidad no puede ser conocida.</p></li>
</ul>
</div>
<div class="fragment">
<p>ü§î ¬øSer√≠a adecuado hacer una encuesta sobre el streamer favorito de los j√≥venes a trav√©s de una encuesta realizada por tel√©fono fijo?</p>
</div>
</section>
<section id="sesgos-en-el-muestreo" class="slide level2">
<h2>Sesgos en el muestreo</h2>

<img data-src="img/sampling-bias.jpg" class="r-stretch"><div class="fragment">
<p><span class="hl-yellow"><strong>Sesgo de selecci√≥n</strong></span>: aparece cuando no se tiene en cuenta la forma en la que se han recogido los datos.</p>
</div>
</section>
<section id="sesgos-en-el-muestreo-1" class="slide level2">
<h2>Sesgos en el muestreo</h2>

<img data-src="img/dewey.jpg" class="r-stretch"><p>El ejemplo m√°s famoso es el caso <span class="hl-yellow"><strong>¬´Dewey defeats Truman¬ª (Dewer derrota a Truman)</strong></span>, el titular con el que abri√≥ el Chicago Tribune en 1948, el mismo d√≠a en el que Truman gan√≥ al rep√∫blicano Dewer en las elecciones de 1948: sin esperar a los resultados, se basaron en una encuesta telef√≥nica (sin contar con el sesgo que, en aquella √©poca, solo la clase alta ten√≠a tel√©fono).</p>
</section>
<section id="sesgos-en-el-muestreo-2" class="slide level2">
<h2>Sesgos en el muestreo</h2>

<img data-src="img/superviviente.jpg" class="r-stretch"><p>¬øD√≥nde reforzar√≠as los aviones?</p>
</section>
<section id="sesgos-en-el-muestreo-3" class="slide level2">
<h2>Sesgos en el muestreo</h2>

<img data-src="img/superviviente.jpg" class="r-stretch"><p>El <span class="hl-yellow"><strong>sesgo del superviviente</strong></span> (un tipo de sesgo de selecci√≥n) aparece cuando se toma una muestra de un fen√≥meno ignorando si los individuos elegidos tienen las mismas opciones respecto al mismo.</p>
</section>
<section id="repaso-medidas-de-centralizaci√≥n" class="slide level2">
<h2>Repaso: medidas de centralizaci√≥n</h2>
<ul>
<li><span class="hl-yellow"><strong>Media</strong></span>: dada una muestra <span class="math inline">\(\boldsymbol{x} =\left(x_1, \ldots, x_n \right)\)</span>, la media muestral <span class="math inline">\(\overline{x}\)</span> se define como la <strong>suma de todos los valores dividida por el tama√±o muestral</strong></li>
</ul>
<p><span class="math display">\[\overline{x} = \frac{1}{n} \sum_{i=1}^{n} x_i\]</span></p>
<div class="fragment">
<p><span class="hl-purple"><strong>Geom√©tricamente</strong></span>: es el <strong>valor ¬´m√°s cercano¬ª de todos los datos a la vez</strong> (minimiza las distancias al cuadrado)</p>
</div>
</section>
<section id="media-muestral" class="slide level2">
<h2>Media muestral</h2>
<p><span class="hl-green"><strong>VENTAJAS</strong></span></p>
<ul>
<li>F√°cil de calcular y entender</li>
<li>F√°cil y eficiente de programar</li>
<li>Siempre existe (para cuantitativas)</li>
</ul>
<div class="fragment">
<p><span class="hl-red"><strong>DESVENTAJAS</strong></span></p>
<ul>
<li>No es un valor de los datos (la media de {1, 2, 3, 4} es 2.5)</li>
<li><strong>Poco robusta</strong> (valores at√≠picos le afectan mucho)</li>
<li>Solo se puede definir para variables cuantitativas</li>
</ul>
</div>
</section>
<section id="repaso-medidas-de-centralizaci√≥n-1" class="slide level2">
<h2>Repaso: medidas de centralizaci√≥n</h2>
<ul>
<li><span class="hl-yellow"><strong>Mediana</strong></span>: dada una muestra <span class="math inline">\(\boldsymbol{x} =\left(x_1, \ldots, x_n \right)\)</span>, la mediana muestral se define como el <strong>valor que es mayor o igual que al menos el 50%</strong>, y menor igual que al menos el 50% de los datos</li>
</ul>
<p><span class="math display">\[Me_{x} = \arg \min_{x_i} \left\lbrace F_i &gt; 0.5 \right\rbrace, \quad Me_x = e_{i-1} + \frac{0.5 - F_{i-1}}{F_i - F_{i-1} }a_i\]</span></p>
<p>La mediana es el <span class="hl-purple"><strong>valor de en medio</strong></span> si ordenamos los datos (y si se pueden ordenar‚Ä¶)</p>
</section>
<section id="mediana-muestral" class="slide level2">
<h2>Mediana muestral</h2>
<p><span class="hl-green"><strong>VENTAJAS</strong></span></p>
<ul>
<li>Suele ser un valor de la muestra</li>
<li>Un poco m√°s robusta que la media</li>
</ul>
<div class="fragment">
<p><span class="hl-red"><strong>DESVENTAJAS</strong></span></p>
<ul>
<li>Muy ineficiente (requiere un algoritmo de ordenaci√≥n)</li>
<li>Solo definida para cuantitativas o cualitativas ordinales</li>
</ul>
</div>
</section>
<section id="repaso-medidas-de-centralizaci√≥n-2" class="slide level2">
<h2>Repaso: medidas de centralizaci√≥n</h2>
<ul>
<li><span class="hl-yellow"><strong>Moda</strong></span>: dada una muestra <span class="math inline">\(\boldsymbol{x} =\left(x_1, \ldots, x_n \right)\)</span>, la moda muestral se define como el <strong>valor o valores m√°s repetidos</strong> (en caso de que existan).</li>
</ul>
<p><span class="math display">\[Mo_x = \arg \max_{x_i} f_i, \quad Mo_x = e_{i-1} + \frac{d_i - d_{i-1}}{\left(d_i - d_{i-1} \right) + \left(d_i - d_{i+1} \right)}a_i\]</span></p>
<div class="fragment">
<p><span class="hl-purple"><strong>Gr√°ficamente</strong></span>: representa el ¬´pico¬ª de un diagrama de barras o un histograma</p>
</div>
</section>
<section id="moda-muestral" class="slide level2">
<h2>Moda muestral</h2>
<p><span class="hl-green"><strong>VENTAJAS</strong></span></p>
<ul>
<li>Es un valor de la muestra</li>
<li>Muy robusta</li>
<li><strong>Se puede calcular para cualquier</strong> cuanti o cuali</li>
</ul>
<div class="fragment">
<p><span class="hl-red"><strong>DESVENTAJAS</strong></span></p>
<ul>
<li>No siempre existe (amodal) y pueden existir varias (bimodal, trimodal, etc)</li>
<li>Poco usada en inferencia</li>
</ul>
</div>
</section>
<section id="repaso-medidas-de-centralizaci√≥n-3" class="slide level2">
<h2>Repaso: medidas de centralizaci√≥n</h2>

<img data-src="img/ine-salarios-oculto.jpg" class="r-stretch"><p><strong>¬øCu√°l es la mediana, la media y la moda?</strong></p>
</section>
<section id="repaso-medidas-de-centralizaci√≥n-4" class="slide level2">
<h2>Repaso: medidas de centralizaci√≥n</h2>

<img data-src="img/ine-salarios.jpg" class="r-stretch"></section>
<section id="repaso-medidas-de-dispersi√≥n" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>

<img data-src="img/iker-jimenez.jpg" class="r-stretch"><p>¬øQu√© tiene que ver la imagen con la dispersi√≥n?</p>
</section>
<section id="repaso-medidas-de-dispersi√≥n-1" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>

<img data-src="img/extremos.jpg" class="r-stretch"><p>El cambio clim√°tico no solo es porque aumente la <span class="hl-yellow"><strong>temperatura media (centralizaci√≥n)</strong></span> sino por la aparici√≥n cada vez m√°s frecuente de fen√≥menos extremos</p>
<p>Aumento de la <span class="hl-yellow"><strong>variabilidad</strong></span> ‚Üí aumento de la <span class="hl-yellow"><strong>DISPERSI√ìN</strong></span></p>
</section>
<section id="repaso-medidas-de-dispersi√≥n-2" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>
<p><span class="hl-yellow"><strong>¬øC√≥mo medir lo que se alejan los datos de la media?</strong></span></p>
<div class="fragment">
<p><img data-src="img/primera-idea-varianza.jpg"></p>
<p>Una <strong>primera idea</strong> podr√≠a ser <span class="hl-yellow"><strong>medir la distancia de cada dato al centro</strong></span>, es decir, restar cada dato de la media, y despu√©s realizar su promedio.</p>
</div>
</section>
<section class="slide level2">


<img data-src="img/wait-for-it.jpg" class="r-stretch"></section>
<section id="repaso-medidas-de-dispersi√≥n-3" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>
<p>Imagina que tenemos la siguiente muestra <span class="math inline">\(X = \left\lbrace -5, -3, -1, 0, 1, 3, 5 \right\rbrace\)</span>.</p>
<p><strong>¬øCu√°nto vale la media?</strong></p>
<div class="fragment">
<p>La media vale 0 y la distancia a ella es‚Ä¶la propia muestra <span class="math inline">\(\left\lbrace -5, -3, -1, 0, 1, 3, 5 \right\rbrace\)</span>. <strong>¬øCu√°l es el promedio de dichas distancias?</strong></p>
</div>
<div class="fragment">
<p>Pues‚Ä¶de nuevo vale 0.</p>
</div>
<div class="fragment">
<p>Si la dispersi√≥n es 0‚Ä¶<span class="hl-red"><strong>¬øno hay dispersi√≥n?</strong></span> ¬øNo deber√≠a de dar 0 solo cuando los datos sean constantes?</p>
</div>
</section>
<section id="repaso-medidas-de-dispersi√≥n-4" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>
<p>Para <strong>evitar que se cancelen</strong> los signos lo que haremos ser√° calcular el <span class="hl-yellow"><strong>promedio PERO de las distancias al cuadrado</strong></span>, la conocida como <span class="hl-yellow"><strong>varianza</strong></span></p>
<p><span class="math display">\[s_{x}^{2} = \frac{1}{n} \sum_{i=1}^{n} \left(x_i - \overline{x} \right)^2 = \overline{x^2} - \overline{x}^2 \]</span></p>
<div class="fragment">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Cuidado</strong></p>
</div>
<div class="callout-content">
<p>Tomar el valor absoluto (para evitar que se cancelen los signos) suele ser una mala idea en matem√°ticas (no es derivable como funci√≥n).</p>
</div>
</div>
</div>
</div>
</section>
<section id="repaso-medidas-de-dispersi√≥n-5" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>
<p><span class="hl-red"><strong>Problema</strong></span>: si los datos est√°n en metros, la varianza estar√° en‚Ä¶metros cuadrados</p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<p>¬øTiene sentido medir la dispersi√≥n de nuestra estatura en baldosas?</p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/albert-rivera.jpg"></p>
</div>
</div>
</div>
</section>
<section id="repaso-medidas-de-dispersi√≥n-6" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>
<p>Para tener una <span class="hl-yellow"><strong>medida de dispersi√≥n en las unidades de los datos</strong></span> calcularemos la <span class="hl-yellow"><strong>desviaci√≥n t√≠pica</strong></span>, como la ra√≠z cuadrada de la varianza</p>
<p><span class="math display">\[s_{x} = \sqrt{s_{x}^{2}} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} \left(x_i - \overline{x} \right)^2} = \sqrt{\overline{x^2} - \overline{x}^2}\]</span></p>
</section>
<section id="repaso-medidas-de-dispersi√≥n-7" class="slide level2">
<h2>Repaso: medidas de dispersi√≥n</h2>
<p>Todav√≠a tenemos un peque√±o problema.</p>
<p>Imagina que queremos <strong>comparar la dispersi√≥n de dos conjuntos</strong> de datos, estaturas de personas y di√°metros de n√∫cleos de c√©lulas. Y Supongamos que las medias son 170 cm y 5 micr√≥metros, y la desviaci√≥n t√≠pica de 1 cm y 1.5 micr√≥metros.</p>
<p><span class="hl-yellow"><strong>¬øQu√© conjunto de datos es m√°s disperso?</strong></span></p>
<div class="fragment">
<p>Para tener una <strong>medida de dispersi√≥n adimensional</strong> definiremos el <span class="hl-yellow"><strong>coeficiente de variaci√≥n</strong></span></p>
<p><span class="math display">\[CV_{x} = \frac{s_{x}}{\left| \overline{x} \right|}\]</span></p>
</div>
</section>
<section id="repaso-medidas-de-localizaci√≥n" class="slide level2">
<h2>Repaso: medidas de localizaci√≥n</h2>
<p>Las <span class="hl-yellow"><strong>medidas de posici√≥n o localizaci√≥n</strong></span> nos localizan los datos, siendo valores que <strong>nos dividen un conjunto ordenado</strong> en subconjuntos del mismo tama√±o (ejemplo: mediana es percentil 50).</p>
<ul>
<li><p><strong>Percentil</strong>: valores <span class="math inline">\(P_{\alpha}\)</span> del conjunto ordenado que dejan por debajo, al menos, el <span class="math inline">\(\alpha\)</span>% de datos y <span class="math inline">\(\alpha\)</span>% por encima.<br>
</p></li>
<li><p><strong>Decil</strong>: valores <span class="math inline">\(D_{\alpha}\)</span> que dividen los datos en 10 partes iguales.</p></li>
<li><p><strong>Cuartil</strong>: valores <span class="math inline">\(C_{\alpha}\)</span> o <span class="math inline">\(q_{\alpha}\)</span> que dividen los datos en 4 partes iguales.</p></li>
</ul>
</section>
<section id="repaso-covarianza-y-correlaci√≥n" class="slide level2">
<h2>Repaso: covarianza y correlaci√≥n</h2>
<p><span class="hl-yellow"><strong>¬øQu√© es en realidad la varianza?</strong></span></p>
<div class="fragment">
<p>La <span class="hl-yellow"><strong>varianza es el promedio de las desviaciones al cuadrado</strong></span> (respecto a la media), apareciendo dos veces dicha desviaci√≥n: puede ser entendida como una <span class="hl-yellow"><strong>medida que cuantifica la relaci√≥n de una variable CONSIGO MISMA</strong></span></p>
</div>
<div class="fragment">
<p><span class="hl-purple"><strong>¬øY si qui√©semos medir la relaci√≥n de una variable X respecto a otra variable Y (en lugar de consigo misma)?</strong></span></p>
</div>
</section>
<section id="repaso-covarianza-y-correlaci√≥n-1" class="slide level2">
<h2>Repaso: covarianza y correlaci√≥n</h2>
<p><span class="math display">\[s_{x}^{2} = \frac{1}{n} \sum_{i=1}^{n} \left(x_i - \overline{x} \right)^2 = \overline{x^2} - \overline{x}^2 \quad \text{(varianza)}\]</span></p>
<p>La idea detr√°s de la <span class="hl-yellow"><strong>covarianza</strong></span> es justo esa: sustituir una de esas desviaciones de la X por la desviaci√≥n de la Y.</p>
<p><span class="math display">\[s_{xy} = \frac{1}{n} \sum_{i=1}^{n} \left(x_i - \overline{x} \right)\left(y_i - \overline{y} \right) = \overline{x*y} - \overline{x}*\overline{y}\]</span></p>
</section>
<section id="repaso-covarianza-y-correlaci√≥n-2" class="slide level2">
<h2>Repaso: covarianza y correlaci√≥n</h2>
<p>Es importante entender algunas <span class="hl-yellow"><strong>propiedades de la covarianza</strong></span></p>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Signo</strong></span>: la covarianza puede ser tanto positiva como negativa como 0: al eliminar el cuadrado de la varianza, ya no es necesario que sea positiva</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>¬øQu√© cuantifica?</strong></span> La covarianza mide la <span class="hl-red"><strong>relaci√≥n LINEAL</strong></span> (en torno a una recta) entre dos variables</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>¬øQu√© dice su signo?</strong></span> El signo de la covarianza nos indicar√° la <span class="hl-yellow"><strong>direcci√≥n de la dependencia lineal</strong></span>: si es positiva, la relaci√≥n ser√° creciente (cuando X crece, Y crece); si es negativa, la relaci√≥n ser√° decreciente (cuando X crece, Y decrece)</li>
</ul>
</div>
</section>
<section id="repaso-covarianza-y-correlaci√≥n-3" class="slide level2">
<h2>Repaso: covarianza y correlaci√≥n</h2>
<p>Al igual que pasaba con la varianza, la <span class="hl-yellow"><strong>covarianza depende de las unidades y magnitudes</strong></span> de los datos, as√≠ que lo que haremos ser√° <span class="hl-yellow"><strong>estandarizar la covarianza</strong></span>. Definiremos la <span class="hl-yellow"><strong>coeficiente correlaci√≥n lineal (de Pearson)</strong></span> como la covarianza dividida entre el producto de las desviaciones t√≠picas (adimensional)</p>
<p><span class="math display">\[r_{xy} = \rho_{xy} = \frac{s_{xy}}{s_x s_y}\]</span></p>
<div class="fragment">
<p>Tiene el <span class="hl-yellow"><strong>mismo signo que la covarianza</strong></span> (el denominador es siempre positivo) y sus <span class="hl-yellow"><strong>valores siempre est√°n entre -1 y 1</strong></span></p>
<ul>
<li>m√°s cerca de -1 o 1 ‚Üí relaci√≥n lineal m√°s fuerte</li>
<li>m√°s cerca de 0 ‚Üí ausencia de relaci√≥n <strong>LINEAL</strong></li>
</ul>
</div>
</section>
<section id="repaso-covarianza-y-correlaci√≥n-4" class="slide level2">
<h2>Repaso: covarianza y correlaci√≥n</h2>

<img data-src="img/correlaciones.jpg" class="r-stretch"></section></section>
<section>
<section id="clase-2" class="title-slide slide level1 center">
<h1>Clase 2: importancia del dataviz</h1>
<p><span style="color:#444442;"><strong>¬øBasta con calcular la correlaci√≥n para cuantificar si un ajuste es adecuado?</strong></span></p>
</section>
<section id="conjunto-anscombe" class="slide level2">
<h2>Conjunto anscombe</h2>
<p>En el paquete <code>{datasets}</code> se encuentra el dataset conocido como <span class="hl-yellow"><strong>cuarteto de Anscombe</strong></span>, un dataset que cuenta con 4 conjuntos de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>anscombe_tb <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(datasets<span class="sc">::</span>anscombe)</span>
<span id="cb1-2"><a href="#cb1-2"></a>anscombe_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 √ó 8
      x1    x2    x3    x4    y1    y2    y3    y4
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    10    10    10     8  8.04  9.14  7.46  6.58
 2     8     8     8     8  6.95  8.14  6.77  5.76
 3    13    13    13     8  7.58  8.74 12.7   7.71
 4     9     9     9     8  8.81  8.77  7.11  8.84
 5    11    11    11     8  8.33  9.26  7.81  8.47
 6    14    14    14     8  9.96  8.1   8.84  7.04
 7     6     6     6     8  7.24  6.13  6.08  5.25
 8     4     4     4    19  4.26  3.1   5.39 12.5 
 9    12    12    12     8 10.8   9.13  8.15  5.56
10     7     7     7     8  4.82  7.26  6.42  7.91
11     5     5     5     8  5.68  4.74  5.73  6.89</code></pre>
</div>
</div>
<div class="fragment">
<p><span class="hl-yellow"><strong>Primera tarea: convierte a tidydata</strong></span></p>
</div>
</section>
<section id="conjunto-anscombe-1" class="slide level2">
<h2>Conjunto anscombe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>anscombe_x <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  anscombe_tb <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> x1<span class="sc">:</span>x4, <span class="at">names_to =</span> <span class="st">"dataset"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"y"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">mutate</span>(<span class="at">dataset =</span> <span class="fu">str_remove_all</span>(dataset, <span class="st">"x"</span>))</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a>anscombe_y <span class="ot">&lt;-</span> </span>
<span id="cb3-8"><a href="#cb3-8"></a>  anscombe_tb <span class="sc">|&gt;</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> y1<span class="sc">:</span>y4, <span class="at">names_to =</span> <span class="st">"dataset"</span>, <span class="at">values_to =</span> <span class="st">"y"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="#cb3-10"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">"x"</span>), <span class="sc">-</span>dataset)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>anscombe_tidy <span class="ot">&lt;-</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  anscombe_x <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="st">"y"</span> <span class="ot">=</span> anscombe_y<span class="sc">$</span>y)</span>
<span id="cb3-14"><a href="#cb3-14"></a>anscombe_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 44 √ó 3
   dataset     x     y
   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;
 1 1          10  8.04
 2 2          10  9.14
 3 3          10  7.46
 4 4           8  6.58
 5 1           8  6.95
 6 2           8  8.14
 7 3           8  6.77
 8 4           8  5.76
 9 1          13  7.58
10 2          13  8.74
# ‚Ñπ 34 more rows</code></pre>
</div>
</div>
</section>
<section id="conjunto-anscombe-2" class="slide level2">
<h2>Conjunto anscombe</h2>
<p><span class="hl-yellow"><strong>¬øQu√© caracter√≠sticas muestrales tienen?</strong></span> Calcula la media, varianza, desv. t√≠pica, covarianza y correlaci√≥n en cada dataset</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>anscombe_tidy <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">summarise</span>(<span class="at">mean_x =</span> <span class="fu">mean</span>(x), <span class="at">mean_y =</span> <span class="fu">mean</span>(y),</span>
<span id="cb5-3"><a href="#cb5-3"></a>            <span class="at">var_x =</span> <span class="fu">var</span>(x), <span class="at">var_y =</span> <span class="fu">var</span>(y),</span>
<span id="cb5-4"><a href="#cb5-4"></a>            <span class="at">sd_x =</span> <span class="fu">sd</span>(x), <span class="at">sd_y =</span> <span class="fu">sd</span>(y),</span>
<span id="cb5-5"><a href="#cb5-5"></a>            <span class="at">cov =</span> <span class="fu">cov</span>(x, y), <span class="at">cor =</span> <span class="fu">cor</span>(x, y), <span class="at">.by =</span> dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 9
  dataset mean_x mean_y var_x var_y  sd_x  sd_y   cov   cor
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1            9   7.50    11  4.13  3.32  2.03  5.50 0.816
2 2            9   7.50    11  4.13  3.32  2.03  5.5  0.816
3 3            9   7.5     11  4.12  3.32  2.03  5.50 0.816
4 4            9   7.50    11  4.12  3.32  2.03  5.50 0.817</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Si te fijas <span class="hl-yellow"><strong>todos los datasets tienen los mismos momentos</strong></span> muestrales, incluso tendr√≠an el mismo ajuste de regresi√≥n‚Ä¶¬øser√°n el mismo dataset desordenado?</p>
</div>
</section>
<section id="conjunto-anscombe-3" class="slide level2">
<h2>Conjunto anscombe</h2>
<p><span class="hl-yellow"><strong>Visualiza los 4 datasets</strong></span></p>
<div class="fragment">
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">ggplot</span>(anscombe_tidy) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> dataset), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dataset) <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-5-1.png" width="960"></p>
</div>
</div>
</div>
</section>
<section id="conjunto-anscombe-4" class="slide level2">
<h2>Conjunto anscombe</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"><p>Por suerte o por desgracia <span class="hl-red"><strong>no todo son matem√°ticas</strong></span>: antes de pensar que modelo es mejor para nuestros datos, es important√≠simo realizar un <span class="hl-yellow"><strong>an√°lisis exploratorio</strong></span> de los datos (incluyendo visualizaci√≥n)</p>
</section>
<section id="datasaurus" class="slide level2">
<h2>Datasaurus</h2>
<p>Podemos visualizarlo de manera a√∫n m√°s extrema con el dataset <code>datasaurus_dozen</code> del paquete <code>{datasauRus}</code> (ver m√°s en <a href="https://www.research.autodesk.com/publications/same-stats-different-graphs/" class="uri">https://www.research.autodesk.com/publications/same-stats-different-graphs/</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">library</span>(datasauRus)</span>
<span id="cb8-2"><a href="#cb8-2"></a>datasaurus_dozen <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">summarise</span>(<span class="at">mean_x =</span> <span class="fu">mean</span>(x), <span class="at">mean_y =</span> <span class="fu">mean</span>(y),</span>
<span id="cb8-4"><a href="#cb8-4"></a>            <span class="at">var_x =</span> <span class="fu">var</span>(x), <span class="at">var_y =</span> <span class="fu">var</span>(y),</span>
<span id="cb8-5"><a href="#cb8-5"></a>            <span class="at">sd_x =</span> <span class="fu">sd</span>(x), <span class="at">sd_y =</span> <span class="fu">sd</span>(y),</span>
<span id="cb8-6"><a href="#cb8-6"></a>            <span class="at">cov =</span> <span class="fu">cov</span>(x, y), <span class="at">cor =</span> <span class="fu">cor</span>(x, y), <span class="at">.by =</span> dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 √ó 9
   dataset    mean_x mean_y var_x var_y  sd_x  sd_y   cov     cor
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
 1 dino         54.3   47.8  281.  726.  16.8  26.9 -29.1 -0.0645
 2 away         54.3   47.8  281.  726.  16.8  26.9 -29.0 -0.0641
 3 h_lines      54.3   47.8  281.  726.  16.8  26.9 -27.9 -0.0617
 4 v_lines      54.3   47.8  281.  726.  16.8  26.9 -31.4 -0.0694
 5 x_shape      54.3   47.8  281.  725.  16.8  26.9 -29.6 -0.0656
 6 star         54.3   47.8  281.  725.  16.8  26.9 -28.4 -0.0630
 7 high_lines   54.3   47.8  281.  726.  16.8  26.9 -30.9 -0.0685
 8 dots         54.3   47.8  281.  725.  16.8  26.9 -27.2 -0.0603
 9 circle       54.3   47.8  281.  725.  16.8  26.9 -30.8 -0.0683
10 bullseye     54.3   47.8  281.  726.  16.8  26.9 -31.0 -0.0686
11 slant_up     54.3   47.8  281.  726.  16.8  26.9 -31.0 -0.0686
12 slant_down   54.3   47.8  281.  726.  16.8  26.9 -31.2 -0.0690
13 wide_lines   54.3   47.8  281.  726.  16.8  26.9 -30.1 -0.0666</code></pre>
</div>
</div>
</section>
<section id="datasaurus-1" class="slide level2">
<h2>Datasaurus</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">ggplot</span>(datasaurus_dozen <span class="sc">|&gt;</span> <span class="fu">filter</span>(dataset <span class="sc">!=</span> <span class="st">"wide_lines"</span>),</span>
<span id="cb10-2"><a href="#cb10-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> dataset)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)  <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>dataset, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section class="slide level2">

</section></section>
<section>
<section id="clase-3" class="title-slide slide level1 center">
<h1>Clase 3: profundizando en la correlaci√≥n</h1>
<p><span style="color:#444442;"><strong>Matrices de correlaci√≥n y covarianza. Correlaci√≥n vs causalidad vs dependencia</strong></span></p>
</section>
<section id="correlaci√≥n-lineal-sin-agrupar" class="slide level2">
<h2>Correlaci√≥n lineal: sin agrupar</h2>
<p>Como dec√≠amos, la idea detr√°s de la <span class="hl-yellow"><strong>covarianza</strong></span> es una ‚Äúvarianza‚Äù entre dos variales (la varianza es una covarianza de una variable consigo misma), midiendo el <strong>promedio de lo que se desv√≠a cada una respecto a su media</strong></p>
<p><span class="math display">\[s_{xy} = \frac{1}{n} \sum_{i=1}^{n} \left(x_i - \overline{x} \right)\left(y_i - \overline{y} \right) = \overline{x*y} - \overline{x}*\overline{y}\]</span></p>
<div class="fragment">
<p>Para calcularla en <code>R</code> basta con usar la funci√≥n <code>cov()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">drop_na</span>(mass, height) <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">summarise</span>(<span class="fu">cov</span>(mass, height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 1
  `cov(mass, height)`
                &lt;dbl&gt;
1                806.</code></pre>
</div>
</div>
</div>
</section>
<section id="correlaci√≥n-lineal-sin-agrupar-1" class="slide level2">
<h2>Correlaci√≥n lineal: sin agrupar</h2>
<p>Vamos a practicar una vez m√°s como <span class="hl-yellow"><strong>hacerlo a mano con el siguiente ejercicio</strong></span>.</p>
</section>
<section id="cor-lineal-sin-agrupar" class="slide level2">
<h2>Cor lineal: sin agrupar</h2>
<p>En la tabla inferior se han recopilado (del 2013 al 2022) la <strong>temperatura media en el mes de abril en Madrid (variable X, en ¬∫C)</strong> y el <strong>n√∫mero de d√≠as (variable Y) en el que el nivel de ozono super√≥ las 0.20 ppm (partes por mill√≥n)</strong></p>
<ul>
<li>¬øCu√°l fue media de d√≠as en los que se super√≥ umbral de ozono de 0.20 ppm?</li>
<li>¬øCu√°l fue media de d√≠as en los que se super√≥ umbral de ozono en los a√±os que la temperatura media en marzo super√≥ los 17.4¬∫C?</li>
<li>¬øCu√°l es su covarianza?</li>
</ul>

<img data-src="img/tabla-ej-covarianza-sin-agrupar.png" class="r-stretch"></section>
<section id="correlaci√≥n-lineal-sin-agrupar-2" class="slide level2">
<h2>Correlaci√≥n lineal: sin agrupar</h2>
<p>Repite el ejercicio con pocas l√≠neas de c√≥digo <code>R</code></p>
<ul>
<li>¬øCu√°l fue la media de d√≠as en los que se super√≥ el umbral de ozono de 0.20 ppm?</li>
<li>¬øCu√°l fue la media de d√≠as en los que se super√≥ el umbral de ozono en los a√±os que la temperatura media en marzo super√≥ los 17.4¬∫C?</li>
<li>¬øCu√°l es su covarianza?</li>
</ul>

<img data-src="img/tabla-ej-covarianza-sin-agrupar.png" class="r-stretch"></section>
<section id="correlaci√≥n-lineal-sin-agrupar-3" class="slide level2">
<h2>Correlaci√≥n lineal: sin agrupar</h2>
<p>Realiza lo que consideres tanto a mano como en <code>R</code></p>
<ul>
<li>¬øExiste alguna <strong>relaci√≥n de dependencia entre las variables</strong>? ¬øDe qu√© tipo? ¬øC√≥mo de fuerte o d√©bil es dicha relaci√≥n? ¬øEn qu√© direcci√≥n es dicha relaci√≥n?</li>
</ul>
<p><span class="math display">\[s_{xy} = \frac{1}{n} \sum_{i=1}^{n} \left(x_i - \overline{x} \right)\left(y_i - \overline{y} \right) = \overline{x*y} - \overline{x}*\overline{y}\]</span></p>
<p><span class="math display">\[r_{xy} = \rho_{xy} = \frac{s_{xy}}{s_x s_y}\]</span></p>
</section>
<section id="correlaci√≥n-lineal-sin-agrupar-4" class="slide level2">
<h2>Correlaci√≥n lineal: sin agrupar</h2>
<p>No s√© si te has fijado qu√© sucede cuando intentamos <span class="hl-yellow"><strong>calcular la covarianza/correlaci√≥n de varias variables</strong></span>, por ejemplo vamos a calcular la (cuasi)covarianza de todas las variables num√©ricas de starwars.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">cov</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               height       mass birth_year
height       955.5071   715.3057  -2138.334
mass         715.3057 46313.2034  17402.547
birth_year -2138.3336 17402.5466  28603.045</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Podemos usar la funci√≥n <code>cov()</code> sin m√°s, fuera de un resumen, obteniendo lo que se conoce como <span class="hl-yellow"><strong>matriz de (cuasi)covarianzas</strong></span> y que tendr√° un papel fundamental en estad√≠stica ya que contiene la informaci√≥n (= varianza) del dataset.</p>
</div>
</section>
<section id="matriz-de-covarianzas" class="slide level2">
<h2>Matriz de covarianzas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="fu">cov</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               height       mass birth_year
height       955.5071   715.3057  -2138.334
mass         715.3057 46313.2034  17402.547
birth_year -2138.3336 17402.5466  28603.045</code></pre>
</div>
</div>
<p>Adem√°s de ser <span class="hl-yellow"><strong>sim√©trica</strong></span>‚Ä¶¬øqu√© tenemos en la <span class="hl-yellow"><strong>diagonal</strong></span>?</p>
<div class="fragment">
<p>La <span class="hl-yellow"><strong>matriz de (cuasi)covarianzas</strong></span> se denota como <span class="math inline">\(\Sigma\)</span> y sus elementos se define como <span class="math inline">\(\Sigma_{ii} = s_{x_i}^{2}\)</span> para la diagonal y <span class="math inline">\(\Sigma_{ij} = \Sigma_{ji} = s_{x_i x_j}\)</span> fuera de ella.</p>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Recuerda que los softwares estad√≠sticos nos devuelven siempre la <span class="hl-purple"><strong>cuasi covarianza</strong></span>, dividido entre <span class="math inline">\(n-1\)</span> y no entre <span class="math inline">\(n\)</span>. La cuasivarianza y la cuasicovarianza son los <span class="hl-yellow"><strong>mejores estimadores muestrales (insesgados)</strong></span> de los respectivos par√°metros poblaciones</p>
</div>
</div>
</div>
</div>
</section>
<section id="matriz-de-correlaciones" class="slide level2">
<h2>Matriz de correlaciones</h2>
<p>De la misma manera con <code>cor()</code> podemos <span class="hl-yellow"><strong>calcular la matriz de correlaciones</strong></span> (en este caso sin el <code>cuasi</code> ya que se cancelan denominadores)</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>starwars <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">|&gt;</span> </span>
<span id="cb17-3"><a href="#cb17-3"></a>  <span class="fu">drop_na</span>() <span class="sc">|&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>  <span class="fu">cor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               height      mass birth_year
height      1.0000000 0.1075282 -0.4090274
mass        0.1075282 1.0000000  0.4781391
birth_year -0.4090274 0.4781391  1.0000000</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>La <span class="hl-yellow"><strong>matriz de correlaciones</strong></span> se denota como <span class="math inline">\(R\)</span> y sus elementos se define como <span class="math inline">\(r_{ii} = 1\)</span> para la diagonal y <span class="math inline">\(r_{ij} = r_{x_ix_j}\)</span> fuera de ella, y nos proporciona la dependencia lineal entre variables ya de manera <strong>estandarizada</strong>.</p>
</div>
</section>
<section id="matriz-de-correlaciones-1" class="slide level2">
<h2>Matriz de correlaciones</h2>
<p><span class="hl-yellow"><strong>¬øSe te ocurre alguna manera de calcular la matriz de correlaciones a partir de la de covarianzas?</strong></span></p>
</section>
<section id="correlaci√≥n-lineal-datos-agrupados" class="slide level2">
<h2>Correlaci√≥n lineal: datos agrupados</h2>
<p>Imagina ahora que queremos calcular la covarianza/correlaci√≥n de los siguientes datos que representan 24 tiradas de dados</p>

<img data-src="img/dados.png" class="r-stretch"><p>¬øC√≥mo calcular la covarianza/correlaci√≥n agrupando los datos?</p>
</section>
<section id="correlaci√≥n-lineal-datos-agrupados-1" class="slide level2">
<h2>Correlaci√≥n lineal: datos agrupados</h2>

<img data-src="img/tabla-bi-freq.png" class="r-stretch"></section>
<section id="correlaci√≥n-lineal-datos-agrupados-2" class="slide level2">
<h2>Correlaci√≥n lineal: datos agrupados</h2>
</section>
<section id="correlaci√≥n-vs-dependencia" class="slide level2">
<h2>Correlaci√≥n vs dependencia</h2>
<p>Podemos tener <span class="hl-red"><strong>variables incorreladas</strong></span>, con correlaci√≥n nula, pero que <span class="hl-green"><strong>exista dependencia entre ellas</strong></span>: la covarianza/correlaci√≥n <span class="hl-yellow"><strong>SOLO CAPTURA relaciones lineales</strong></span>, nada m√°s.</p>
<div class="fragment">
<p>Veamos un ejemplo sencillo con <span class="math inline">\(X = \left\lbrace -1, 0, 1 \right\rbrace\)</span> y <span class="math inline">\(Y = X^2 = \left\lbrace 1, 0, 1 \right\rbrace\)</span>.</p>
<ul>
<li>La media de ambas es nula</li>
<li>La media del producto es la media de <span class="math inline">\(XY = \left\lbrace -1, 0, 1 \right\rbrace\)</span>, que es de nuevo nula</li>
<li>As√≠ la covarianza <span class="math inline">\(\overline{x*y} - \overline{x}*\overline{y}\)</span> es nula a pesar de tener la mayor dependencia posible (dependencia funcional)</li>
</ul>
</div>
</section>
<section id="correlaci√≥n-vs-dependencia-1" class="slide level2">
<h2>Correlaci√≥n vs dependencia</h2>

<img data-src="img/covarianza-no-lineal.png" class="r-stretch"><p>En relaciones no lineales como la de la imagen, la <strong>correlaci√≥n estar√° cercana a cero</strong> (ya que no hay relaci√≥n lineal) pero existe una <span class="hl-yellow"><strong>dependencia</strong></span>. Diremos que <span class="hl-yellow"><strong>dos variables son dependientes entre s√≠</strong></span> cuando existe un <strong>patr√≥n num√©rico que las relaciona</strong></p>
<div class="fragment">
<ul>
<li><span class="hl-green"><strong>Independencia implica incorrelaci√≥n</strong></span></li>
<li><span class="hl-red"><strong>Incorrelaci√≥n NO implica independencia</strong></span></li>
</ul>
</div>
</section>
<section id="correlaci√≥n-vs-dependencia-2" class="slide level2">
<h2>Correlaci√≥n vs dependencia</h2>

<img data-src="img/escenarios-covarianza.png" class="r-stretch"></section>
<section id="dependencia-vs-causalidad" class="slide level2">
<h2>Dependencia vs causalidad</h2>

<img data-src="img/helados-moreno.jpg" class="r-stretch"><p>Si <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> fuesen variables dependientes (lineales o no)‚Ä¶<span class="hl-yellow"><strong>¬øimplicar√≠a que el ascenso/descenso de una provoca el ascenso/descenso de la otra?</strong></span></p>
<div class="fragment">
<p>Imagina por ejemplo dos variables: nivel de bronceado (X) y consumo de helados (Y). ¬øSon dependientes? Aparentemente s√≠ ya que su comportamiento es similar. <strong>¬øUna causa la otra?</strong></p>
</div>
</section>
<section id="dependencia-vs-causalidad-1" class="slide level2">
<h2>Dependencia vs causalidad</h2>

<img data-src="img/helados-moreno.jpg" class="r-stretch"><p>Diremos que dos variables tienen una <span class="hl-yellow"><strong>relaci√≥n causal o de causalidad</strong></span> cuando una variable es la CAUSA del comportamiento de la otra, algo que no sabremos solo con estad√≠stica (sino con conocimiento experto, en este caso de nutricionistas y m√©dicos)</p>
<div class="fragment">
<p><span class="hl-red"><strong>Correlaci√≥n NO IMPLICA causalidad</strong></span> (al menos no tiene por qu√©)</p>
</div>
</section>
<section id="dependencia-vs-causalidad-2" class="slide level2">
<h2>Dependencia vs causalidad</h2>

<img data-src="img/chocolate-correlacion.jpg" class="r-stretch"><p>Este fen√≥meno es conocido como <span class="hl-yellow"><strong>correlaciones esp√∫reas</strong></span>, y aparece cuando dos variables presentan una <span class="hl-green"><strong>relaci√≥n matem√°tica</strong></span> pero sin <span class="hl-red"><strong>ning√∫n tipo de relaci√≥n causal o l√≥gica</strong></span>. Puedes ver m√°s en <a href="https://www.tylervigen.com/spurious-correlations" class="uri">https://www.tylervigen.com/spurious-correlations</a></p>
</section>
<section id="dependencia-vs-causalidad-3" class="slide level2">
<h2>Dependencia vs causalidad</h2>

<img data-src="img/confounder.jpg" class="r-stretch"><p>Dicho patr√≥n matem√°tico puede deberse al mero azar o la existencia de lo que se conoce como <span class="hl-yellow"><strong>variables de confusi√≥n</strong></span> (en el caso del helado, el verano es el que causa ambas).</p>
<p>La rama que se dedica al <span class="hl-yellow"><strong>estudio de la causalidad</strong></span>, combinando las ramas de la <strong>estad√≠stica, filosof√≠a, sociolog√≠a y psicolog√≠a</strong> se le conoce como <span class="hl-yellow"><strong>inferencia causal</strong></span> y es fundamental en un an√°lisis m√°s profunde de las relaciones entre las variables (sobre todo en campos como la econom√≠a o la sociolog√≠a)</p>
</section></section>
<section>
<section id="clase-4" class="title-slide slide level1 center">
<h1>Clase 4: primeras regresiones</h1>
<p><span style="color:#444442;"><strong>Historia regresi√≥n. Aprendizaje supervisado. Regresi√≥n lineal univariante</strong></span></p>
</section>
<section id="historia-de-la-reg" class="slide level2">
<h2>Historia de la reg</h2>
<blockquote>
<p>Hay una regla universal: cualquier pariente tuyo es probablemente m√°s mediocre que t√∫¬ª</p>
</blockquote>
<p>La <span class="hl-yellow"><strong>historia de regresi√≥n</strong></span> se remonta a <strong>Francis Galton</strong>, primo de Charles Darwin, que adem√°s de estad√≠stico fue psic√≥logo, ge√≥grafo y, por desgracia, el primer eugen√©sico (de hecho acu√±√≥ el termino)</p>
<div class="fragment">
<p>Tambi√©n fue el primero en proponer m√©todos de clasificaci√≥n de huellas en medicina forense e incluso se le atribuye el primer mapa meteorol√≥gico de la historia</p>
</div>
</section>
<section id="regresi√≥n-y-darwin" class="slide level2">
<h2>Regresi√≥n y Darwin</h2>
<p>Galton mostr√≥ fascinaci√≥n por ¬´El origen de la especies¬ª de su primo. Sin embargo, <span class="hl-yellow"><strong>Galton no se centraba en los mejor adaptados sino en los que √©l llama mediocres</strong></span></p>
<div class="fragment">
<p>Seg√∫n Galton, las sociedades estaban fomentando la mediocridad, interfiriendo en la selecci√≥n natural, as√≠ que empez√≥ a <strong>estudiar si el talento era o no hereditario</strong>.</p>
</div>
<div class="fragment">
<p>¬øSu conclusi√≥n? El <span class="hl-yellow"><strong>talento se disipaba</strong></span> a lo largo de las generaciones</p>
</div>
</section>
<section id="regresi√≥n-a-la-mediocridad" class="slide level2">
<h2>Regresi√≥n a la mediocridad</h2>
<p>En 1886 public√≥ ¬´Regression towards mediocrity in hereditary stature¬ª, un art√≠culo que cambiar√≠a la estad√≠stica: fue el <span class="hl-yellow"><strong>primer uso documentado de lo que hoy conocemos como recta de regresi√≥n</strong></span></p>
<div class="fragment">
<div class="columns">
<div class="column" style="width:38%;">
<p><img data-src="img/reg_dalton.jpg"></p>
</div><div class="column" style="width:62%;">
<p>Galton analiz√≥ la estatura de 205 hijos y padres, observando que, de nuevo, los valores extremos se disipaban: a lo largo de las generaciones hab√≠a una <span class="hl-yellow"><strong>regresi√≥n (un retroceso) a la mediocridad (entendida como la media)</strong></span></p>
</div>
</div>
<p>Hijos de altos eran algo m√°s bajitos, e hijos de bajitos eran algo m√°s altos.</p>
</div>
</section>
<section id="regresi√≥n-a-la-mediocridad-1" class="slide level2">
<h2>Regresi√≥n a la mediocridad</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/reg-galton-coef.jpg"></p>
</div><div class="column" style="width:40%;">
<p>Galton no solo observ√≥ que las <span class="hl-yellow"><strong>estaturas ¬´regresaban¬ª a un valor medio sino que lo hac√≠an con un patr√≥n</strong></span>, con un factor constante de <span class="math inline">\(2/3\)</span>: si los padres se desviaban <span class="math inline">\(+3\)</span> por encima de la media, los hijos se desviaban solo <span class="math inline">\((2/3)*3 = +2\)</span> por encima de la media.</p>
</div>
</div>
</section>
<section id="aprendizaje-estad√≠stico" class="slide level2">
<h2>Aprendizaje estad√≠stico</h2>
<p>La regresi√≥n lineal es el modelo m√°s simple de lo que se conoce como <span class="hl-yellow"><strong>aprendizaje estad√≠stico (Machine Learning)</strong></span>, en concreto del conocido como <span class="hl-yellow"><strong>aprendizaje supervisado</strong></span></p>

<img data-src="img/ml.jpg" class="r-stretch"></section>
<section id="ciencia-de-datos" class="slide level2">
<h2>Ciencia de Datos</h2>
<p>La <span class="hl-yellow"><strong>ciencia de datos</strong></span> es precisamente la rama que integra las matem√°ticas, la estad√≠stica, la probabilidad, el Machine Learning e incluso el Big Data</p>

<img data-src="img/stats-ml.jpg" class="r-stretch"></section>
<section id="aprendizaje-supervisado" class="slide level2">
<h2>Aprendizaje ¬øsupervisado?</h2>

<img data-src="img/unsupervised-learning.jpg" class="r-stretch"></section>
<section id="aprendizaje-supervisado-1" class="slide level2">
<h2>Aprendizaje ¬øsupervisado?</h2>
<p>En el campo del Machine Learning hay principalmente dos tipos de metodolog√≠as:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span class="hl-purple"><strong>Aprendizaje supervisado</strong></span>: tendremos dos tipos de variables, la <span class="hl-yellow"><strong>variable dependiente (output/target)</strong></span> que se quiere predecir/clasificar, normalmente denotada como <span class="math inline">\(Y\)</span>, y las <span class="hl-yellow"><strong>variables independientes (inputs) o explicativas o predictoras</strong></span>, que contienen la informaci√≥n disponible. Ejemplos: regresi√≥n, knn, √°rboles, etc.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/supervised.jpg"></p>
</div>
</div>
</section>
<section id="aprendizaje-supervisado-2" class="slide level2">
<h2>Aprendizaje ¬øsupervisado?</h2>
<p>En el campo del Machine Learning hay principalmente dos tipos de metodolog√≠as:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><span class="hl-purple"><strong>Aprendizaje no supervisado</strong></span>: no existe la distinci√≥n entre target y variables explicativas ya que <span class="hl-yellow"><strong>no tenemos etiquetados los datos</strong></span>, no sabemos a priori la respuesta correcta. El aprendizaje no supervisado <span class="hl-yellow"><strong>buscar√° patrones</strong></span> basados en similitudes/diferencias. Ejemplos: PCA, clustering, redes neuronales, etc.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="img/unsupervised.jpg"></p>
</div>
</div>
</section>
<section id="clasificaci√≥n-vs-predicci√≥n" class="slide level2">
<h2>Clasificaci√≥n vs predicci√≥n</h2>
<p>Como hemos comentado, la <span class="hl-yellow"><strong>regresi√≥n lineal</strong></span> se enmarca dentro del <span class="hl-yellow"><strong>predicci√≥n supervisada</strong></span></p>
<ul>
<li><p><span class="hl-purple"><strong>Predicci√≥n</strong></span>: la <span class="hl-yellow"><strong>variable objetivo es una variable cuantitativa continua</strong></span> (por ejemplo, precio, glucosa, peso, etc).</p></li>
<li><p><span class="hl-purple"><strong>Clasificaci√≥n</strong></span>: la <span class="hl-yellow"><strong>variable objetivo es una variable cualitativa</strong></span> (por ejemplo, especie de flor, ausencia/presencia de enfermedad, si/no, etc) o <strong>cuantitativa discreta</strong> (por ejemplo, n√∫mero de accidentes). La etiqueta tomar√° un valor dentro del conjunto de modalidades permitidas, pudiendo ser <strong>binaria</strong> (si/no) o <strong>multiclase</strong> (A, B, C, D).</p></li>
</ul>
<p>&nbsp;</p>
<p>üìö Ver ¬´The elements of Statistical Learning¬ª (Hastie et al., 2008)</p>
</section></section>
<section>
<section id="clase-5" class="title-slide slide level1 center">
<h1>Clase 5: ajuste de regresi√≥n</h1>
<p><span style="color:#444442;"><strong>Interpretaci√≥n de coeficientes. M√©todo m√≠nimos cuadrados</strong></span></p>
</section>
<section id="modelo-predictivo" class="slide level2">
<h2>Modelo predictivo</h2>
<p>Dentro del marco de la <span class="hl-yellow"><strong>predicci√≥n supervisada</strong></span> un modelo tendr√° siempre la siguiente forma:</p>
<p><span class="math display">\[Y = f(\mathbf{X}) + \varepsilon = f\left(X_1, \ldots, X_p \right) + \varepsilon, \quad E \left[Y | \boldsymbol{X} = x \right] =f\left(X_1, \ldots, X_p \right) \]</span></p>
<ul>
<li><p><span class="math inline">\(X\)</span> ser√°n los <span class="hl-yellow"><strong>datos</strong></span></p></li>
<li><p><span class="math inline">\(f(\cdot)\)</span> ser√° nuestro <span class="hl-yellow"><strong>modelo</strong></span>, es decir, el <span class="hl-yellow"><strong>valor esperado de <span class="math inline">\(Y\)</span></strong></span> con la informaci√≥n que tenemos.</p></li>
<li><p><span class="math inline">\(\mathbf{X} = \left(X_1, \ldots, X_p \right)\)</span> ser√°n nuestras <span class="hl-yellow"><strong>predictoras o variables independientes</strong></span></p></li>
<li><p><span class="math inline">\(\varepsilon\)</span> ser√° el <span class="hl-yellow"><strong>error o ruido</strong></span>, una <span class="hl-yellow"><strong>variable aleatoria de media 0</strong></span> <span class="math inline">\(E \left[\varepsilon | \boldsymbol{X} = x \right] = 0\)</span> (el error deber√≠a ser reducido a <strong>algo aleatorio (irreducible)</strong>, aunque en estad√≠stica SIEMPRE nos vamos a equivocar).</p></li>
</ul>
</section>
<section id="modelo-predictivo-1" class="slide level2">
<h2>Modelo predictivo</h2>
<p><span class="math display">\[Y = f(\mathbf{X}) + \varepsilon = f\left(X_1, \ldots, X_p \right) + \varepsilon, \quad E \left[Y | \boldsymbol{X} = x \right] =f\left(X_1, \ldots, X_p \right) \]</span></p>
<p>El objetivo es intentar <span class="hl-yellow"><strong>estimar dicha variable objetivo</strong></span> minimizando al m√°ximo el error cometido (la parte que podemos evitar).</p>
<div class="fragment">
<p>El <span class="hl-yellow"><strong>modelo estimado</strong></span> se definir√° como</p>
<p><span class="math display">\[\widehat{Y} := \widehat{E \left[Y | \boldsymbol{X} = x \right]}  = \widehat{f}\left(X_1, \ldots, X_p \right), \quad \widehat{\varepsilon} = \widehat{Y} - Y\]</span></p>
<ul>
<li><p><span class="math inline">\(\widehat{Y}\)</span> ser√°n las <span class="hl-yellow"><strong>estimaciones</strong></span>, definidas como la estimaci√≥n del <span class="hl-yellow"><strong>valor esperado de <span class="math inline">\(Y\)</span></strong></span> con la informaci√≥n que tenemos.</p></li>
<li><p><span class="math inline">\(\widehat{f}\)</span> ser√° el <span class="hl-yellow"><strong>modelo estimado</strong></span></p></li>
<li><p><span class="math inline">\(\widehat{\varepsilon}\)</span> los <span class="hl-yellow"><strong>errores estimados</strong></span> (con media muestral igual a cero).</p></li>
</ul>
</div>
</section>
<section id="reg.-lineal-univariante" class="slide level2">
<h2>Reg. lineal univariante</h2>
<p>En el caso concreto de la <span class="hl-yellow"><strong>regresi√≥n lineal</strong></span> nuestro modelo ser√° un <strong>hiperplano lineal</strong> (en el caso de una variable, una simple recta):</p>
<p><span class="math display">\[E \left[Y | \boldsymbol{X} = x \right]  = \beta_0 + \beta_1 X_1 + \ldots + \beta_p X_p\]</span></p>
<div class="fragment">
<p>Su estimaci√≥n ser√° por tanto</p>
<p><span class="math display">\[\widehat{Y} := \widehat{E \left[Y | \boldsymbol{X} = x \right]} = \widehat{f}(\mathbf{X}) = \widehat{\beta_0} + \widehat{\beta_1} X_1 + \ldots + \widehat{\beta_p} X_p \]</span></p>
<ul>
<li><p>El modelo <span class="math inline">\(\widehat{f}(\cdot)\)</span> ser√° una <span class="hl-yellow"><strong>recta/hiperplano lineal</strong></span></p></li>
<li><p>En el caso de la regresi√≥n lineal <span class="hl-yellow"><strong>univariante</strong></span> tendremos por tanto <span class="math inline">\(E \left[Y | \boldsymbol{X} = x \right] = \beta_0 + \beta_1X\)</span> (<span class="math inline">\(p = 1\)</span>)</p></li>
<li><p>El objetivo ser√° obtener la estimaci√≥n de los <span class="math inline">\(\widehat{\beta}\)</span> tal que <strong>minimicemos el error</strong></p></li>
</ul>
</div>
</section>
<section id="varianza-residual" class="slide level2">
<h2>Varianza residual</h2>
<p>Como ya hemos comentado, una manera de cuantificar lo que nuestro modelo se equivoca es lo que llamamos <span class="hl-yellow"><strong>varianza residual o error cuadr√°tico medio</strong></span> (varianza del error), que podemos estimar como sigue (ya que la <span class="hl-purple"><strong>media muestral de los errores ser√° cero</strong></span>)</p>
<p><span class="math display">\[s_{r}^{2} = \frac{1}{n} \displaystyle \sum_{i=1}^{n} \left( \widehat{\varepsilon}_{i} - \overline{\widehat{\varepsilon}}_{i}\right)^2 = \frac{1}{n} \displaystyle \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^{2} \]</span> ¬øC√≥mo quedar√≠a la f√≥rmula si <strong>desarrollo lo que vale los errores estimados</strong> <span class="math inline">\(\widehat{\varepsilon}\)</span>?</p>
<div class="fragment">
<p><span class="math display">\[s_{r}^{2} := s_{r}^{2}\left(\widehat{\beta}_0, \widehat{\beta}_1 \right)= \frac{1}{n} \sum_{i=1}^{n} \left(Y_i - \widehat{Y}_i \right)^2 = \frac{1}{n} \sum_{i=1}^{n} \left[Y_i - \left(\widehat{\beta}_0 + \widehat{\beta}_1X_i \right)\right]^2\]</span></p>
</div>
</section>
<section id="m√©todo-m√≠nimos-cuadrados" class="slide level2">
<h2>M√©todo m√≠nimos cuadrados</h2>
<p>El <span class="hl-yellow"><strong>m√©todo de los m√≠nimos cuadrados</strong></span>, originariamente planteado a la vez por Legendre y Gauss, consiste en establecer que los <span class="hl-yellow"><strong>par√°metros √≥ptimos</strong></span> ser√°n aquellos <span class="math inline">\(\left(\widehat{\beta}_0, \widehat{\beta}_1 \right)\)</span> que minimicen dicha suma de cuadrados (que minimicen la varianza residual)</p>
<p><span class="math display">\[\widehat{\boldsymbol{\beta}} = \left(\widehat{\beta}_0, \widehat{\beta}_1 \right) = \arg \min_{\left(\beta_0, \beta_1 \right) \in \mathbb{R}^2} s_{r}^{2}\left(\beta_0, \beta_1 \right) = \arg \min_{\left(\beta_0, \beta_1 \right) \in \mathbb{R}^2} n*s_{r}^{2}\left(\beta_0, \beta_1 \right)\]</span></p>
<p>Vamos a desarrollar ese cuadrado‚Ä¶</p>
</section>
<section id="m√©todo-m√≠nimos-cuadrados-1" class="slide level2">
<h2>M√©todo m√≠nimos cuadrados</h2>
<p><span class="math display">\[s_{r}^{2}\left(\beta_0, \beta_1 \right) = \frac{1}{n} \sum_{i=1}^{n} \left[Y_i - \left(\beta_0 + \beta_1 X_i \right)\right]^2\]</span> Vamos a desarrollar ese cuadrado‚Ä¶</p>
<div class="fragment">
<p><span class="math display">\[\begin{eqnarray} s_{r}^{2}\left(\beta_0, \beta_1 \right) &amp;=&amp; \frac{1}{n} \sum_{i=1}^{n} \left[Y_{i}^{2} + \left(\beta_0 + \beta_1 X_i \right)^2 - 2Y_{i}\left(\beta_0 + \beta_1 X_i \right)\right] \nonumber \\  &amp;=&amp; \sum_{i=1}^{n} \left[Y_{i}^{2} + \left(\beta_{0}^{2} + \beta_{1}^{2}X_{i}^{2} + 2\beta_{0}\beta_{1} X_i \right) - 2Y_{i}\beta_{0} - 2Y_{i}\beta_{1} X_i  \right] \end{eqnarray}\]</span></p>
</div>
</section>
<section id="m√©todo-m√≠nimos-cuadrados-2" class="slide level2">
<h2>M√©todo m√≠nimos cuadrados</h2>
<p><span class="math display">\[\begin{eqnarray} s_{r}^{2}\left(\beta_0, \beta_1 \right) &amp;=&amp; \frac{1}{n} \sum_{i=1}^{n} \left[Y_{i}^{2} + \left(\beta_0 + \beta_1 X_i \right)^2 - 2Y_{i}\left(\beta_0 + \beta_1 X_i \right)\right] \nonumber \\  &amp;=&amp; \sum_{i=1}^{n} \left[Y_{i}^{2} + \left(\beta_{0}^{2} + \beta_{1}^{2}X_{i}^{2} + 2\beta_{0}\beta_{1} X_i \right) - 2Y_{i}\beta_{0} - 2Y_{i}\beta_{1} X_i  \right] \end{eqnarray}\]</span></p>
<p>¬øC√≥mo encontrar el m√≠nimo de una funci√≥n?</p>
<div class="fragment">
<p>Efectivamente, derivando.</p>
<p><span class="math display">\[\frac{\partial s_{r}^{2}}{\partial \beta_0} = \frac{1}{n} \sum_{i=1}^{n} \left[ 2\beta_{0} + 2 \beta_1 X_i - 2Y_i \right] = 2 \left( \beta_{0} + \beta_{1} \overline{x} - \overline{y} \right)\]</span></p>
<p><span class="math display">\[\frac{\partial s_{r}^{2}}{\partial \beta_1} = \frac{1}{n} \sum_{i=1}^{n} \left[ 2\beta_{1}X_{i}^{2} + 2 \beta_0 X_i - 2Y_iX_i \right] = 2 \left( \beta_{1} \overline{x^2}+\beta_{0}\overline{x} - \overline{xy} \right)\]</span></p>
</div>
</section>
<section id="m√©todo-m√≠nimos-cuadrados-3" class="slide level2">
<h2>M√©todo m√≠nimos cuadrados</h2>
<p>Si lo agrupamos en un sistema y lo <span class="hl-yellow"><strong>igualamos a cero</strong></span> para encontrar el √≥ptimo tenemos</p>
<p><span class="math display">\[\left\{\beta_{0} + \beta_{1} \overline{x}   = \overline{y} \atop \overline{x} \beta_{0} + \overline{x^2} \beta_{1} = \overline{xy} \right.\]</span></p>
<p>¬øC√≥mo resolver un sistema?</p>
<div class="fragment">
<p>Haciendo la regla de Cramer tenemos que</p>
<p><span class="math display">\[\widehat{\beta}_1 = \frac{\overline{xy} - \overline{x}*\overline{y}}{\overline{x^2} - \overline{x}^2} = \frac{s_{xy}}{s_{x}^{2}}\]</span></p>
<p><span class="math display">\[\widehat{\beta}_0 = \frac{\overline{y}*\overline{x^2} - \overline{x}*\overline{xy}}{\overline{x^2} - \overline{x}^2}  = \overline{y} + \frac{\overline{y}*\overline{x}^2- \overline{x}*\overline{xy}}{\overline{x^2} - \overline{x}^2} = \overline{y} - \widehat{\beta}_1 \overline{x}\]</span></p>
</div>
</section>
<section id="estimaci√≥n-reg.-univariante" class="slide level2">
<h2>Estimaci√≥n reg. univariante</h2>
<p>Los <span class="hl-yellow"><strong>estimadores de los par√°metros de una regresi√≥n lineal univariante</strong></span> ser√°n por tanto <span class="math inline">\(\widehat{\beta}_1 = \frac{s_{xy}}{s_{x}^{2}}\)</span> (<span class="hl-purple"><strong>pendiente de la recta</strong></span>) y <span class="math inline">\(\widehat{\beta}_0 = \overline{y} - \widehat{\beta}_1 \overline{x}\)</span> (<span class="hl-purple"><strong>ordenada en el origen</strong></span>)</p>
<div class="fragment">
<p>Es importante <span class="hl-yellow"><strong>distinguir lo poblaci√≥n de lo muestral</strong></span></p>
<ul>
<li><p>Los par√°metros <span class="math inline">\(\left( \beta_0, \beta_1 \right)\)</span> son desconocidos, los <span class="hl-yellow"><strong>par√°metros poblacionales</strong></span></p></li>
<li><p>Los par√°metros <span class="math inline">\(\left( \widehat{\beta}_0, \widehat{\beta}_1 \right)\)</span> son estimados a partir de los datos, son <span class="hl-yellow"><strong>variables aleatorias</strong></span> ya que han sido calculados en funci√≥n de una muestra aleatoria <span class="math inline">\(\left\lbrace \left(x_i, y_i \right) \right\rbrace_{i=1}^{n}\)</span> de la poblaci√≥n $(X, Y ) $</p></li>
</ul>
</div>
</section>
<section id="estimaci√≥n-reg.-univariante-1" class="slide level2">
<h2>Estimaci√≥n reg. univariante</h2>
<p>Los <span class="hl-yellow"><strong>estimadores de los par√°metros de una regresi√≥n lineal univariante</strong></span> ser√°n por tanto <span class="math inline">\(\widehat{\beta}_1 = \frac{s_{xy}}{s_{x}^{2}}\)</span> (<span class="hl-purple"><strong>pendiente de la recta</strong></span>) y <span class="math inline">\(\widehat{\beta}_0 = \overline{y} - \widehat{\beta}_1 \overline{x}\)</span> (<span class="hl-purple"><strong>ordenada en el origen</strong></span>)</p>
<p>¬øCu√°l es su <span class="hl-yellow"><strong>interpretaci√≥n</strong></span>?</p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Ordenada en el origen</strong></span>: tambi√©n llamado <strong>intercepto</strong>, y denotado como <span class="math inline">\(\beta_0\)</span> su valor real, es el valor de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X=0\)</span>. Es decir, <span class="math inline">\(\widehat{\beta}_0\)</span> se puede interpretar como la estimaci√≥n <span class="math inline">\(\widehat{Y}\)</span> cuando <span class="math inline">\(X = 0\)</span> (cuando dicha estimaci√≥n tenga sentido).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Pendiente</strong></span>: denotado com <span class="math inline">\(\beta_1\)</span> su valor real, cuantifica el incremento de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X\)</span> aumenta una unidad. Es decir, <span class="math inline">\(\widehat{\beta}_1\)</span> se puede interpretar como la variaci√≥n de la <strong>estimaci√≥n <span class="math inline">\(\widehat{Y}\)</span> cuando <span class="math inline">\(X\)</span> tiene un incremento unitario</strong>.</li>
</ul>
</div>
</section>
<section id="regresi√≥n-en-r" class="slide level2">
<h2>Regresi√≥n en R</h2>
<p>Para hacer un <span class="hl-yellow"><strong>ajuste de regresi√≥n lineal univarainte en R</strong></span> solo necesitamos utilizar la funci√≥n <code>lm()</code> (de linear model) con dos argumentos:</p>
<ul>
<li><code>data = ...</code>: los datos de los que queremos sacar el ajuste (sin ausentes de momento)</li>
<li><code>formula = ...</code>: la f√≥rmula del ajuste (y frente a x, expresado como <code>y ~ x</code>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>datos <span class="ot">&lt;-</span> </span>
<span id="cb19-2"><a href="#cb19-2"></a>  starwars <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>  <span class="fu">drop_na</span>(mass, height) </span>
<span id="cb19-4"><a href="#cb19-4"></a>ajuste_lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> mass <span class="sc">~</span> height)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regresi√≥n-en-r-1" class="slide level2">
<h2>Regresi√≥n en R</h2>
<p>Una vez realizado el ajuste podemos <span class="hl-yellow"><strong>resumirlo</strong></span> con <code>summary()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<div class="fragment">
<p>¬øQu√© representa cada bloque de la salida?</p>
</div>
</section>
<section id="regresi√≥n-en-r-2" class="slide level2">
<h2>Regresi√≥n en R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<ul>
<li><p><code>Call: ...</code>: la orden que hemos ejecutado</p></li>
<li><p><code>Residuals: ...</code>: un resumen en forma de <span class="hl-yellow"><strong>cuartiles de los residuales</strong></span>, es decir, de los <span class="hl-yellow"><strong>errores</strong></span> (f√≠jate que aunque la media de los errores siempre es 0, no tiene porque serlo la mediana, de hecho que no lo sea ya nos indica que normales no van a ser seguramente).</p></li>
</ul>
</section>
<section id="regresi√≥n-en-r-3" class="slide level2">
<h2>Regresi√≥n en R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<ul>
<li><code>Coefficients: ...</code>: de momento solo nos interesa la columna <span class="hl-yellow"><strong>Estimate</strong></span> que nos da las estimaciones de los par√°metros. En la fila <code>Intercept</code> siempre ir√° <span class="math inline">\(\widehat{\beta}_0\)</span>, y el resto de filas tendr√° el nombre de la variable predictora a la que multiplica el par√°metro (en este caso la fila <code>height</code> corresponde a la estimaci√≥n <span class="math inline">\(\widehat{\beta}_1\)</span>).</li>
</ul>
</section>
<section id="regresi√≥n-en-r-4" class="slide level2">
<h2>Regresi√≥n en R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<p>En nuestro caso particular, el <span class="hl-yellow"><strong>ajuste de regresi√≥n</strong></span> viene dado por <span class="math inline">\(\widehat{Y} = \widehat{\beta}_0 + \widehat{\beta}_1 X = -11.4868 + 0.6240*X\)</span>, donde <span class="math inline">\(X\)</span> es la estatura: por cada cm extra que mida un personaje, el modelo estima que el peso aumenta 0.6240 kg, y la estimaci√≥n de peso para un persona que mida 0 cm es de -11.4868 kg (obviamente esta estimaci√≥n mucho sentido no tiene)</p>
</section>
<section id="regresi√≥n-en-r-5" class="slide level2">
<h2>Regresi√≥n en R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<ul>
<li><code>Multiple R-squared: ...</code> (de momento lo dem√°s lo ignoramos): es el conocido como <span class="math inline">\(R^2\)</span> o bondad de ajuste. Hablaremos de √©l en las pr√≥ximas clases, pero de momento, nos basta saber que es una <span class="hl-yellow"><strong>m√©trica de calidad del ajuste</strong></span> que va de 0 (peor) a 1 (mejor).</li>
</ul>
</section>
<section id="predicci√≥n-en-r" class="slide level2">
<h2>Predicci√≥n en R</h2>
<p>Una vez estimado el modelo (sus coeficientes) podemos usarlo, bien para <span class="hl-yellow"><strong>estimar valores que el modelo conoce</strong></span> (de los que aprendi√≥) o para <span class="hl-yellow"><strong>predecir nuevos valores</strong></span> de los que el modelo no ha aprendido</p>
<div class="fragment">
<p>Simplemente necesitamos la funci√≥n <code>predict(modelo, nuevos_datos)</code>, usando como argumentos el <strong>modelo entrenado</strong> y un <span class="hl-yellow"><strong>nuevo dataset que contenga una/s columna/s llamadas igual que nuestras variables predictores</strong></span> con los valores de la predictora para los que queremos predecir</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>predicciones <span class="ot">&lt;-</span> </span>
<span id="cb30-2"><a href="#cb30-2"></a>  <span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="fl">81.3</span>, <span class="fl">153.1</span>, <span class="fl">189.3</span>, <span class="fl">210.3</span>),</span>
<span id="cb30-3"><a href="#cb30-3"></a>         <span class="st">"mass_predict"</span> <span class="ot">=</span> <span class="fu">predict</span>(ajuste_lineal, <span class="fu">tibble</span>(<span class="st">"height"</span> <span class="ot">=</span> height)))</span>
<span id="cb30-4"><a href="#cb30-4"></a>predicciones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 √ó 2
  height mass_predict
   &lt;dbl&gt;        &lt;dbl&gt;
1   15          -4.23
2   81.3        38.1 
3  153.         84.0 
4  189.        107.  
5  210.        120.  </code></pre>
</div>
</div>
</div>
</section>
<section id="rango-de-fiabilidad" class="slide level2">
<h2>Rango de fiabilidad</h2>
<p>Aunque hablaremos en profundidad de la bondad de ajuste, supongamos que tenemos un <strong>modelo extremadamente bueno</strong>, con una bondad de ajuste <span class="math inline">\(R^2 = 0.99\)</span>. ¬øSer√≠a fiable nuestro modelo anterior para predecir el peso de un personaje con <span class="math inline">\(X = 15\)</span> cm?</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>predicciones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 √ó 2
  height mass_predict
   &lt;dbl&gt;        &lt;dbl&gt;
1   15          -4.23
2   81.3        38.1 
3  153.         84.0 
4  189.        107.  
5  210.        120.  </code></pre>
</div>
</div>
<p>Si te fijas la <span class="hl-red"><strong>¬°predicci√≥n del peso es negativa!</strong></span>: por muy beb√© que sea, algo pesar√°. ¬øPor qu√© sucede esto?</p>
</div>
</section>
<section id="rango-de-fiabilidad-1" class="slide level2">
<h2>Rango de fiabilidad</h2>
<p><img data-src="img/rango_1.png"> <img data-src="img/rango_2.png"></p>
<p>Nuestro <span class="hl-yellow"><strong>modelo solo puede aprender de los datos que conoce</strong></span>: solo podremos predecir para valores nuevos de las predictoras <span class="hl-yellow"><strong>dentro del rango de las predictoras con las que entrenamos</strong></span> el modelo</p>
<p>Da igual lo bueno que sea el modelo: las <span class="hl-red"><strong>predicciones fuera del rango de las predictoras de entrenamiento</strong></span> no ser√°n fiables ya que el modelo no sabe lo que sucede fuera.</p>
</section></section>
<section>
<section id="clase-6" class="title-slide slide level1 center">
<h1>Clase 6: diagnosis</h1>
<p><span style="color:#444442;"><strong>Hip√≥tesis e inferencia del modelo</strong></span></p>
</section>
<section id="repaso" class="slide level2">
<h2>Repaso</h2>
<ul>
<li><span class="hl-yellow"><strong>Modelo lineal</strong></span>: descrito como <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \ldots + \beta_p X_p + \varepsilon\)</span>, buscamos estimar el <strong>valor esperado</strong> <span class="math inline">\(E \left[Y | \boldsymbol{X} = x \right] = \beta_0 + \beta_1 X_1 + \ldots + \beta_p x_p\)</span>, donde <span class="math inline">\(\boldsymbol{X}\)</span> es la poblaci√≥n y <span class="math inline">\(x\)</span> la muestra.</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Caso univariante</strong></span>: <span class="math inline">\(p = 1\)</span> tal que <span class="math inline">\(E \left[Y | \boldsymbol{X} = x \right] = \beta_0 + \beta_1 x\)</span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Estimaci√≥n</strong></span>: <span class="math inline">\(\widehat{Y}\)</span> en funci√≥n de <span class="math inline">\(\left(\widehat{\beta}_0, \widehat{\beta}_1 \right)\)</span>. De todas las rectas posibles, queremos la <span class="hl-yellow"><strong>recta de regresi√≥n m√≠nimos-cuadrados</strong></span>: <strong>minimiza la varianza residual</strong> (calculamos sus derivadas parciales, igualamos a cero y resolvemos el sistema). Esos estimadores ser√°n <span class="math inline">\(\widehat{\beta}_1 = \frac{s_{xy}}{s_{x}^{2}}\)</span> y <span class="math inline">\(\widehat{\beta}_0 = \overline{y} - \widehat{\beta}_1 \overline{x}\)</span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Predicci√≥n</strong></span>: podemos estimar o predecir valores con la recta <span class="math inline">\(\widehat{Y} = \widehat{\beta}_0 + \widehat{\beta}_0 X\)</span>, siempre y cuando <span class="math inline">\(X = x\)</span> est√© dentro del rango de valores de entrenamiento del modelo.</li>
</ul>
</div>
</section>
<section id="diagnosis" class="slide level2">
<h2>Diagnosis</h2>
<p>Hasta ahora no hemos pedido nada a la muestra <span class="math inline">\(\left\lbrace \left( X_i, Y_i \right) \right\rbrace_{i=1}^{n}\)</span>, ¬øpara qu√© necesitar√≠amos <span class="hl-yellow"><strong>hip√≥tesis</strong></span> entonces?</p>
<div class="fragment">
<p>La raz√≥n es que, hasta ahora, lo √∫nico que hemos podido realizar es una <span class="hl-yellow"><strong>estimaci√≥n puntual</strong></span> de los par√°metros, pero dado que dichos estimadores ser√°n variables aleatorias, necesitaremos realizar <span class="hl-yellow"><strong>inferencia estad√≠stica</strong></span> sobre ellos (recuerda: los par√°metros son simpleme estimaciones para esa muestra de la poblaci√≥n, de forma que dada otra muestra, la recta ser√° distinta).</p>
</div>
<div class="fragment">
<p>Para poder cuantificar la <span class="hl-yellow"><strong>variabilidad y precisi√≥n de nuestras estimaciones</strong></span> necesitaremos que los datos cumplan ciertas <span class="hl-purple"><strong>hip√≥tesis probabil√≠sticas</strong></span>: lo interesante no es la estimaci√≥n puntual de los par√°metros a partir de la muestra sino lo que <span class="hl-green"><strong>podamos inferir de ellos a la poblaci√≥n</strong></span></p>
</div>
</section>
<section id="diagnosis-1" class="slide level2">
<h2>Diagnosis</h2>
<p>En el caso de la regresi√≥n lineal univariante pediremos <span class="hl-yellow"><strong>4 hip√≥tesis</strong></span></p>
<div class="fragment">
<ol type="1">
<li><span class="hl-green"><strong>Linealidad</strong></span>: el valor esperado de <span class="math inline">\(Y\)</span> es <span class="math inline">\(E \left[Y | \boldsymbol{X} = x \right] = \beta_0 + \beta_1 x\)</span></li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><span class="hl-green"><strong>Homocedasticidad</strong></span>: el modelo no podr√° explicar toda la informaci√≥n (a veces se equivocar√° por arriba y otras por abajo), pero necesitamos que la <span class="hl-yellow"><strong>varianza del error sea finita y constante</strong></span>, tal que <span class="math inline">\(\sigma_{r}^2 = \sigma_{\varepsilon}^2 = {\rm Var} \left[\varepsilon | \boldsymbol{X} = x \right] = cte &lt; \infty\)</span>, que no var√≠e seg√∫n aumenta o disminuye la <span class="math inline">\(X\)</span>.</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><span class="hl-green"><strong>Normalidad</strong></span>: pediremos que <span class="math inline">\(\varepsilon \sim N \left(0, \sigma_{r}^2 \right)\)</span></li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><span class="hl-green"><strong>Independencia</strong></span>: los errores <span class="math inline">\(\left\lbrace \varepsilon_i \right\rbrace_{i=1}^{n}\)</span> deben ser independientes entre s√≠ (el error en una observaci√≥n no depende de otras). En particular, ser√°n <strong>incorrelados</strong></li>
</ol>
<p><span class="math display">\[{\rm Cor}_{\varepsilon_i \varepsilon_j} = E \left[\varepsilon_i \varepsilon_j \right] - E \left[\varepsilon_i \right] E \left[\varepsilon_j \right] = E \left[\varepsilon_i \varepsilon_j \right] = 0, \quad i \neq j\]</span></p>
</div>
</section>
<section id="diagnosis-2" class="slide level2">
<h2>Diagnosis</h2>
<p>Las 4 hip√≥tesis se pueden <span class="hl-yellow"><strong>resumir de manera te√≥rica</strong></span> en</p>
<p><span class="math display">\[Y | \boldsymbol{X} = x \sim N \left(\beta_0 + \beta_1x, \sigma_{\varepsilon}^2 \right)\]</span></p>
<div class="fragment">
<p>Su <span class="hl-purple"><strong>versi√≥n muestral</strong></span> ser√≠a simplemente</p>
<p><span class="math display">\[y_i | \boldsymbol{X} = x_i \sim N \left(\beta_0 + \beta_1x_i, \sigma_{\varepsilon}^2 \right), \quad i=1,\ldots,n\]</span></p>
</div>
</section>
<section id="inferencia-de-los-par√°metros" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p>Las hip√≥tesis nos permiten decir (lo demostraremos m√°s adelante) que los <span class="hl-yellow"><strong>par√°metros estimados siguen una distribuci√≥n (condicionada) normal</strong></span> de <span class="hl-purple"><strong>media el par√°metro</strong></span> a estimar y de <span class="hl-purple"><strong>varianza el conocido como standard error</strong></span></p>
<p><span class="math display">\[\widehat{\beta}_j | \left( X=x \right) \sim N \left(\beta_j, SE \left(\widehat{\beta}_j\right)^2 \right), \quad j=0,1\]</span></p>
<div class="fragment">
<p>Por las propiedades de la normal y el teorema central del l√≠mite</p>
<p><span class="math display">\[\frac{\widehat{\beta}_j - \beta_j}{SE \left(\widehat{\beta}_j\right)}| \left( X=x \right) \sim N \left(0, 1 \right), \quad j=0,1\]</span></p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-1" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="math display">\[\widehat{\beta}_j | \left( X=x \right) \sim N \left(\beta_j, SE \left(\widehat{\beta}_j\right)^2 \right), \quad j=0,1\]</span></p>
<p>Veremos m√°s adelante porqu√© pero de momento‚Ä¶estos son los <span class="math inline">\(SE\)</span></p>
<p><span class="math display">\[SE \left(\widehat{\beta}_0\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n}\left[ 1+ \frac{\overline{x}^2}{s_{x}^2} \right], \quad SE \left(\widehat{\beta}_1\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n s_{x}^2}\]</span></p>
<div class="fragment">
<p>¬øQu√© <strong>propiedades</strong> tienen estos estimadores?</p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-2" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="math display">\[\widehat{\beta}_j | \left( X=x \right) \sim N \left(\beta_j, SE \left(\widehat{\beta}_j\right)^2 \right), \quad j=0,1\]</span></p>
<p><span class="math display">\[SE \left(\widehat{\beta}_0\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n}\left[ 1+ \frac{\overline{x}^2}{s_{x}^2} \right], \quad SE \left(\widehat{\beta}_1\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n s_{x}^2}\]</span></p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Insesgados</strong></span>: ambos son <span class="hl-green"><strong>estimadores insesgados</strong></span> ya que la esperanza de la estimaci√≥n es el valor a estimar. <span class="math inline">\(E \left[ \widehat{\beta}_j \right] = \beta_j\)</span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Precisi√≥n vs tama√±o muestral</strong></span>: cuando <span class="math inline">\(n \to \infty\)</span>, sus varianzas tienden a cero, es decir, <span class="math inline">\(SE \left(\widehat{\beta}_j\right)^2 \to^{n \to \infty} 0\)</span> ya que <span class="math inline">\(n\)</span> est√° dividiendo. Traducci√≥n: <span class="hl-green"><strong>a m√°s datos, mayor precision</strong></span> (menos varianza tendr√°n los estimadores si repetimos la toma de muestras)</li>
</ul>
</div>
</section>
<section id="inferencia-de-los-par√°metros-3" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="math display">\[SE \left(\widehat{\beta}_0\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n}\left[ 1+ \frac{\overline{x}^2}{s_{x}^2} \right], \quad SE \left(\widehat{\beta}_1\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n s_{x}^2}\]</span></p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Precisi√≥n vs var residual</strong></span>: cuanto m√°s grande sea la varianza del error <span class="math inline">\(\sigma_{\varepsilon}^{2}\)</span>, <span class="math inline">\(SE \left(\widehat{\beta}_j\right)^2\)</span> crecer√° (es decir, <span class="hl-red"><strong>m√°s ruido implicar√° m√°s imprecisi√≥n</strong></span>)</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Precisi√≥n vs varianza de X</strong></span>: cuanto m√°s grande sea la varianza de la predictora <span class="math inline">\(s_{x}^2\)</span>, <span class="math inline">\(SE \left(\widehat{\beta}_j\right)^2\)</span> decrecer√°, tal que <span class="math inline">\(SE \left(\widehat{\beta}_j\right)^2 \to^{s_{x}^2 \to \infty} 0\)</span>. Dicho de otra forma: cu√°nta <span class="hl-green"><strong>m√°s informaci√≥n (varianza) contenga nuestra tabla, mayor precisi√≥n</strong></span>.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Precisi√≥n vs media X</strong></span>: solo afecta a la estimaci√≥n de <span class="math inline">\(\beta_0\)</span>, cuya <span class="hl-red"><strong>precisi√≥n decrece cuando la media aumenta</strong></span>. Esto tiene sentido ya que cu√°nto m√°s grande en media sean los datos, menos fiable ser√° la predicci√≥n para <span class="math inline">\(X=0\)</span>.</li>
</ul>
</div>
</section>
<section id="inferencia-de-los-par√°metros-4" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="math display">\[\widehat{\beta}_j | \left( X=x \right) \sim N \left(\beta_j, SE \left(\widehat{\beta}_j\right)^2 \right), \quad j=0,1\]</span></p>
<p><span class="math display">\[SE \left(\widehat{\beta}_0\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n}\left[ 1+ \frac{\overline{x}^2}{s_{x}^2} \right], \quad SE \left(\widehat{\beta}_1\right)^2 = \frac{\sigma_{\varepsilon}^{2}}{n s_{x}^2}\]</span></p>
<p>Pero tenemos un problema: la <span class="hl-yellow"><strong>varianza residual poblacional</strong></span> (varianza poblaci√≥n del error) <span class="math inline">\(\sigma_{\varepsilon}^{2}\)</span> es <span class="hl-yellow"><strong>desconocida</strong></span>. Como suele pasar, la <span class="hl-yellow"><strong>sustituiremos por un estimador (insesgado)</strong></span> de la misma (ya demostaremos‚Ä¶), donde <span class="math inline">\(p\)</span> es el n√∫mero de variables (lo que R llama <code>std error</code> en la salida)</p>
<div class="fragment">
<p><span class="math display">\[\widehat{\sigma_{\varepsilon}^{2}} = \frac{n}{n-p-1} s_{r}^{2} = \frac{1}{n-p-1} \displaystyle \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^2 =_{p=1} \frac{1}{n-2} \displaystyle \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^2\]</span></p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-5" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="math display">\[\frac{\widehat{\beta}_j - \beta_j}{SE \left(\widehat{\beta}_j\right)} | \left( X=x \right) \sim N \left(0, 1 \right), \quad j=0,1\]</span></p>
<p>¬øQu√© suele suceder cuando en una normal <strong>desconocemos la varianza real y la sustituimos por su estimador insesgado</strong>?</p>
<div class="fragment">
<p>Si <span class="hl-yellow"><strong>sustituimos el error standard por su estimador</strong></span> (sustituyendo la varianza residual por su estimador insesgado), obtenemos que sigue una <strong>t-Student</strong></p>
<p><span class="math display">\[\frac{\widehat{\beta}_j - \beta_j}{\widehat{SE} \left(\widehat{\beta}_j\right)} | \left( X=x \right) \sim t_{n-p-1} , \quad j=0,1\]</span> donde <span class="math inline">\(\widehat{SE} \left(\widehat{\beta}_0\right)^2 = \frac{\widehat{\sigma_{\varepsilon}^{2}}}{n}\left[ 1+ \frac{\overline{x}^2}{s_{x}^2} \right]\)</span> y <span class="math inline">\(\widehat{SE} \left(\widehat{\beta}_1\right)^2 = \frac{\widehat{\sigma_{\varepsilon}^{2}}}{n s_{x}^2}\)</span></p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-6" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<ul>
<li><code>std error</code>: es lo que hemos denotado como <span class="math inline">\(\widehat{SE} \left(\widehat{\beta}_j\right)^2\)</span></li>
</ul>
<div class="fragment">
<ul>
<li><code>t value</code>: es el estad√≠stico <span class="math inline">\(\frac{\widehat{\beta}_j - 0}{\widehat{SE} \left(\widehat{\beta}_j\right)}\)</span> que hemos dicho que sigue una t-Student (f√≠jate que hemos puesto <span class="math inline">\(\beta_j = 0\)</span>)</li>
</ul>
</div>
</section>
<section id="inferencia-de-los-par√°metros-7" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<ul>
<li><code>Pr(&gt;|t|)</code>: representa un p-valor. ¬øDe qu√© contraste se te ocurre?</li>
</ul>
<div class="fragment">
<ul>
<li><code>Residual standard error</code>: es el estimador insesgado de la varianza residual, que hemos denotado como <span class="math inline">\(\widehat{\sigma_{\varepsilon}^{2}}\)</span></li>
</ul>
</div>
</section>
<section id="inferencia-de-los-par√°metros-8" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<div class="columns">
<div class="column" style="width:55%;">
<p><span class="math display">\[\frac{\widehat{\beta}_j - \beta_j}{\widehat{SE} \left(\widehat{\beta}_j\right)} | \left( X=x \right) \sim t_{n-p-1} , \quad j=0,1\]</span></p>
</div><div class="column" style="width:45%;">
<p><img data-src="img/tablas-intervalos.png"></p>
</div>
</div>
<p>Si te acuerdas de inferencia, esto implica que los <span class="hl-yellow"><strong>intervalos de confianza de nuestros par√°metros</strong></span> son</p>
<p><span class="math display">\[IC \left(\alpha, \widehat{\beta}_j \right) = \left[\widehat{\beta}_j - t_{n-p-1; \alpha/2} \widehat{SE} \left(\widehat{\beta}_j\right), \widehat{\beta}_j + t_{n-p-1; \alpha/2} \widehat{SE} \left(\widehat{\beta}_j\right) \right]\]</span> donde <span class="math inline">\(t_{n-p-1; \alpha/2}\)</span> es el cuantil <span class="math inline">\(1-\alpha/2\)</span> (deja a la izquierda una probabilidad de <span class="math inline">\(1-\alpha/2\)</span>).</p>
</section>
<section id="inferencia-de-los-par√°metros-9" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p>Podemos calcular los intervalos de confianza de los par√°metros en <code>R</code> con <code>confint()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">confint</span>(ajuste_lineal, <span class="at">level =</span> <span class="fl">0.99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  0.5 %     99.5 %
(Intercept) -310.022729 282.402102
height        -1.029793   2.306935</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">confint</span>(ajuste_lineal, <span class="at">level =</span> <span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   2.5 %     97.5 %
(Intercept) -236.3934126 208.772785
height        -0.6150891   1.892231</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">confint</span>(ajuste_lineal, <span class="at">level =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     5 %       95 %
(Intercept) -199.6638922 172.043265
height        -0.4082166   1.685359</code></pre>
</div>
</div>
</section>
<section id="inferencia-de-los-par√°metros-10" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="hl-yellow"><strong>¬øQu√© significa realmente un intervalo de confianza?</strong></span></p>
<div class="fragment">
<p>La <strong>probabilidad de que el par√°metro real</strong> caiga dentro <span class="hl-red"><strong>NO EXISTE</strong></span>: el par√°metro es desconocido pero fijo, no aleatorio, as√≠ que no sentido calcular su probabilidad.</p>
</div>
<div class="fragment">
<p>Si obtenemos para un par√°metro un intervalo <span class="math inline">\([-1, 1]\)</span> al 95%, no significa que <span class="math inline">\(P(parametro \in [-1, 1]) = 0.95\)</span>: significa que <span class="hl-yellow"><strong>si tomamos 1000 muestras distintas de la poblaci√≥n</strong></span> y calculamos para cada una el intervalo de confianza, <span class="hl-yellow"><strong>aproximadamente 950 intervalos de confianza contendr√°n dentro el par√°metro real</strong></span></p>
</div>
<div class="fragment">
<p>Un <span class="hl-yellow"><strong>intervalo al 95% implica que habr√° una frecuencia esperada de 0.95</strong></span> de que intervalos que no conocemos (porque se derivan de muestras que no hemos tomado) contengan al par√°metro real, pero <span class="hl-red"><strong>no es la probabilidad de que tu intervalo calculado contenga a dicho par√°metro</strong></span>: nos habla la precisi√≥n de nuestra metodolog√≠a de estimaci√≥n, no del par√°metro.</p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-11" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="hl-yellow"><strong>Deberes</strong></span>. Dada una poblaci√≥n normal <span class="math inline">\(\mu = 3\)</span> y <span class="math inline">\(\sigma = 1.2\)</span>, crea un c√≥digo que genere 500 muestras distintas (tama√±o <span class="math inline">\(n = 100\)</span> cada una), de manera que para cada una apliques un <code>t.test()</code> para calcular un IC para <span class="math inline">\(\mu\)</span>. Tras ello, gr√°fica los intervalos como se muestra en la imagen (haz uso de <code>geom_segment()</code>)</p>

<img data-src="index_files/figure-revealjs/unnamed-chunk-24-1.png" width="960" class="r-stretch"></section>
<section id="inferencia-de-los-par√°metros-12" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p>Y si tenemos inferencia, tenemos contrastes: ¬øte acuerdas de los p-valores que devuelve la tabla para cada par√°metro?</p>
<div class="fragment">
<p>Para cada par√°metro se realiza un <span class="hl-yellow"><strong>contraste de significancia</strong></span>: ¬øcu√°nta evidencia hay en mis datos para poder decir que el <span class="hl-yellow"><strong>valor estimado de mi par√°metro es distinto de 0</strong></span>?</p>
<p><span class="math display">\[H_0:~\widehat{\beta}_j = 0 \quad vs \quad H_1:~\widehat{\beta}_j \neq 0\]</span></p>
</div>
<div class="fragment">
<p>El estad√≠stico usado es el <span class="hl-yellow"><strong>t value</strong></span> que devuelve <code>R</code> definido como <span class="math inline">\(\frac{\widehat{\beta}_j - 0}{\widehat{SE} \left(\widehat{\beta}_j\right)}\)</span> y que, <span class="hl-purple"><strong>BAJO EL SUPUESTO DE QUE LA HIP√ìTESIS NULA SEA CIERTA</strong></span>, sigue una t-Student <span class="math inline">\(t_{n-p-1}\)</span></p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-13" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p><span class="math display">\[H_0:~\widehat{\beta}_j = 0 \quad vs \quad H_1:~\widehat{\beta}_j \neq 0\]</span></p>
<p>Este contraste significancia en realidad <strong>contesta a la siguiente pregunta</strong></p>
<p>¬øTiene mi variable <span class="math inline">\(X_j\)</span> un <span class="hl-yellow"><strong>efecto lineal SIGNIFICATIVO</strong></span> en mi variable <span class="math inline">\(Y\)</span>?</p>
<div class="fragment">
<p>&nbsp;</p>
<p>Esa pregunta puede ser respondida desde un punto de vista <strong>frecuentista</strong> haciendo uso de los <span class="hl-yellow"><strong>p-valores</strong></span>: si <span class="math inline">\(p-value &lt; \alpha\)</span>, se suele rechazar la nula (rechazamos que la variable no tenga efecto lineal significativo, es decir, aceptamos que s√≠ lo tiene); en caso contrario no se suele rechazar (que <strong>no es lo mismo que aceptarla</strong>). Pero‚Ä¶</p>
</div>
</section>
<section id="par√©ntesis-p-valor" class="slide level2">
<h2>Par√©ntesis: p-valor</h2>
<p><span class="hl-yellow"><strong>¬øQu√© representa un p-valor?</strong></span></p>
<div class="fragment">
<p>Hablaremos m√°s adelante de ellos pero este es un <span class="hl-yellow"><strong>peque√±o resumen respecto al consenso</strong></span> recogido en 2016 por la ASA (American Statistical Association) en su trabajo <a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true</a></p>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Habla sobre los datos</strong></span>. Los p-valores nos pueden servir como indicadores de <strong>c√≥mo de incompatible son los datos respecto a un modelo/hipotesis/explicaci√≥n asumida</strong>: habla sobre los datos, no sobre la veracidad de la hipotesis nula per se o la probabilidad de que los datos hayan salido tan extremos por azar.</li>
</ul>
</div>
</section>
<section id="par√©ntesis-p-valor-1" class="slide level2">
<h2>Par√©ntesis: p-valor</h2>
<p><span class="hl-yellow"><strong>¬øQu√© representa un p-valor?</strong></span></p>
<p>Hablaremos m√°s adelante de ellos pero este es un <span class="hl-yellow"><strong>peque√±o resumen respecto al consenso</strong></span> recogido en 2016 por la ASA (American Statistical Association) en su trabajo <a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true</a></p>
<ul>
<li><span class="hl-yellow"><strong>Realidades complejas, decisiones complejas</strong></span>. Cuidado con reducir a decisiones binarias realidades complejas. La regla del p-valor es una herramienta m√°s, pero no debe ser la √∫nica en la que nos basemos para decidir. <span class="hl-yellow"><strong>Otros aspectos a considerar</strong></span>: calidad de las medidas, dise√±o del estudio, evidencia externa en la literatura respecto a la causalidad subyacente, validez de las hip√≥tesis planteadas, etc</li>
</ul>
</section>
<section id="par√©ntesis-p-valor-2" class="slide level2">
<h2>Par√©ntesis: p-valor</h2>
<p><span class="hl-yellow"><strong>¬øQu√© representa un p-valor?</strong></span></p>
<p>Hablaremos m√°s adelante de ellos pero este es un <span class="hl-yellow"><strong>peque√±o resumen respecto al consenso</strong></span> recogido en 2016 por la ASA (American Statistical Association) en su trabajo <a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true</a></p>
<ul>
<li><span class="hl-red"><strong>No hagas cherry picking</strong></span>: muestra de manera transparentes que has probado, que ha salido y que no, y no te quedes solo con lo que sale bien o los p-valores que te convenga (<strong>p-hacking</strong>).</li>
</ul>
</section>
<section id="par√©ntesis-p-valor-3" class="slide level2">
<h2>Par√©ntesis: p-valor</h2>
<p><span class="hl-yellow"><strong>¬øQu√© representa un p-valor?</strong></span></p>
<p>Hablaremos m√°s adelante de ellos pero este es un <span class="hl-yellow"><strong>peque√±o resumen respecto al consenso</strong></span> recogido en 2016 por la ASA (American Statistical Association) en su trabajo <a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true</a></p>
<ul>
<li><span class="hl-yellow"><strong>Significancia estad√≠stica</strong></span> no implica significacia real (cient√≠fica, humana, econ√≥mica, etc). Obtener <span class="hl-red"><strong>p-valores muy peque√±os no implica un mayor efecto</strong></span> que otros p-valores no tan peque√±os (y viceversa). <span class="hl-yellow"><strong>Cualquier efecto, por peque√±o que sea, puede derivar en p-valores peque√±os si el tama√±o uestral o la precisi√≥n de las medidas es suficiente alto</strong></span>, y al contrario (efectos evidentes pueden derivar en p-valores altos si <span class="math inline">\(n\)</span> es peque√±o)</li>
</ul>
</section>
<section id="par√©ntesis-p-valor-4" class="slide level2">
<h2>Par√©ntesis: p-valor</h2>
<p><span class="hl-yellow"><strong>¬øQu√© representa un p-valor?</strong></span></p>
<p>Hablaremos m√°s adelante de ellos pero este es un <span class="hl-yellow"><strong>peque√±o resumen respecto al consenso</strong></span> recogido en 2016 por la ASA (American Statistical Association) en su trabajo <a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true</a></p>
<ul>
<li><span class="hl-purple"><strong>Alternativas</strong></span>: intervalos de confianza, de credibilidad, m√©todos bayesianos, false discovery rates.</li>
</ul>
<p>&nbsp;</p>
<p>üìö Ver m√°s en <a href="https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true" class="uri">https://www.tandfonline.com/doi/epdf/10.1080/00031305.2016.1154108?needAccess=true</a>, <a href="https://anabelforte.com/2020/11/15/contraste/" class="uri">https://anabelforte.com/2020/11/15/contraste/</a> y <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4877414/" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4877414/</a></p>
</section>
<section id="inferencia-de-los-par√°metros-14" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -61.43  -30.03  -21.13  -17.73 1260.06 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) -13.8103   111.1545  -0.124    0.902
height        0.6386     0.6261   1.020    0.312

Residual standard error: 169.4 on 57 degrees of freedom
Multiple R-squared:  0.01792,   Adjusted R-squared:  0.0006956 
F-statistic:  1.04 on 1 and 57 DF,  p-value: 0.312</code></pre>
</div>
</div>
<p>Si te fijas ambos p-valores est√°n por encima de <span class="math inline">\(\alpha = 0.05\)</span> (umbral adoptado habitualmente) los que nos dice que <span class="hl-yellow"><strong>no hay evidencias de los datos sean compatibles con afirmar que haya efectos lineales significativos</strong></span></p>
<div class="fragment">
<p>¬øY si probamos a quitar <span class="math inline">\(\beta_0\)</span> (es decir, la respuesta est√° centrada)?</p>
</div>
</section>
<section id="inferencia-de-los-par√°metros-15" class="slide level2">
<h2>Inferencia de los par√°metros</h2>
<p>Para ello basta a√±adir un <code>-1</code> antes de las variables predictoras.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> mass <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> height) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mass ~ -1 + height, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
 -60.53  -29.45  -21.98  -18.50 1259.59 

Coefficients:
       Estimate Std. Error t value Pr(&gt;|t|)    
height   0.5623     0.1232   4.566 2.64e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 168 on 58 degrees of freedom
Multiple R-squared:  0.2644,    Adjusted R-squared:  0.2517 
F-statistic: 20.85 on 1 and 58 DF,  p-value: 2.638e-05</code></pre>
</div>
</div>
<p>F√≠jate que ahora, am√©n que <span class="hl-yellow"><strong>hay un efecto lineal significativo de la altura</strong></span> y de tener <span class="math inline">\(R^2\)</span> mayor, <span class="math inline">\(\beta_1\)</span> tiene una precisi√≥n mayor. En este caso <span class="hl-yellow"><strong>solo pod√≠a quitar uno</strong></span> (perder√≠amos <span class="math inline">\(X\)</span>), pero veremos m√°s adelante c√≥mo decidir cu√°l quitar si tuvi√©semos varias variables.</p>
</section></section>
<section>
<section id="clase-7-8" class="title-slide slide level1 center">
<h1>Clases 7 y 8: caso pr√°ctico</h1>
<p><span style="color:#444442;"><strong>¬øDe qu√© depende el precio del vino?</strong></span></p>
</section>
<section id="caso-pr√°ctico" class="slide level2">
<h2>Caso pr√°ctico</h2>
<p>Vamos a poner en pr√°ctica lo aprendido con el dataset <code>wine.csv</code> disponible en el campus.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/wine.csv"</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 √ó 7
    Year Price WinterRain  AGST HarvestRain   Age FrancePop
   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1  1952  7.50        600  17.1         160    31    43184.
 2  1953  8.04        690  16.7          80    30    43495.
 3  1955  7.69        502  17.2         130    28    44218.
 4  1957  6.98        420  16.1         110    26    45152.
 5  1958  6.78        582  16.4         187    25    45654.
 6  1959  8.08        485  17.5         187    24    46129.
 7  1960  6.52        763  16.4         290    23    46584.
 8  1961  8.49        830  17.3          38    22    47128.
 9  1962  7.39        697  16.3          52    21    48089.
10  1963  6.71        608  15.7         155    20    48799.
# ‚Ñπ 17 more rows</code></pre>
</div>
</div>
</section>
<section id="caso-pr√°ctico-1" class="slide level2">
<h2>Caso pr√°ctico</h2>
<p>El conjunto de datos est√° formado por 27 observaciones (cosechas de vino rojo Burdeos) y 7 variables</p>
<ul>
<li><code>Year</code>, <code>Age</code>: a√±o de la cosecha y n√∫mero de a√±os en barrica.</li>
<li><code>Price</code>: precio en 1990-1991 de cada cosecha (en <strong>escala log</strong>)</li>
<li><code>WinterRain</code>: lluvia (en mm) que cay√≥ ese a√±o en invierno.</li>
<li><code>AGST</code>: crecimiento medio de la temperatura (en grados Celsius) durante la temporada.</li>
<li><code>HarvestRain</code>: lluvia (en mm) que cay√≥ ese a√±o durante la cosecha.</li>
<li><code>FrancePop</code>: poblaci√≥n (miles de habitantes) de Francia.</li>
</ul>
<p>Ver m√°s en detalles en <a href="https://doi.org/10.1080/09332480.1995.10542468" class="uri">https://doi.org/10.1080/09332480.1995.10542468</a></p>
<div class="fragment">
<p><span class="hl-yellow"><strong>El objetivo: predecir el precio</strong></span></p>
</div>
</section>
<section id="caso-pr√°ctico-2" class="slide level2">
<h2>Caso pr√°ctico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 √ó 7
    Year Price WinterRain  AGST HarvestRain   Age FrancePop
   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1  1952  7.50        600  17.1         160    31    43184.
 2  1953  8.04        690  16.7          80    30    43495.
 3  1955  7.69        502  17.2         130    28    44218.
 4  1957  6.98        420  16.1         110    26    45152.
 5  1958  6.78        582  16.4         187    25    45654.
 6  1959  8.08        485  17.5         187    24    46129.
 7  1960  6.52        763  16.4         290    23    46584.
 8  1961  8.49        830  17.3          38    22    47128.
 9  1962  7.39        697  16.3          52    21    48089.
10  1963  6.71        608  15.7         155    20    48799.
# ‚Ñπ 17 more rows</code></pre>
</div>
</div>
<p>Para predecir el precio vamos a usar (de momento) una <span class="hl-yellow"><strong>regresi√≥n lineal univariante</strong></span>, donde <span class="math inline">\(Y = precio\)</span> y deberemos elegir la predictora <span class="math inline">\(X\)</span> m√°s apropiada.</p>
</section>
<section id="pasos-a-seguir" class="slide level2">
<h2>Pasos a seguir</h2>
<ol type="1">
<li><span class="hl-yellow"><strong>An√°lisis exploratorio inicial</strong></span>:</li>
</ol>
<ul>
<li>¬øLas variables son <span class="hl-purple"><strong>num√©ricas (continuas)</strong></span>?</li>
<li>¬øTienen <span class="hl-purple"><strong>problemas de rango</strong></span> (por ejemplo, pesos negativos)? ¬øTienen datos ausentes?</li>
<li>¬øC√≥mo se <span class="hl-purple"><strong>distribuyen las variables</strong></span>? Ideas: res√∫men num√©rico, histogramas/densidades, boxplots, gr√°ficos de viol√≠n, etc</li>
<li>¬øHay <span class="hl-purple"><strong>datos at√≠picos</strong></span>?</li>
</ul>
</section>
<section id="pasos-a-seguir-1" class="slide level2">
<h2>Pasos a seguir</h2>
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>An√°lisis de dependencia</strong></span>:</li>
</ol>
<ul>
<li>¬øQu√© <span class="hl-purple"><strong>predictora est√° m√°s correlacionada (linealmente) con la variable objetivo</strong></span> a predecir? ¬øExiste otro tipo de dependencia (pendiente implementar en <code>R</code>)?</li>
<li>¬øC√≥mo se <span class="hl-purple"><strong>relacionan las predictoras</strong></span> entre s√≠? ¬øEst√°n correlacionadas? Ideas: matriz de correlaciones, diagramas de dispersi√≥n vs Y, corrplots, etc</li>
</ul>
<div class="fragment">
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Formulaci√≥n</strong></span> del modelo</li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><span class="hl-yellow"><strong>Fase de estimaci√≥n</strong></span>:</li>
</ol>
<ul>
<li>¬øCu√°nto valen los <span class="hl-purple"><strong>par√°metros estimados</strong></span>? ¬øC√≥mo queda el ajuste?</li>
<li>¬øQu√© <span class="hl-purple"><strong>interpretaci√≥n</strong></span> tienen?</li>
</ul>
</div>
</section>
<section id="pasos-a-seguir-2" class="slide level2">
<h2>Pasos a seguir</h2>
<ol start="5" type="1">
<li><span class="hl-yellow"><strong>Fase de diagnosis</strong></span> (paquetes <code>{performance}</code> y <code>{olsrr}</code>):</li>
</ol>
<ul>
<li>¬øCumplen los datos las <span class="hl-purple"><strong>hip√≥tesis par√°metricas</strong></span> requeridas para poder hacer inferencia?</li>
<li>¬øC√≥mo modificar los datos para que se cumplan?</li>
<li>An√°lisis de residuales</li>
</ul>
<div class="fragment">
<ol start="6" type="1">
<li><span class="hl-yellow"><strong>Fase de inferencia</strong></span>:</li>
</ol>
<ul>
<li>¬øQu√© <span class="hl-purple"><strong>variabilidad</strong></span> tienen las estimaciones de nuestro par√°metros?</li>
<li>¬øLas predictoras/intercepto tienen un <span class="hl-purple"><strong>efecto lineal significativo</strong></span>?</li>
<li>¬øDebemos <span class="hl-purple"><strong>re-entrenar el modelo</strong></span> sin alguno de ellos?</li>
</ul>
</div>
</section>
<section id="pasos-a-seguir-3" class="slide level2">
<h2>Pasos a seguir</h2>
<ol start="7" type="1">
<li><span class="hl-yellow"><strong>Fase de evaluaci√≥n</strong></span>:</li>
</ol>
<ul>
<li>¬øEs significativo el modelo? <span class="hl-purple"><strong>ANOVA: an√°lisis de la varianza</strong></span></li>
<li>¬øQu√© informaci√≥n de la predictora explica el modelo? <span class="hl-purple"><strong>Par√°metros de bondad de ajuste</strong></span> (<span class="math inline">\(R^2\)</span> por ejemplo)</li>
</ul>
<div class="fragment">
<ol start="8" type="1">
<li><span class="hl-yellow"><strong>Fase de predicci√≥n</strong></span></li>
</ol>
</div>
</section>
<section id="an√°lisis-exploratorio-inicial" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<ol type="1">
<li><span class="hl-yellow"><strong>An√°lisis exploratorio inicial</strong></span>:</li>
</ol>
<ul>
<li>¬øLas variables son <span class="hl-purple"><strong>num√©ricas (continuas)</strong></span>?</li>
<li>¬øTienen <span class="hl-purple"><strong>problemas de rango</strong></span> (por ejemplo, pesos negativos)? ¬øTienen datos ausentes?</li>
</ul>
<p>&nbsp;</p>
<p>Para responder a dichas preguntas lo m√°s sencillos es hacer uso de la funci√≥n <code>skim()</code> del paquete <code>{skimr}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">library</span>(skimr)</span>
<span id="cb52-2"><a href="#cb52-2"></a>datos <span class="sc">|&gt;</span> <span class="fu">skim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>En este caso <span class="hl-green"><strong>no tenemos ausentes ni problemas de codificaci√≥n</strong></span></p>
</div>
</section>
<section id="an√°lisis-exploratorio-inicial-1" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<ul>
<li>¬øC√≥mo se <span class="hl-purple"><strong>distribuyen las variables</strong></span>?</li>
<li>¬øHay <span class="hl-purple"><strong>datos at√≠picos</strong></span>?</li>
</ul>
<p>&nbsp;</p>
<p>Para ello podemos <span class="hl-yellow"><strong>visualizar la distribuci√≥n de cada variable</strong></span> haciendo uso de densidades, histogramas y/o boxplots (por ejemplo), pero si queremos ahorrar tiempo en visualizar convertimos nuestro dataset en <span class="hl-yellow"><strong>tidydata</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>datos_tidy <span class="ot">&lt;-</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>  datos <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"variable"</span>, <span class="at">values_to =</span> <span class="st">"values"</span>)</span>
<span id="cb53-4"><a href="#cb53-4"></a>datos_tidy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 189 √ó 2
   variable      values
   &lt;chr&gt;          &lt;dbl&gt;
 1 Year         1952   
 2 Price           7.50
 3 WinterRain    600   
 4 AGST           17.1 
 5 HarvestRain   160   
 6 Age            31   
 7 FrancePop   43184.  
 8 Year         1953   
 9 Price           8.04
10 WinterRain    690   
# ‚Ñπ 179 more rows</code></pre>
</div>
</div>
</section>
<section id="an√°lisis-exploratorio-inicial-2" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">ggplot</span>(datos_tidy, <span class="fu">aes</span>(<span class="at">x =</span> values)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable, <span class="at">fill =</span> variable),</span>
<span id="cb55-3"><a href="#cb55-3"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_fill_colorblind</span>() <span class="sc">+</span></span>
<span id="cb55-6"><a href="#cb55-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb55-7"><a href="#cb55-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-31-1.png" width="960" class="r-stretch"></section>
<section id="an√°lisis-exploratorio-inicial-3" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">ggplot</span>(datos_tidy, <span class="fu">aes</span>(<span class="at">x =</span> values)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable, <span class="at">fill =</span> variable),</span>
<span id="cb56-3"><a href="#cb56-3"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_fill_colorblind</span>() <span class="sc">+</span></span>
<span id="cb56-6"><a href="#cb56-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb56-7"><a href="#cb56-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-32-1.png" width="960" class="r-stretch"></section>
<section id="an√°lisis-exploratorio-inicial-4" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">ggplot</span>(datos_tidy, <span class="fu">aes</span>(<span class="at">x =</span> values)) <span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable, <span class="at">fill =</span> variable),</span>
<span id="cb57-3"><a href="#cb57-3"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>, <span class="at">bins =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_fill_colorblind</span>() <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-33-1.png" width="960" class="r-stretch"></section>
<section id="an√°lisis-exploratorio-inicial-5" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">ggplot</span>(datos_tidy, <span class="fu">aes</span>(<span class="at">y =</span> values, <span class="at">x =</span> variable)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable, <span class="at">fill =</span> variable),</span>
<span id="cb58-3"><a href="#cb58-3"></a>               <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_fill_colorblind</span>() <span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb58-7"><a href="#cb58-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-34-1.png" width="960" class="r-stretch"><p><span class="hl-green"><strong>No hay valores at√≠picos (respecto a los percentiles)</strong></span></p>
</section>
<section id="an√°lisis-exploratorio-inicial-6" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<p>Podemos incluso gr√°ficar todos los scatter plot sin transformar los datos con <code>facet_matrix()</code> del paquete <code>{ggforce}</code></p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb59-2"><a href="#cb59-2"></a><span class="fu">ggplot</span>(datos) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> .panel_x, <span class="at">y =</span> .panel_y)) <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>  <span class="fu">facet_matrix</span>(<span class="fu">vars</span>(<span class="fu">everything</span>())) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_fill_colorblind</span>() <span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-35-1.png" width="960" class="r-stretch"></section>
<section id="an√°lisis-exploratorio-inicial-7" class="slide level2">
<h2>An√°lisis exploratorio inicial</h2>
<p>Podemos tambi√©n visualizar con un <span class="hl-yellow"><strong>scatter plot</strong></span> todas las variables y adem√°s sus correlaciones, con el paquete <code>{GGally}</code> y la funci√≥n `ggpairs(), sin necesidad de convertir a tidydata.</p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="fu">ggpairs</span>(datos) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-36-1.png" width="960" class="r-stretch"></section>
<section id="an√°lisis-de-dependencia" class="slide level2">
<h2>An√°lisis de dependencia</h2>
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>An√°lisis de dependencia</strong></span>:</li>
</ol>
<ul>
<li>¬øQu√© <span class="hl-purple"><strong>predictora est√° m√°s correlacionada (linealmente) con la variable objetivo</strong></span> a predecir? ¬øExiste otro tipo de dependencia (pendiente implementar en <code>R</code>)?</li>
<li>¬øC√≥mo se <span class="hl-purple"><strong>relacionan las predictoras</strong></span> entre s√≠? ¬øEst√°n correlacionadas? Ideas: matriz de correlaciones, diagramas de dispersi√≥n vs Y, corrplots, etc</li>
</ul>
<div class="fragment">
<p>Este paso ser√° crucial en el <span class="hl-yellow"><strong>contexto multivariante</strong></span> pero en este caso simplemente vamos a ver como se relacionan linealmente las predictoras entre s√≠, y cu√°l de ellas es la <strong>m√°s adecuada para predecir linealmente</strong> <code>precio</code></p>
</div>
</section>
<section id="an√°lisis-de-dependencia-1" class="slide level2">
<h2>An√°lisis de dependencia</h2>
<p>El primer paso es la <span class="hl-yellow"><strong>matriz de correlaciones</strong></span> con la funci√≥n <code>cor()</code> o con la funci√≥n <code>correlate()</code> del paquete <code>{corrr}</code> (importa en tibble m√°s visual)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb61-2"><a href="#cb61-2"></a>datos <span class="sc">|&gt;</span> <span class="fu">correlate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 √ó 8
  term           Year  Price WinterRain    AGST HarvestRain     Age FrancePop
  &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
1 Year        NA      -0.460     0.0512 -0.295      -0.0588 -1         0.992 
2 Price       -0.460  NA         0.135   0.668      -0.507   0.460    -0.481 
3 WinterRain   0.0512  0.135    NA      -0.321      -0.268  -0.0512    0.0295
4 AGST        -0.295   0.668    -0.321  NA          -0.0271  0.295    -0.301 
5 HarvestRain -0.0588 -0.507    -0.268  -0.0271     NA       0.0588   -0.0320
6 Age         -1       0.460    -0.0512  0.295       0.0588 NA        -0.992 
7 FrancePop    0.992  -0.481     0.0295 -0.301      -0.0320 -0.992    NA     </code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li><p><span class="hl-yellow"><strong>Respecto a Y</strong></span>: predictoras con mayor cor lineal son <code>AGST</code> (m√°s calor, menos cosechas, sube el precio) y <code>HarvestRain</code> (m√°s lluvias, m√°s cosechas, baja el precio, ¬°el signo importa!)</p></li>
<li><p><span class="hl-yellow"><strong>Dependencia entre predictoras</strong></span>: las variables <code>Age</code>, <code>Year</code> y <code>FrancePop</code> presentan la misma informaci√≥n.</p></li>
</ul>
</div>
</section>
<section id="an√°lisis-de-dependencia-2" class="slide level2">
<h2>An√°lisis de dependencia</h2>
<p>Tambi√©n podemos usar <code>corrplot()</code> del paquete <code>{corrplot}</code>, al que le pasamos una matriz de correlaciones cl√°sica y nos la <span class="hl-yellow"><strong>visualiza</strong></span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb63-2"><a href="#cb63-2"></a>datos <span class="sc">|&gt;</span> <span class="fu">cor</span>() <span class="sc">|&gt;</span> <span class="fu">corrplot</span>(<span class="at">method =</span> <span class="st">"ellipse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-38-1.png" width="960" class="r-stretch"><p>Puedes ver distintas opciones de visualizaci√≥n en <a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html" class="uri">https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html</a></p>
</section>
<section id="an√°lisis-de-dependencia-3" class="slide level2">
<h2>An√°lisis de dependencia</h2>
<p>Otra opci√≥n es <span class="hl-yellow"><strong>visualizar con un scatter plots todas las predictoras vs Y</strong></span>, pivotando antes nuestro dataset (solo pivotamos las predictoras)</p>
<div class="columns">
<div class="column" style="width:65%;">
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>datos_tidy <span class="ot">&lt;-</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  datos <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Price, <span class="at">names_to =</span> <span class="st">"variable"</span>,</span>
<span id="cb64-3"><a href="#cb64-3"></a>                        <span class="at">values_to =</span> <span class="st">"values"</span>)</span>
<span id="cb64-4"><a href="#cb64-4"></a><span class="fu">ggplot</span>(datos_tidy, <span class="fu">aes</span>(<span class="at">x =</span> values, <span class="at">y =</span> Price)) <span class="sc">+</span> </span>
<span id="cb64-5"><a href="#cb64-5"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> variable), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb64-6"><a href="#cb64-6"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>  ggthemes<span class="sc">::</span><span class="fu">scale_color_colorblind</span>() <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-39-1.png" width="960"></p>
</div>
</div>
</div><div class="column" style="width:35%;">
<p>No solo comprobamos que las rectas con m√°s pendiente son <code>AGST</code> y <code>HarvestRain</code>, adem√°s los puntos parecen poder ajustarse a una recta sin otro patr√≥n identificable.</p>
</div>
</div>
<p>Esto es importante hacerlo ya que debemos <span class="hl-red"><strong>descartar posibles correlaciones esp√∫reas</strong></span> (ver ejemplo datasaurus)</p>
</section>
<section id="formulaci√≥n-del-modelo" class="slide level2">
<h2>Formulaci√≥n del modelo</h2>
<p>Una vez que hemos decidido que dos predictoras usaemos, vamos por tanto a plantear <span class="hl-yellow"><strong>dos modelos univariantes</strong></span></p>
<p><span class="math display">\[Price = \beta_0 + \beta_1*AGST + \varepsilon\]</span> <span class="math display">\[Price = \beta_0 + \beta_1*HarvestRain + \varepsilon\]</span></p>
</section>
<section id="fase-de-estimaci√≥n" class="slide level2">
<h2>Fase de estimaci√≥n</h2>
<ol start="4" type="1">
<li><span class="hl-yellow"><strong>Fase de estimaci√≥n</strong></span>:</li>
</ol>
<ul>
<li>¬øCu√°nto valen los <span class="hl-purple"><strong>par√°metros estimados</strong></span>? ¬øC√≥mo queda el ajuste?</li>
<li>¬øQu√© <span class="hl-purple"><strong>interpretaci√≥n</strong></span> tienen?</li>
</ul>
<p>&nbsp;</p>
<p>Para ello ejecutaremos ambos modelos con <code>lm()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>ajuste_AGST <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> Price <span class="sc">~</span> AGST)</span>
<span id="cb65-2"><a href="#cb65-2"></a>ajuste_harvest <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> Price <span class="sc">~</span> HarvestRain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fase-de-estimaci√≥n-1" class="slide level2">
<h2>Fase de estimaci√≥n</h2>
<p><span class="hl-yellow"><strong>Ajuste con AGST</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>ajuste_AGST <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ AGST, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.5469     2.3641  -1.500 0.146052    
AGST          0.6426     0.1434   4.483 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  0.4456,    Adjusted R-squared:  0.4234 
F-statistic: 20.09 on 1 and 25 DF,  p-value: 0.0001425</code></pre>
</div>
</div>
<ul>
<li><p><span class="math inline">\(\beta_0=\)</span> -3.547: predicci√≥n del precio cuando <span class="math inline">\(AGST = 0\)</span> es de -3 (recuerda que est√° en escala logart√≠mica)</p></li>
<li><p><span class="math inline">\(\beta_1=\)</span> 0.643: por cada grado de aumento, el precio sube 0.643 (escala log).</p></li>
</ul>
</section>
<section id="fase-de-estimaci√≥n-2" class="slide level2">
<h2>Fase de estimaci√≥n</h2>
<p><span class="hl-yellow"><strong>Ajuste con AGST</strong></span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ AGST, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.5469     2.3641  -1.500 0.146052    
AGST          0.6426     0.1434   4.483 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  0.4456,    Adjusted R-squared:  0.4234 
F-statistic: 20.09 on 1 and 25 DF,  p-value: 0.0001425</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Residuales</strong></span>: adem√°s de media cero, parecen presentar una distribuci√≥n sim√©trica con la mediana en torno al cero. Adem√°s se tiene que <span class="math inline">\(\widehat{\sigma}_{\varepsilon}^{2}=\frac{1}{n-2}\sum_{i=1}^{n} \widehat{\varepsilon}_{i}^{2} = 0.4819\)</span> (estimador insesgado de la varianza residual) y <span class="math inline">\(R^2 = 0.4456\)</span> (bondad de ajuste)</li>
</ul>
</section>
<section id="fase-de-estimaci√≥n-3" class="slide level2">
<h2>Fase de estimaci√≥n</h2>
<p><span class="hl-yellow"><strong>Ajuste con harvestRain</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>ajuste_harvest <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ HarvestRain, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.03792 -0.27679 -0.07892  0.40434  1.21958 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.679856   0.241911  31.747  &lt; 2e-16 ***
HarvestRain -0.004405   0.001497  -2.942  0.00693 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5577 on 25 degrees of freedom
Multiple R-squared:  0.2572,    Adjusted R-squared:  0.2275 
F-statistic: 8.658 on 1 and 25 DF,  p-value: 0.00693</code></pre>
</div>
</div>
<ul>
<li><p><span class="math inline">\(\beta_0=\)</span> 7.68: predicci√≥n del precio cuando la lluvia fue nula es de 7.679 (recuerda que est√° en escala logart√≠mica)</p></li>
<li><p><span class="math inline">\(\beta_1=\)</span> -0.004: por cada litro de lluvia, precio baja 642.614 (escala log).</p></li>
</ul>
</section>
<section id="fase-de-estimaci√≥n-4" class="slide level2">
<h2>Fase de estimaci√≥n</h2>
<p><span class="hl-yellow"><strong>Ajuste con harvestRain</strong></span></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ HarvestRain, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.03792 -0.27679 -0.07892  0.40434  1.21958 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.679856   0.241911  31.747  &lt; 2e-16 ***
HarvestRain -0.004405   0.001497  -2.942  0.00693 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5577 on 25 degrees of freedom
Multiple R-squared:  0.2572,    Adjusted R-squared:  0.2275 
F-statistic: 8.658 on 1 and 25 DF,  p-value: 0.00693</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Residuales</strong></span>: adem√°s de media cero, parecen presentar una distribuci√≥n sim√©trica con la mediana en torno al cero. Adem√°s se tiene que <span class="math inline">\(\widehat{\sigma}_{\varepsilon}^{2}=\frac{1}{n-2}\sum_{i=1}^{n} \widehat{\varepsilon}_{i}^{2} = 0.5577\)</span> (algo m√°s grande que el otro ajuste) y <span class="math inline">\(R^2 = 0.2572\)</span> (algo m√°s peque√±o que el otro ajuste) -&gt; de momento es mejor el primer modelo.</li>
</ul>
</section>
<section id="fase-de-diagnosis" class="slide level2">
<h2>Fase de diagnosis</h2>
<ol start="5" type="1">
<li><span class="hl-yellow"><strong>Fase de diagnosis</strong></span> (paquetes <code>{performance}</code> y <code>{olsrr}</code>):</li>
</ol>
<ul>
<li>¬øCumplen los datos las <span class="hl-purple"><strong>hip√≥tesis par√°metricas</strong></span> requeridas para poder hacer inferencia?</li>
<li>¬øC√≥mo modificar los datos para que se cumplan?</li>
<li>An√°lisis de residuales</li>
</ul>
<p>&nbsp;</p>
<p>Recuerda que <span class="hl-yellow"><strong>necesitamos verificar antes las hip√≥tesis</strong></span> para poder hacer inferencia con los par√°metros, as√≠ que vamos a ello con el paquete <code>{performance}</code> y el paquete <code>{olsrr}</code></p>
</section>
<section id="fase-de-diagnosis-1" class="slide level2">
<h2>Fase de diagnosis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">library</span>(performance)</span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="fu">check_model</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-45-1.png" width="960" class="r-stretch"></section>
<section id="diagnosis-linealidad" class="slide level2">
<h2>Diagnosis: linealidad</h2>
<ol type="1">
<li><span class="hl-green"><strong>Linealidad</strong></span>: el valor esperado de <span class="math inline">\(Y\)</span> es <span class="math inline">\(E \left[Y | \boldsymbol{X} = x \right] = \beta_0 + \beta_1 x\)</span></li>
</ol>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">check_model</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-46-1.png" width="960" class="r-stretch"><p>Si te fijas el gr√°fico que se refiere a ello est√° <span class="hl-yellow"><strong>visualizando residuales vs valores estimados</strong></span>: est√° volviendo a plantear un segundo modelo de regresi√≥n donde ahora <span class="math inline">\(\widehat{\varepsilon}_i = \gamma_0 + \gamma_1 \widehat{y}_i\)</span></p>
</section>
<section id="diagnosis-linealidad-1" class="slide level2">
<h2>Diagnosis: linealidad</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>linealidad <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="st">"fitted"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>fitted.values,</span>
<span id="cb74-2"><a href="#cb74-2"></a>                               <span class="st">"residuals"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>residuals),</span>
<span id="cb74-3"><a href="#cb74-3"></a>                 <span class="at">formula =</span> residuals <span class="sc">~</span> fitted)</span>
<span id="cb74-4"><a href="#cb74-4"></a>linealidad <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = residuals ~ fitted, data = tibble(fitted = ajuste_AGST$fitted.values, 
    residuals = ajuste_AGST$residuals))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)  2.148e-15  1.574e+00       0        1
fitted      -3.084e-16  2.231e-01       0        1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  3.694e-32, Adjusted R-squared:  -0.04 
F-statistic: 9.234e-31 on 1 and 25 DF,  p-value: 1</code></pre>
</div>
</div>
<p>Si te fijas <span class="hl-green"><strong>ambos par√°metros no son significativamente distintos de 0</strong></span>: no presentan una tendencia (lineal al menos)</p>
</section>
<section id="diagnosis-linealidad-2" class="slide level2">
<h2>Diagnosis: linealidad</h2>
<p>M√°s adelante probaremos alguna otra cosa pero de momento nos basta con eso. Tambi√©n podemos <span class="hl-yellow"><strong>visualizar nosotros ese scatter plot residuales vs estimaciones</strong></span></p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"fitted"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>fitted.values,</span>
<span id="cb76-2"><a href="#cb76-2"></a>              <span class="st">"residuals"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>residuals),</span>
<span id="cb76-3"><a href="#cb76-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb76-5"><a href="#cb76-5"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-48-1.png" width="960" class="r-stretch"></section>
<section id="diagnosis-homocedasticidad" class="slide level2">
<h2>Diagnosis: homocedasticidad</h2>
<ol start="2" type="1">
<li><span class="hl-green"><strong>Homocedasticidad</strong></span>: necesitamos que la <span class="hl-yellow"><strong>varianza del error sea finita y constante</strong></span>, tal que <span class="math inline">\(\sigma_{r}^2 = \sigma_{\varepsilon}^2 = {\rm Var} \left[\varepsilon | \boldsymbol{X} = x \right] = cte &lt; \infty\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">check_heteroscedasticity</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Error variance appears to be homoscedastic (p = 0.137).</code></pre>
</div>
</div>
<div class="fragment">
<p>El gr√°fico titulado <code>Homogeneity of variance</code> nos visualiza la ra√≠z cuadrada del valor absoluto de los residuos estandarizados frente a las predicciones (se conoce como <span class="hl-yellow"><strong>gr√°fico de escala-localizaci√≥n</strong></span>)</p>
</div>
</section>
<section id="diagnosis-homocedasticidad-1" class="slide level2">
<h2>Diagnosis: homocedasticidad</h2>
<p>Si visualizamos los <span class="hl-yellow"><strong>residuales</strong></span> deber√≠an estar en torno a 0, dentro de una banda constante (varianza constante)</p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ajuste_AGST<span class="sc">$</span>residuals),</span>
<span id="cb79-2"><a href="#cb79-2"></a>              <span class="st">"residuals"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>residuals),</span>
<span id="cb79-3"><a href="#cb79-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> id, <span class="at">y =</span> residuals)) <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb79-6"><a href="#cb79-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-50-1.png" width="960" class="r-stretch"></section>
<section id="diagnosis-homocedasticidad-2" class="slide level2">
<h2>Diagnosis: homocedasticidad</h2>
<p>Si visualizamos el gr√°fico de <span class="hl-yellow"><strong>escala-localizaci√≥n</strong></span> deber√≠amos obtener un diagrama de dispersi√≥n cuya recta de regresi√≥n saliese casi plana en torno al 1.</p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"fitted"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>fitted.values,</span>
<span id="cb80-2"><a href="#cb80-2"></a>              <span class="st">"sqrt_std_residuals"</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>((ajuste_AGST<span class="sc">$</span>residuals <span class="sc">-</span> <span class="fu">mean</span>(ajuste_AGST<span class="sc">$</span>residuals)) <span class="sc">/</span> <span class="fu">sd</span>(ajuste_AGST<span class="sc">$</span>residuals)))),</span>
<span id="cb80-3"><a href="#cb80-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> sqrt_std_residuals)) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb80-5"><a href="#cb80-5"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-51-1.png" width="960" class="r-stretch"><p>Seg√∫n el gr√°fico no deber√≠amos asumir homocedasticidad. <strong>¬øPor qu√© el contraste no la rechaza?</strong></p>
</section>
<section id="diagnosis-homocedasticidad-3" class="slide level2">
<h2>Diagnosis: homocedasticidad</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"fitted"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>fitted.values,</span>
<span id="cb81-2"><a href="#cb81-2"></a>              <span class="st">"sqrt_std_residuals"</span> <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>((ajuste_AGST<span class="sc">$</span>residuals <span class="sc">-</span> <span class="fu">mean</span>(ajuste_AGST<span class="sc">$</span>residuals)) <span class="sc">/</span> <span class="fu">sd</span>(ajuste_AGST<span class="sc">$</span>residuals)))),</span>
<span id="cb81-3"><a href="#cb81-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> sqrt_std_residuals)) <span class="sc">+</span></span>
<span id="cb81-4"><a href="#cb81-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb81-5"><a href="#cb81-5"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-52-1.png" width="960" class="r-stretch"><p>Con el poco tama√±o muestral que tenemos, es complicado tener evidencias que refuten la hip√≥tesis nula (y el gr√°fico puede estar parcialmente dise√±ado). Por eso es la <span class="hl-yellow"><strong>hip√≥tesis m√°s dif√≠cil de cumplir</strong></span>. Lo importante es que en <span class="hl-green"><strong>la recta de regresi√≥n al dibujar los residuos no se aprecia una banda cuya anchura se modifique groseramente</strong></span>, m√°s o menos constante</p>
</section>
<section id="diagnosis-normalidad" class="slide level2">
<h2>Diagnosis: normalidad</h2>
<ol start="3" type="1">
<li><span class="hl-green"><strong>Normalidad</strong></span>: pediremos que <span class="math inline">\(\varepsilon \sim N \left(0, \sigma_{r}^2 \right)\)</span></li>
</ol>
<p>Con la funci√≥n <code>ols_test_normality()</code> del paquete <code>{olsrr}</code> podemos obtener diferentes contrastes de normalidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="fu">ols_test_normality</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.9685         0.5633 
Kolmogorov-Smirnov        0.0904         0.9657 
Cramer-von Mises          3.3055         0.0000 
Anderson-Darling          0.2422         0.7457 
-----------------------------------------------</code></pre>
</div>
</div>
<p>Nos centraremos en los contrastes de <code>Shapiro-Wilk</code>, <code>Kolmogorov-Smirnov</code> y <code>Anderson-Darling</code>: <span class="hl-yellow"><strong>no se rechaza normalidad</strong></span></p>
</section>
<section id="diagnosis-normalidad-1" class="slide level2">
<h2>Diagnosis: normalidad</h2>
<p>Adem√°s del contraste podemos visualizar con <code>stat_qq()</code> y <code>stat_qq_line()</code> el conocido como <span class="hl-yellow"><strong>Q-Q plot</strong></span>: enfrenta los cuantiles de una muestra con los cuantiles de una normal te√≥rica, teniendo que <strong>obtener los puntos en torno a una recta</strong> (especilamente en el centro).</p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"residuals"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>residuals)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>  <span class="fu">stat_qq</span>(<span class="fu">aes</span>(<span class="at">sample =</span> residuals)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3"></a>  <span class="fu">stat_qq_line</span>(<span class="fu">aes</span>(<span class="at">sample =</span> residuals))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-54-1.png" width="960" class="r-stretch"></section>
<section id="diagnosis-independencia" class="slide level2">
<h2>Diagnosis: independencia</h2>
<ol start="4" type="1">
<li><span class="hl-green"><strong>Independencia</strong></span>: los errores <span class="math inline">\(\left\lbrace \varepsilon_i \right\rbrace_{i=1}^{n}\)</span> deben ser independientes entre s√≠ (el error en una observaci√≥n no depende de otras). En particular, ser√°n <strong>incorrelados</strong></li>
</ol>
<p><span class="math display">\[{\rm Cor}_{\varepsilon_i \varepsilon_j} = E \left[\varepsilon_i \varepsilon_j \right] - E \left[\varepsilon_i \right] E \left[\varepsilon_j \right] = E \left[\varepsilon_i \varepsilon_j \right] = 0, \quad i \neq j\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">check_autocorrelation</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Residuals appear to be independent and not autocorrelated (p = 0.698).</code></pre>
</div>
</div>
<p>Por √∫ltimo, <code>check_autocorrelation()</code> comprueba como efectivamente los <span class="hl-yellow"><strong>residuales/errores son independientes</strong></span>, haciendo un test de autocorrelaci√≥n (nos tiene que salir lo contrario a una serie temporal, que el error i no depende del i-1).</p>
</section>
<section id="diagnosis-independencia-1" class="slide level2">
<h2>Diagnosis: independencia</h2>
<p>Otra forma de verlo es <span class="hl-yellow"><strong>visualizando los residuos respecto a su versi√≥n con retardo</strong></span> (por ejemplo, <span class="math inline">\(\left(\widehat{\varepsilon}_1, \widehat{\varepsilon}_2, \widehat{\varepsilon}_3, \ldots, \widehat{\varepsilon}_{n-1} \right)\)</span> vs <span class="math inline">\(\left(\widehat{\varepsilon}_2, \widehat{\varepsilon}_3, \ldots, \widehat{\varepsilon}_n \right)\)</span></p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"lag1"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>residuals[<span class="sc">-</span><span class="fu">length</span>(ajuste_AGST<span class="sc">$</span>residuals)],</span>
<span id="cb87-2"><a href="#cb87-2"></a>              <span class="st">"residuals"</span> <span class="ot">=</span> ajuste_AGST<span class="sc">$</span>residuals[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb87-3"><a href="#cb87-3"></a>       <span class="fu">aes</span>(<span class="at">x =</span> residuals, <span class="at">y =</span> lag1)) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb87-5"><a href="#cb87-5"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb87-6"><a href="#cb87-6"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-56-1.png" width="960" class="r-stretch"></section>
<section id="fase-de-diagnosis-2" class="slide level2">
<h2>Fase de diagnosis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="fu">check_model</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-57-1.png" width="960" class="r-stretch"><p>En nuestro caso se cumplen todas las hip√≥tesis (algunas m√°s fuertemente que otras).</p>
<p><span class="hl-yellow"><strong>Repite el proceso con el otro modelo</strong></span></p>
</section>
<section id="fase-de-diagnosis-3" class="slide level2">
<h2>Fase de diagnosis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">check_predictions</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-58-1.png" width="960" class="r-stretch"><p>Nos faltan dos gr√°ficas por comentar:</p>
<ul>
<li><code>Posterior Predictive Checks</code>: <span class="hl-yellow"><strong>simula distintas variables respuesta</strong></span> suponiendo que el modelo fuese cierto (a√±adiendo ruido aleatorio) y lo compara con la muestra. <span class="hl-red"><strong>Si lo observado se distancia mucho de las simulaciones</strong></span> es que el modelo planteado no ajusta bien a la muestra.</li>
</ul>
</section>
<section id="fase-de-diagnosis-4" class="slide level2">
<h2>Fase de diagnosis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="fu">check_outliers</span>(ajuste_AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: No outliers detected.
- Based on the following method and threshold: cook (0.713).
- For variable: (Whole model)</code></pre>
</div>
</div>
<ul>
<li><code>Influential Observations</code>: nos permite identificar <span class="hl-yellow"><strong>observaciones influyentes</strong></span>, marcando aquellas (con su id de fila) que se salgan fuera de la banda definida por la conocida como <strong>distancia de Cook</strong> denotada como <span class="math inline">\(D_i\)</span> (realiza, para cada observaci√≥n, la suma de todos los cambios de la regresi√≥n cuando la observaci√≥n <span class="math inline">\(i\)</span> es retirada: si hay muchos cambios al cambiar una observaci√≥n, es que era muy influyente)</li>
</ul>
<div class="fragment">
<p>Diferencia dos tipos:</p>
<ul>
<li><span class="hl-yellow"><strong>outliers</strong></span>: valor at√≠pico de la <strong>respuesta</strong> pudiendo perturbar la varianza residual</li>
<li><span class="hl-yellow"><strong>high-leverage points</strong></span>: valor at√≠pico en alguna de las <strong>predictoras</strong></li>
</ul>
</div>
</section>
<section id="fase-de-inferencia" class="slide level2">
<h2>Fase de inferencia</h2>
<ol start="6" type="1">
<li><span class="hl-yellow"><strong>Fase de inferencia</strong></span>:</li>
</ol>
<ul>
<li>¬øQu√© <span class="hl-purple"><strong>variabilidad</strong></span> tienen las estimaciones de nuestro par√°metros?</li>
<li>¬øLas predictoras/intercepto tienen un <span class="hl-purple"><strong>efecto lineal significativo</strong></span>?</li>
<li>¬øDebemos <span class="hl-purple"><strong>re-entrenar el modelo</strong></span> sin alguno de ellos?</li>
</ul>
<p>&nbsp;</p>
<p>Una vez verificadas las hip√≥tesis lo que haremos ser√° <span class="hl-yellow"><strong>inferir conclusiones de la poblaci√≥n en funci√≥n de la muestra</strong></span></p>
</section>
<section id="fase-de-inferencia-1" class="slide level2">
<h2>Fase de inferencia</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>ajuste_AGST <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ AGST, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.5469     2.3641  -1.500 0.146052    
AGST          0.6426     0.1434   4.483 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  0.4456,    Adjusted R-squared:  0.4234 
F-statistic: 20.09 on 1 and 25 DF,  p-value: 0.0001425</code></pre>
</div>
</div>
<ul>
<li><p><span class="hl-yellow"><strong>Variabilidad</strong></span> de las estimaciones de nuestro par√°metros</p>
<ul>
<li><span class="math inline">\(\widehat{SE} \left( \widehat{\beta}_0 \right)\)</span> igual a 2.344 por lo que (aprox) <span class="math inline">\(\widehat{\beta_0} \sim N(-3.547, 2.344)\)</span></li>
<li><span class="math inline">\(\widehat{SE} \left( \widehat{\beta}_1 \right)\)</span> igual a 0.143 por lo que (aprox) que <span class="math inline">\(\widehat{\beta_1} \sim N(0.643, 0.143)\)</span></li>
</ul></li>
</ul>
</section>
<section id="fase-de-inferencia-2" class="slide level2">
<h2>Fase de inferencia</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a>ajuste_AGST <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ AGST, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.5469     2.3641  -1.500 0.146052    
AGST          0.6426     0.1434   4.483 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  0.4456,    Adjusted R-squared:  0.4234 
F-statistic: 20.09 on 1 and 25 DF,  p-value: 0.0001425</code></pre>
</div>
</div>
<ul>
<li><p><span class="hl-yellow"><strong>Estad√≠stico</strong></span> del contraste</p>
<ul>
<li><span class="math inline">\(\frac{\widehat{\beta}_0 - 0}{\widehat{SE} \left( \widehat{\beta}_0 \right)}\)</span> igual a -1.5 (valor que tendr√≠as que buscar en las tablas a mano)</li>
<li><span class="math inline">\(\frac{\widehat{\beta}_1 - 0}{\widehat{SE} \left( \widehat{\beta}_1 \right)}\)</span> igual a 4.483 (valor que tendr√≠as que buscar en las tablas a mano)</li>
</ul></li>
</ul>
</section>
<section id="fase-de-inferencia-3" class="slide level2">
<h2>Fase de inferencia</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>ajuste_AGST <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ AGST, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.5469     2.3641  -1.500 0.146052    
AGST          0.6426     0.1434   4.483 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  0.4456,    Adjusted R-squared:  0.4234 
F-statistic: 20.09 on 1 and 25 DF,  p-value: 0.0001425</code></pre>
</div>
</div>
<ul>
<li><span class="hl-yellow"><strong>Efecto (lineal)</strong></span>: si nos fijamos en la tabla, el p-valor de <span class="math inline">\(\beta_0\)</span> es 0.146052. Si adoptamos <span class="math inline">\(\alpha = 0.05\)</span> como suele ser habitual, el contraste <span class="math inline">\(H_0:~\beta_0 = 0\)</span> vs <span class="math inline">\(H_1:~\beta_0 \neq 0\)</span> nos dice que <span class="hl-red"><strong>no podemos rechazar de forma significativa la hip√≥tesis nula</strong></span> (no sucede con <span class="math inline">\(\beta_1\)</span>, si sucediese no habr√≠a modelo)</li>
</ul>
</section>
<section id="fase-de-inferencia-4" class="slide level2">
<h2>Fase de inferencia</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>ajuste_AGST <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ AGST, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.78370 -0.23827 -0.03421  0.29973  0.90198 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.5469     2.3641  -1.500 0.146052    
AGST          0.6426     0.1434   4.483 0.000143 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4819 on 25 degrees of freedom
Multiple R-squared:  0.4456,    Adjusted R-squared:  0.4234 
F-statistic: 20.09 on 1 and 25 DF,  p-value: 0.0001425</code></pre>
</div>
</div>
<p><span class="hl-yellow"><strong>¬øY si quitamos dicho par√°metro?</strong></span></p>
<div class="fragment">
<p>Para quitarlo a√±adimos un -1 al modelo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>ajuste_AGST_sin_beta0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> Price <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> AGST)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="re-aprendiendo" class="slide level2">
<h2>Re-aprendiendo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a>ajuste_AGST_sin_beta0 <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ -1 + AGST, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.7324 -0.3756 -0.0092  0.3838  1.0804 

Coefficients:
     Estimate Std. Error t value Pr(&gt;|t|)    
AGST 0.427691   0.005757   74.29   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4933 on 26 degrees of freedom
Multiple R-squared:  0.9953,    Adjusted R-squared:  0.9951 
F-statistic:  5519 on 1 and 26 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><p>La <span class="hl-yellow"><strong>bondad de ajuste</strong></span> ha pasado de <span class="math inline">\(R^2 = 0.446\)</span> a <span class="math inline">\(R^2 = 0.9953\)</span></p></li>
<li><p>La <span class="hl-yellow"><strong>variabilidad de la estimaci√≥n</strong></span> <span class="math inline">\(\widehat{SE} \left( \widehat{\beta}_1 \right)\)</span> ha pasado de 0.143 a 0.005757.</p></li>
</ul>
</section>
<section id="comparar-modelos" class="slide level2">
<h2>Comparar modelos</h2>
<p>Aunque no hemos hablado en profundidad de las <strong>m√©tricas de evaluaci√≥n</strong> podemos <span class="hl-yellow"><strong>comparar los modelos</strong></span> con <code>compare_performance()</code> del paquete <code>{performance}</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="fu">compare_performance</span>(ajuste_AGST, ajuste_AGST_sin_beta0,</span>
<span id="cb103-2"><a href="#cb103-2"></a>                    ajuste_harvest, ajuste_harvest_sin_beta0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name                     | Model | AIC (weights) | AICc (weights) | BIC (weights) |    R2 | R2 (adj.) |  RMSE | Sigma
---------------------------------------------------------------------------------------------------------------------
ajuste_AGST              |    lm |  41.1 (0.535) |   42.2 (0.469) |  45.0 (0.379) | 0.446 |     0.423 | 0.464 | 0.482
ajuste_AGST_sin_beta0    |    lm |  41.4 (0.454) |   41.9 (0.522) |  44.0 (0.614) | 0.995 |     0.995 | 0.484 | 0.493
ajuste_harvest           |    lm |  49.0 (0.010) |   50.1 (0.009) |  52.9 (0.007) | 0.257 |     0.228 | 0.537 | 0.558
ajuste_harvest_sin_beta0 |    lm | 147.5 (&lt;.001) |  148.0 (&lt;.001) | 150.1 (&lt;.001) | 0.762 |     0.753 | 3.450 | 3.515</code></pre>
</div>
</div>
</section></section>
<section>
<section id="clase-9" class="title-slide slide level1 center">
<h1>Clases 9: evaluaci√≥n y predicci√≥n</h1>
<p><span style="color:#444442;"><strong>¬øC√≥mo se puede evaluar un modelo? ¬øQu√© m√©tricas existen? ¬øC√≥mo predecir?</strong></span></p>
</section>
<section id="repitamos-el-proceso" class="slide level2">
<h2>Repitamos el proceso</h2>
<p>Para interiorizar lo aprendido, vamos a repetir todo el proceso con el conjunto <code>datos_linearreg.csv</code> (las variables predictoras representan diferentes variables meteorol√≥gicas y la variable objetivo <code>y</code> la temperatura media en primavera, para distintas ciudades).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/datos_linearreg.csv"</span>)</span>
<span id="cb105-2"><a href="#cb105-2"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,000 √ó 4
      x1     y     x2       x3
   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  5.64  17.3 -2.43   2.19   
 2  4.00  14.5  0.881  6.06   
 3  5.02  15.7  0.457  6.91   
 4  5.86  18.4 -4.03   1.27   
 5  4.65  13.3 -2.37   3.68   
 6  4.97  14.7 -5.48  -0.00953
 7  4.05  13.0 -1.24   3.79   
 8  5.38  17.8 -3.36   2.21   
 9  5.16  17.2 -3.52   1.42   
10  4.43  13.3  1.42   6.84   
# ‚Ñπ 990 more rows</code></pre>
</div>
</div>
</section>
<section id="regresi√≥n-lineal" class="slide level2">
<h2>Regresi√≥n lineal</h2>
<p>Debes seguir los siguientes pasos de la manera m√°s detallada posible</p>
<ol type="1">
<li><p><span class="hl-yellow"><strong>An√°lisis exploratorio inicial</strong></span> tanto num√©rico como visualizando. ¬øSon num√©ricas sin problemas de codificaci√≥n? ¬øC√≥mo se distribuyen? ¬øHay datos at√≠picos?</p></li>
<li><p><span class="hl-yellow"><strong>An√°lisis de dependencia</strong></span>. ¬øQu√© predictora correlaciona m√°s con la objetivo? ¬øC√≥mo se relacionan las predictoras entre s√≠?</p></li>
<li><p><span class="hl-yellow"><strong>Formulaci√≥n</strong></span> del modelo</p></li>
<li><p><span class="hl-yellow"><strong>Fase de estimaci√≥n</strong></span>. ¬øCu√°les son los par√°metros? ¬øC√≥mo se interpretan?</p></li>
<li><p><span class="hl-yellow"><strong>Fase de diagnosis</strong></span></p></li>
<li><p><span class="hl-yellow"><strong>Fase de inferencia</strong></span>. ¬øQu√© variabilidad tiene la estimaci√≥n? ¬øHay efecto significativo?</p></li>
</ol>
</section>
<section id="fase-de-evaluaci√≥n" class="slide level2">
<h2>Fase de evaluaci√≥n</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>ajuste_lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y <span class="sc">~</span> x1)</span>
<span id="cb107-2"><a href="#cb107-2"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1, data = datos)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.2967 -1.0477  0.0599  1.0080  4.8827 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.77574    0.23885  -3.248   0.0012 ** 
x1           3.10868    0.04687  66.324   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.498 on 998 degrees of freedom
Multiple R-squared:  0.8151,    Adjusted R-squared:  0.8149 
F-statistic:  4399 on 1 and 998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Ten√≠amos pendiente la fase final: <span class="hl-yellow"><strong>fase de evaluaci√≥n</strong></span></p>
</section>
<section id="fase-de-evaluaci√≥n-1" class="slide level2">
<h2>Fase de evaluaci√≥n</h2>
<ol start="7" type="1">
<li><span class="hl-yellow"><strong>Fase de evaluaci√≥n</strong></span>:</li>
</ol>
<ul>
<li>¬øEs significativo el modelo? <span class="hl-purple"><strong>ANOVA: an√°lisis de la varianza</strong></span></li>
<li>¬øQu√© informaci√≥n de la predictora explica el modelo? <span class="hl-purple"><strong>Par√°metros de bondad de ajuste</strong></span> (<span class="math inline">\(R^2\)</span> por ejemplo)</li>
<li>¬øQu√© otras m√©tricas o herramientas podemos usar para <span class="hl-purple"><strong>cuantificar la calidad predictora de nuestro ajuste</strong></span></li>
</ul>
<div class="fragment">
<p>Una de las herramientas m√°s √∫tiles para evaluar nuestro modelo es <span class="hl-yellow"><strong>enfrentar los valores ajustados con los valores reales</strong></span> (dado que los conocemos al ser aprendizaje supervisado)</p>
</div>
</section>
<section id="fase-de-evaluaci√≥n-2" class="slide level2">
<h2>Fase de evaluaci√≥n</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="st">"y"</span> <span class="ot">=</span> datos<span class="sc">$</span>y, <span class="st">"y_est"</span> <span class="ot">=</span> ajuste_lineal<span class="sc">$</span>fitted.values),</span>
<span id="cb109-2"><a href="#cb109-2"></a>       <span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> y_est)) <span class="sc">+</span></span>
<span id="cb109-3"><a href="#cb109-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb109-5"><a href="#cb109-5"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Valores reales"</span>, <span class="at">y =</span> <span class="st">"Valores estimados"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-70-1.png" width="960" class="r-stretch"><p>En el gr√°fica podemos ver como los <span class="hl-green"><strong>valores reales vs estimados</strong></span> est√°n muy cercanos a la diagonal: el error cometido es muy peque√±o.</p>
</section>
<section id="fase-de-evaluaci√≥n-3" class="slide level2">
<h2>Fase de evaluaci√≥n</h2>
<p>Podemos considerar algunas <span class="hl-yellow"><strong>m√©tricas para cuantificar el acierto del modelo</strong></span></p>
<div class="fragment">
<ul>
<li><span class="hl-red"><strong>SSE</strong></span> (sum of squared errors): definido como la suma de errores al cuadrado</li>
</ul>
<p><span class="math display">\[SSE = \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^2 = \sum_{i=1}^{n} \left( Y_i - \widehat{Y}_i \right)^2\]</span> F√≠jate que dado que <span class="math inline">\(\widehat{\sigma}_{\varepsilon} = \widehat{\sigma}_{r} = \frac{n}{n-p-1} s_{r}^{2} = \frac{1}{n-p-1} \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^2\)</span> (el que <code>R</code> llama <code>Residual standard error</code>), tenemos que <span class="math inline">\(SSE = (n-p-1)\widehat{\sigma}_{\varepsilon}\)</span></p>
</div>
<div class="fragment">
<ul>
<li><span class="hl-red"><strong>MSE</strong></span>: media de lo anterior <span class="math inline">\(MSE = s_{r}^{2} = \frac{1}{n} SSE = \frac{1}{n} \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^2 = \frac{n-p-1}{n}\widehat{\sigma}_{\varepsilon}\)</span></li>
</ul>
</div>
<div class="fragment">
<p>Ambas m√©tricas nos hablan de la <span class="hl-red"><strong>varianza del error</strong></span>, es decir, de lo que el <span class="hl-red"><strong>modelo no es capaz de explicar</strong></span></p>
</div>
</section>
<section id="fase-de-evaluaci√≥n-4" class="slide level2">
<h2>Fase de evaluaci√≥n</h2>
<ul>
<li><span class="hl-green"><strong>SSR</strong></span> (regressions sum of squares): definido como la suma de las desviaciones de cada predicci√≥n a su media (al tener estimadores insesgados, la media de las estimaciones <span class="math inline">\(\overline{\widehat{Y}}\)</span> es la misma que la de la variable a estimar <span class="math inline">\(\overline{Y}\)</span>)</li>
</ul>
<p><span class="math display">\[SSR = \sum_{i=1}^{n} \left( \overline{Y} - \widehat{Y}_i \right)^2 = \sum_{i=1}^{n} \left( \overline{\widehat{Y}}_i - \widehat{Y}_i \right)^2\]</span></p>
<div class="fragment">
<ul>
<li><span class="hl-green"><strong>MSR</strong></span>: media de lo anterior <span class="math inline">\(MSR = s_{\widehat{y}}^2 = \frac{1}{n} SSR = \frac{1}{n} \sum_{i=1}^{n} \left( \overline{Y} - \widehat{Y}_i \right)^2\)</span></li>
</ul>
</div>
<div class="fragment">
<p>Ambas m√©tricas nos hablan de la <span class="hl-green"><strong>variaci√≥n de Y en torno a la regresi√≥n</strong></span>, es decir, la variaci√≥n de <span class="math inline">\(\overline{Y}\)</span> que es explicada por la media condicional estimada <span class="math inline">\((Y_i|X=x_i) \sim \widehat{\beta}_0 + \widehat{\beta}_1 X_i\)</span>, cuantifica la <span class="hl-green"><strong>informaci√≥n de Y explicada por el modelo</strong></span></p>
</div>
</section>
<section id="fase-de-evaluaci√≥n-5" class="slide level2">
<h2>Fase de evaluaci√≥n</h2>
<ul>
<li><span class="hl-yellow"><strong>SST</strong></span> (total sum of squares): definido como la suma de las desviaciones de la variable objetivo <span class="math inline">\(Y\)</span> a su media.</li>
</ul>
<p><span class="math display">\[SST =  \sum_{i=1}^{n} \left( Y_i - \overline{Y} \right)^2 \]</span></p>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Varianza muestral de Y</strong></span>: la media de lo anterior (la varianza de <span class="math inline">\(Y\)</span>)</li>
</ul>
<p><span class="math display">\[s_{y}^2= \frac{1}{n} SST  = \frac{1}{n}\sum_{i=1}^{n} \left( Y_i - \overline{Y} \right)^2\]</span></p>
</div>
<div class="fragment">
<p>Ambas m√©tricas nos hablan de la <span class="hl-yellow"><strong>variaci√≥n total de Y</strong></span>, es decir, la <span class="hl-yellow"><strong>informaci√≥n total de nuestra variable objetivo</strong></span></p>
</div>
</section>
<section id="anova" class="slide level2">
<h2>ANOVA</h2>
<p>As√≠ tenemos 3 tipos de m√©tricas:</p>
<ul>
<li><p><code>SST</code> y <span class="math inline">\(s_{y}^2\)</span>: el <span class="hl-yellow"><strong>total de info a explicar</strong></span></p></li>
<li><p><code>SSR</code> y <span class="math inline">\(MSR\)</span>: el <span class="hl-green"><strong>total de info explicada por el modelo</strong></span></p></li>
<li><p><code>SSE</code> y <span class="math inline">\(MSE\)</span>: el <span class="hl-red"><strong>total de info NO explicada por el modelo</strong></span> (a veces se usa la ra√≠z cuadrada del MSE, conocido como <span class="math inline">\(RMSE\)</span>, o el <span class="math inline">\(MAE\)</span>, tomando valor absoluto en los errores).</p></li>
</ul>
<div class="fragment">
<p>Se pueden demostrar que, <span class="hl-purple"><strong>SOLO EN EL CASO LINEAL</strong></span>, desarrollando el sumatorio <span class="math inline">\(SST = \sum_{i=1}^{n} \left( Y_i - \overline{Y} \right)^2 = \sum_{i=1}^{n} \left( \left(Y_i - \widehat{Y}_i \right) + \left( \widehat{Y}_i - \overline{Y} \right) \right)^2\)</span> se llega a que</p>
<p><span class="hl-yellow"><strong>SST</strong></span> = <span class="hl-green"><strong>SSR</strong></span> + <span class="hl-red"><strong>SSE</strong></span></p>
</div>
</section>
<section id="anova-1" class="slide level2">
<h2>ANOVA</h2>
<p><span class="hl-yellow"><strong>SST</strong></span> = <span class="hl-green"><strong>SSR</strong></span> + <span class="hl-red"><strong>SSE</strong></span></p>
<div class="fragment">
<p><span class="hl-yellow"><span class="math inline">\(s_{y^2}\)</span></span> = <span class="hl-green"><span class="math inline">\(s_{\widehat{y}}^2\)</span></span> + <span class="hl-red"><span class="math inline">\(s_{r}^2\)</span></span> (equivalente, <span class="hl-yellow"><span class="math inline">\(s_{y^2}\)</span></span> = <span class="hl-green"><span class="math inline">\(s_{\widehat{y}}^2\)</span></span> + <span class="hl-red"><span class="math inline">\(\frac{n-p-1}{n}\widehat{\sigma}_{\varepsilon}\)</span></span>)</p>
</div>
<div class="fragment">
<p>Esta decomposici√≥n (solo se cumple en el caso lineal) se conoce como <span class="hl-yellow"><strong>ANOVA o an√°lisis de la varianza</strong></span> y podemos hacerlo en <code>R</code> con <code>aov()</code> o <code>anova()</code></p>
<div class="columns">
<div class="column" style="width:45%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">aov</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
   aov(formula = ajuste_lineal)

Terms:
                      x1 Residuals
Sum of Squares  9870.948  2239.494
Deg. of Freedom        1       998

Residual standard error: 1.497993
Estimated effects may be unbalanced</code></pre>
</div>
</div>
</div><div class="column" style="width:55%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
x1          1 9870.9  9870.9  4398.9 &lt; 2.2e-16 ***
Residuals 998 2239.5     2.2                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="anova-2" class="slide level2">
<h2>ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">aov</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
   aov(formula = ajuste_lineal)

Terms:
                      x1 Residuals
Sum of Squares  9870.948  2239.494
Deg. of Freedom        1       998

Residual standard error: 1.497993
Estimated effects may be unbalanced</code></pre>
</div>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Terms</th>
<th style="text-align: center;">x1 (predictora)</th>
<th style="text-align: center;">Residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Sum of Squares</td>
<td style="text-align: center;">SSR</td>
<td style="text-align: center;">SSE</td>
</tr>
<tr class="even">
<td style="text-align: center;">Deg. of Freedom (grados libertad)</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">n - p - 1</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><code>Residual standard error</code>: <span class="math inline">\(\widehat{\sigma}_{\varepsilon}^{2}= \frac{n}{n-p-1} s_{r}^{2} = \frac{1}{n-p-1} \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^{2}\)</span></p>
</section>
<section id="anova-3" class="slide level2">
<h2>ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
x1          1 9870.9  9870.9  4398.9 &lt; 2.2e-16 ***
Residuals 998 2239.5     2.2                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<table>
<colgroup>
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Df (grados)</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">x1</td>
<td style="text-align: center;">p</td>
<td style="text-align: center;">SSR</td>
<td style="text-align: center;"><span class="math inline">\(\frac{SSR}{p}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F-value = \frac{\frac{SSR}{p}}{\frac{SSE}{n-p-1}}\)</span></td>
<td style="text-align: center;">p-valor F test</td>
</tr>
<tr class="even">
<td style="text-align: center;">Residuals</td>
<td style="text-align: center;">n - p - 1</td>
<td style="text-align: center;">SSE</td>
<td style="text-align: center;"><span class="math inline">\(\widehat{\sigma}_{\varepsilon}^{2} = \frac{SSE}{n-p-1}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>El F-value es el estad√≠tico <span class="math inline">\(F = \frac{\frac{SSR}{p}}{\frac{SSE}{n-p-1}} \sim F_{p, n-p-1}\)</span> asociado al <span class="hl-yellow"><strong>contraste de significaci√≥n global</strong></span></p>
<p><span class="math display">\[H_0:~\beta_1 = \ldots = \beta_p = 0 \quad vs \quad H_1:~\text{existe al menos un} \quad \beta_j \neq 0\]</span></p>
</section>
<section id="anova-4" class="slide level2">
<h2>ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: y
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
x1          1 9870.9  9870.9  4398.9 &lt; 2.2e-16 ***
Residuals 998 2239.5     2.2                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><span class="math display">\[H_0:~\beta_1 = \ldots = \beta_p = 0 \quad vs \quad H_1:~\text{existe al menos un} \quad \beta_j \neq 0\]</span></p>
<p>El contraste pretende responder a: <span class="hl-yellow"><strong>¬øexiste una dependencia lineal entre <span class="math inline">\(Y\)</span> y el CONJUNTO de predictoras?</strong></span> (global, no par√°metro a par√°metro).</p>
<div class="fragment">
<p>Si se <span class="hl-yellow"><strong>rechaza</strong></span> significa que <span class="hl-yellow"><strong>existe al menos un predictor cuyo efecto LINEAL sobre Y es significativo</strong></span>.</p>
</div>
<div class="fragment">
<p><span class="hl-red"><strong>Importante</strong></span>: en el caso de la reg. lineal univariante, <span class="math inline">\(F-value\)</span> y <span class="math inline">\(p-value\)</span> del ANOVA es equivalente al <span class="math inline">\(t-value\)</span> y <span class="math inline">\(p-value\)</span> del contraste de significaci√≥n para <span class="math inline">\(\beta_1\)</span> (ya que‚Ä¶no hay m√°s).</p>
</div>
</section>
<section id="bondad-de-ajuste" class="slide level2">
<h2>Bondad de ajuste</h2>
<p>El conocido como <span class="math inline">\(R^2\)</span> o <span class="hl-yellow"><strong>bondad de ajuste</strong></span> o el <span class="hl-yellow"><strong>coeficiente de determinaci√≥n</strong></span> es una forma sencilla, y relacionada con el ANOVA, para cuantificar la <span class="hl-yellow"><strong>cantidad de informaci√≥n explicada por el modelo</strong></span></p>
<div class="fragment">
<p>De hecho es, literal, un <span class="hl-yellow"><strong>ratio de informaci√≥n explicada</strong></span> (lo que <code>R</code> llama <code>Multiple R-squared</code>, ya hablaremos de su versi√≥n ajustada en regresi√≥n multivariante)</p>
<p><span class="math display">\[R^2 = \text{Ratio info explicada} = \frac{SSR}{SST}\]</span></p>
</div>
<div class="fragment">
<p>En el caso lineal, por lo visto en el ANOVA</p>
<p><span class="math display">\[R^2= \frac{SSR}{SST} = \frac{SST - SSE}{SST} = 1 - \frac{SSE}{SST} = 1 - \frac{s_{r}^{2}}{s_{y}^{2}} =  1 - \frac{\frac{n-p-1}{n}\widehat{\sigma}_{\varepsilon}^{2}}{s_{y}^{2}}\]</span></p>
</div>
<div class="fragment">
<p>Por definici√≥n, la <span class="hl-yellow"><strong>bondad de ajuste est√° entre 0 y 1</strong></span>.</p>
</div>
</section>
<section id="bondad-de-ajuste-1" class="slide level2">
<h2>Bondad de ajuste</h2>
<p><span class="hl-yellow"><strong>Deberes: demuestra que <span class="math inline">\(R^2 = r_{y \widehat{y}}^2\)</span> y que en el caso de <span class="math inline">\(p=1\)</span> coincide adem√°s con <span class="math inline">\(R^2 = r_{x,y}^2\)</span></strong></span></p>
<p><span class="math display">\[R^2 = r_{y \widehat{y}}^2 =_{p=1} r_{x,y}^2\]</span></p>
<div class="fragment">
<p>La bondad de ajuste tiene un <span class="hl-red"><strong>problema importante</strong></span>: no solo depende del modelo sino que tambi√©n de los datos. ¬øDe qu√© depende? ¬øPor qu√© es <span class="hl-red"><strong>peligroso usar ciegamente <span class="math inline">\(R^2\)</span> para decidir</strong></span>?</p>
</div>
</section>
<section id="bondad-de-ajuste-2" class="slide level2">
<h2>Bondad de ajuste</h2>
<p><span class="math display">\[R^2= \frac{SSR}{SST} = \frac{SST - SSE}{SST} = 1 - \frac{SSE}{SST} = 1 - \frac{s_{r}^{2}}{s_{y}^{2}} =  1 - \frac{\frac{n-p-1}{n}\widehat{\sigma}_{\varepsilon}^{2}}{s_{y}^{2}}\]</span></p>
<p>¬øDe qu√© depende?</p>
<div class="fragment">
<ul>
<li><p><span class="hl-yellow"><strong>M√°s predictoras</strong></span> implica que <span class="hl-yellow"><strong><span class="math inline">\(R^2\)</span> crece</strong></span>, ¬°incluso aunque dichas <span class="hl-red"><strong>predictoras no sean significativas</strong></span>! (esto lo arreglaremos con el <span class="math inline">\(R^2\)</span> ajustado en el futuro)</p></li>
<li><p><span class="hl-yellow"><strong>M√°s ruido, menor <span class="math inline">\(R^2\)</span></strong></span></p></li>
<li><p><span class="hl-yellow"><strong>Ignora si el modelo cumple las hip√≥tesis</strong></span>: un modelo con un alto <span class="math inline">\(R^2\)</span> puede dar predicciones nefastas.</p></li>
</ul>
</div>
</section>
<section id="predictoras-vs-r2" class="slide level2">
<h2>Predictoras vs R2</h2>
<p>Vamos a repetir pero <span class="hl-yellow"><strong>a√±adiendo 5 y 22 variables m√°s</strong></span>, sin efecto lineal con <span class="math inline">\(Y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>datos_extras <span class="ot">&lt;-</span></span>
<span id="cb120-2"><a href="#cb120-2"></a>  <span class="fu">tibble</span>(<span class="st">"y"</span> <span class="ot">=</span> datos<span class="sc">$</span>y, <span class="st">"x1"</span> <span class="ot">=</span> datos<span class="sc">$</span>x1, <span class="st">"x2"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x3"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>),</span>
<span id="cb120-3"><a href="#cb120-3"></a>         <span class="st">"x4"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x5"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x6"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x7"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>),</span>
<span id="cb120-4"><a href="#cb120-4"></a>         <span class="st">"x8"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x9"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x10"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x11"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>),</span>
<span id="cb120-5"><a href="#cb120-5"></a>         <span class="st">"x12"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x13"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x14"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x15"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>),</span>
<span id="cb120-6"><a href="#cb120-6"></a>         <span class="st">"x16"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x17"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x18"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x19"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>),</span>
<span id="cb120-7"><a href="#cb120-7"></a>         <span class="st">"x20"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x21"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x22"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>), <span class="st">"x23"</span> <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fl">1e3</span>))</span>
<span id="cb120-8"><a href="#cb120-8"></a>ajuste_6pred <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos_extras, <span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4 <span class="sc">+</span> x5 <span class="sc">+</span> x6)</span>
<span id="cb120-9"><a href="#cb120-9"></a>ajuste_23pred <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos_extras, <span class="at">formula =</span> y <span class="sc">~</span> .)</span>
<span id="cb120-10"><a href="#cb120-10"></a><span class="fu">compare_performance</span>(ajuste_lineal, ajuste_6pred, ajuste_23pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name          | Model |  AIC (weights) | AICc (weights) |  BIC (weights) |    R2 | R2 (adj.) |  RMSE | Sigma
------------------------------------------------------------------------------------------------------------
ajuste_lineal |    lm | 3650.1 (0.778) | 3650.2 (0.788) | 3664.9 (&gt;.999) | 0.815 |     0.815 | 1.496 | 1.498
ajuste_6pred  |    lm | 3652.6 (0.222) | 3652.8 (0.212) | 3691.9 (&lt;.001) | 0.816 |     0.815 | 1.491 | 1.496
ajuste_23pred |    lm | 3668.7 (&lt;.001) | 3670.0 (&lt;.001) | 3791.4 (&lt;.001) | 0.820 |     0.815 | 1.478 | 1.496</code></pre>
</div>
</div>
<p>Con <code>compare_performance()</code> podemos comparar m√©tricas de modelos.</p>
</section>
<section id="ruido-vs-r2" class="slide level2">
<h2>Ruido vs R2</h2>
<p>Hemos dicho que el ruido afecta‚Ä¶¬øqu√© crees que <strong>pasar√° si fijamos la parte determin√≠stica y solo modificamos el ruido</strong>? Vamos a <span class="hl-yellow"><strong>simular 6 modelos</strong></span>, con exactamente los mismos <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> (es decir, <strong>mismo ajuste</strong>) pero con diferente varianza en el ruido (supongamos que <span class="math inline">\(X \sim N(3, 1.5)\)</span>).</p>
<p><span class="math display">\[\text{Modelo 1: } Y = -1.2 + 3.2X + N(0, 0.25)\]</span> <span class="math display">\[\text{Modelo 2: } Y = -1.2 + 3.2X + N(0, 1)\]</span></p>
<p><span class="math display">\[\text{Modelo 3: } Y = -1.2 + 3.2X + N(0, 1.5)\]</span></p>
<p><span class="math display">\[\text{Modelo 4: } Y = -1.2 + 3.2X + N(0, 2)\]</span></p>
<p><span class="math display">\[\text{Modelo 5: } Y = -1.2 + 3.2X + N(0, 4)\]</span></p>
<p><span class="math display">\[\text{Modelo 6: } Y = -1.2 + 3.2X + N(0, 8)\]</span></p>
</section>
<section id="ruido-vs-r2-1" class="slide level2">
<h2>Ruido vs R2</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">3</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb122-2"><a href="#cb122-2"></a>eps1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb122-3"><a href="#cb122-3"></a>eps2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb122-4"><a href="#cb122-4"></a>eps3 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fl">1.5</span>)</span>
<span id="cb122-5"><a href="#cb122-5"></a>eps4 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb122-6"><a href="#cb122-6"></a>eps5 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb122-7"><a href="#cb122-7"></a>eps6 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">8</span>)</span>
<span id="cb122-8"><a href="#cb122-8"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"y1"</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">3.2</span><span class="sc">*</span>x <span class="sc">+</span> eps1,</span>
<span id="cb122-9"><a href="#cb122-9"></a>                <span class="st">"y2"</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">3.2</span><span class="sc">*</span>x <span class="sc">+</span> eps2, <span class="st">"y3"</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">3.2</span><span class="sc">*</span>x <span class="sc">+</span> eps3,</span>
<span id="cb122-10"><a href="#cb122-10"></a>                <span class="st">"y4"</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">3.2</span><span class="sc">*</span>x <span class="sc">+</span> eps4, <span class="st">"y5"</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">3.2</span><span class="sc">*</span>x <span class="sc">+</span> eps5,</span>
<span id="cb122-11"><a href="#cb122-11"></a>                <span class="st">"y6"</span> <span class="ot">=</span> <span class="sc">-</span><span class="fl">1.2</span> <span class="sc">+</span> <span class="fl">3.2</span><span class="sc">*</span>x <span class="sc">+</span> eps6)</span>
<span id="cb122-12"><a href="#cb122-12"></a>ajuste_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y1 <span class="sc">~</span> x)</span>
<span id="cb122-13"><a href="#cb122-13"></a>ajuste_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y2 <span class="sc">~</span> x)</span>
<span id="cb122-14"><a href="#cb122-14"></a>ajuste_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y3 <span class="sc">~</span> x)</span>
<span id="cb122-15"><a href="#cb122-15"></a>ajuste_4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y4 <span class="sc">~</span> x)</span>
<span id="cb122-16"><a href="#cb122-16"></a>ajuste_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y5 <span class="sc">~</span> x)</span>
<span id="cb122-17"><a href="#cb122-17"></a>ajuste_6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y6 <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a><span class="fu">compare_performance</span>(ajuste_1, ajuste_2, ajuste_3, ajuste_4, ajuste_5, ajuste_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Comparison of Model Performance Indices

Name     | Model |  AIC (weights) | AICc (weights) |  BIC (weights) |    R2 | R2 (adj.) |  RMSE | Sigma
-------------------------------------------------------------------------------------------------------
ajuste_1 |    lm |   50.1 (&gt;.999) |   50.1 (&gt;.999) |   64.8 (&gt;.999) | 0.997 |     0.997 | 0.247 | 0.248
ajuste_2 |    lm | 2827.3 (&lt;.001) | 2827.3 (&lt;.001) | 2842.0 (&lt;.001) | 0.956 |     0.956 | 0.992 | 0.993
ajuste_3 |    lm | 3657.7 (&lt;.001) | 3657.8 (&lt;.001) | 3672.5 (&lt;.001) | 0.905 |     0.905 | 1.502 | 1.504
ajuste_4 |    lm | 4271.0 (&lt;.001) | 4271.0 (&lt;.001) | 4285.7 (&lt;.001) | 0.834 |     0.833 | 2.041 | 2.043
ajuste_5 |    lm | 5538.5 (&lt;.001) | 5538.6 (&lt;.001) | 5553.3 (&lt;.001) | 0.573 |     0.573 | 3.847 | 3.851
ajuste_6 |    lm | 7036.9 (&lt;.001) | 7037.0 (&lt;.001) | 7051.7 (&lt;.001) | 0.228 |     0.228 | 8.138 | 8.146</code></pre>
</div>
</div>
</section>
<section id="ruido-vs-r2-2" class="slide level2">
<h2>Ruido vs R2</h2>
<p>En todos los casos el <span class="hl-yellow"><strong>ajuste debe ser (aprox) el mismo</strong></span> ya que el modelo de regresi√≥n busca <span class="hl-yellow"><strong>modelizar los efectos lineales no aleatorios</strong></span> entre la variable objetivo y los predictores.</p>
<div class="fragment">
<p><span class="hl-green"><strong>Moraleja</strong></span>: tener un <span class="math inline">\(R^2\)</span> no implica que el modelo sea malo, ya que la <span class="hl-yellow"><strong>cantidad de informaci√≥n no modelizable</strong></span> puede deberse a una <span class="hl-red"><strong>cantidad alta de ruido (algo aleatorio no predecible)</strong></span>. Por ello es importante usar m√°s herramientas que un mero coeficiente para valorar un ajuste (por ejemplo, en campos como la sociolog√≠a o la econom√≠a la bondad de ajuste ser√° generalmente bajo)</p>
</div>
<div class="fragment">
<p>&nbsp;</p>
<p><span class="hl-yellow"><strong>Deberes</strong></span>: ¬øc√≥mo ilustrar gr√°ficamente que a mayor varianza del ruido, menor es <span class="math inline">\(R^2\)</span>? Dise√±a un estudio de simulaci√≥n para ello con distintos modelos y gr√°fica la ca√≠da de <span class="math inline">\(R^2\)</span>.</p>
</div>
</section>
<section id="diagnosis-vs-r2" class="slide level2">
<h2>Diagnosis vs R2</h2>
<p>Entonces, si tenemos un modelo con un alto <span class="math inline">\(R^2\)</span>, <span class="hl-yellow"><strong>¬øno hace falta que cumpla las hip√≥tesis?</strong></span></p>
<div class="fragment">
<p>Vamos a simular un modelo que <span class="hl-red"><strong>incumple</strong></span></p>
<ul>
<li><p>Linealidad</p></li>
<li><p>Homocedasticidad</p></li>
</ul>
</div>
<div class="fragment">
<p>La variable predictora <span class="math inline">\(x_i = 0.01 + 0.01*(i-1)\)</span> (<span class="math inline">\(i = 1,\ldots, n = 200\)</span>) ser√° la siguiente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="hl-yellow"><strong>¬øC√≥mo podr√≠amos crear una <span class="math inline">\(Y\)</span> cuya relaci√≥n con <span class="math inline">\(X\)</span> sea no lineal?</strong></span></p>
</div>
</section>
<section id="diagnosis-vs-r2-1" class="slide level2">
<h2>Diagnosis vs R2</h2>
<p><span class="hl-yellow"><strong>¬øC√≥mo podr√≠amos crear una <span class="math inline">\(Y\)</span> cuya relaci√≥n con <span class="math inline">\(X\)</span> sea no lineal?</strong></span></p>
<p>Tenemos muchas maneras, por ejemplo:</p>
<p><span class="math display">\[Y = X + X^2 + \varepsilon, \quad \varepsilon \sim N(0, \sigma_{\varepsilon})\]</span></p>
<p><span class="math display">\[Y = \log(X^2) - cos(X) + \varepsilon, \quad \varepsilon \sim N(0, \sigma_{\varepsilon})\]</span></p>
<p><span class="math display">\[Y = \frac{1}{X + 1} + \varepsilon, \quad \varepsilon \sim N(0, \sigma_{\varepsilon})\]</span></p>
<p><span class="math display">\[Y = 1 - 2X(1 + 0.25 \sin(4 \pi X)) + \varepsilon, \quad \varepsilon \sim N(0, \sigma_{\varepsilon})\]</span></p>
<div class="fragment">
<p>Simula este √∫ltimo modelo (con <span class="math inline">\(\sigma_{\varepsilon} = 0.5\)</span>) y realiza el ajuste</p>
</div>
</section>
<section id="diagnosis-vs-r2-2" class="slide level2">
<h2>Diagnosis vs R2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.15</span>, <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">200</span>)</span>
<span id="cb126-2"><a href="#cb126-2"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="fl">0.5</span>)</span>
<span id="cb126-3"><a href="#cb126-3"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">4</span> <span class="sc">*</span> pi <span class="sc">*</span> x)) <span class="sc">+</span> eps</span>
<span id="cb126-4"><a href="#cb126-4"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"y"</span> <span class="ot">=</span> y, <span class="st">"x"</span> <span class="ot">=</span> x)</span>
<span id="cb126-5"><a href="#cb126-5"></a>ajuste_lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb126-6"><a href="#cb126-6"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.24296 -0.45519  0.03292  0.48913  1.64761 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.94952    0.10745   8.837 5.35e-16 ***
x           -1.89776    0.08943 -21.221  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6788 on 198 degrees of freedom
Multiple R-squared:  0.6946,    Adjusted R-squared:  0.6931 
F-statistic: 450.3 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="fragment">
<p><span class="hl-yellow"><strong>¬øC√≥mo podr√≠amos hacer que la hip√≥tesis de homocedasticidad no se cumpla</strong></span></p>
</div>
</section>
<section id="diagnosis-vs-r2-3" class="slide level2">
<h2>Diagnosis vs R2</h2>
<p>Vamos a considerar que la <span class="hl-yellow"><strong>varianza del error no es cte, crece seg√∫n aumenta x</strong></span></p>
<p><span class="math display">\[y_i = f(x_i) + \varepsilon_i, \quad \varepsilon_i \sim N(0, \sigma_{\varepsilon,i}), \quad \sigma_{\varepsilon,i} = 0.25 * x_{i}^2 \quad i=1, \ldots, 200\]</span></p>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">2</span>, <span class="at">l =</span> <span class="dv">200</span>)</span>
<span id="cb128-2"><a href="#cb128-2"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="fl">0.25</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb128-3"><a href="#cb128-3"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.25</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">4</span> <span class="sc">*</span> pi <span class="sc">*</span> x)) <span class="sc">+</span> eps</span>
<span id="cb128-4"><a href="#cb128-4"></a>datos <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="st">"y"</span> <span class="ot">=</span> y, <span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"sigma"</span> <span class="ot">=</span>  <span class="fl">0.25</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb128-5"><a href="#cb128-5"></a>ajuste_lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> y <span class="sc">~</span> x)</span>
<span id="cb128-6"><a href="#cb128-6"></a>ajuste_lineal <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.85030 -0.27702  0.02903  0.24577  2.18323 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.93472    0.08849   10.56   &lt;2e-16 ***
x           -1.90353    0.07635  -24.93   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6234 on 198 degrees of freedom
Multiple R-squared:  0.7584,    Adjusted R-squared:  0.7572 
F-statistic: 621.6 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="diagnosis-vs-r2-4" class="slide level2">
<h2>Diagnosis vs R2</h2>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> sigma), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-82-1.png" width="960" class="r-stretch"><p>Aunque el <span class="math inline">\(R^2\)</span> es bastante alto, el modelo no tiene sentido, dando <span class="hl-red"><strong>estimaciones cada vez m√°s erradas</strong></span> seg√∫n nos movemos hacia la derecha en el eje X.</p>
</section>
<section id="cosicas-a-examen" class="slide level2">
<h2>Cosicas a examen</h2>
<p>Algunas cosas que podr√≠an caer en la primera entrega:</p>
<div class="fragment">
<ul>
<li>Realizar un <span class="hl-yellow"><strong>an√°lisis exploratorio inicial</strong></span> lo m√°s completo posible. Elegir de manera justificada <span class="hl-yellow"><strong>la mejor predictora</strong></span></li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Saber <span class="hl-yellow"><strong>ajustar e INTERPRETAR</strong></span> un modelo de regresi√≥n.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Realizar e interpretar la <span class="hl-yellow"><strong>fase de diagnosis</strong></span> lo m√°s completa posible para luego interpretar (si procede) la <span class="hl-yellow"><strong>inferencia</strong></span> del modelo.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Saber hacer una <span class="hl-yellow"><strong>correcta fase de evaluaci√≥n</strong></span> dle modelo.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Saber <span class="hl-yellow"><strong>simular modelos de regresi√≥n</strong></span> (tanto que cumplan las hip√≥tesis como que no las cumplan).</li>
</ul>
</div>
</section></section>
<section>
<section id="clase-10" class="title-slide slide level1 center">
<h1>Clase 10: predicci√≥n y resumen</h1>
<p><span style="color:#444442;"><strong>Fase de predicci√≥n. Resumen</strong></span></p>
</section>
<section id="resumen" class="slide level2">
<h2>Resumen</h2>
<p>Un breve resumen de lo aprendido sobre reg. lineal univariante</p>
<ul>
<li><span class="hl-yellow"><strong>Modelo supervisado de predicci√≥n</strong></span>: hay una variable objetivo <span class="math inline">\(Y\)</span> continua (num√©rica) cuyo valor real conocemos</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>La visualizaci√≥n importa</strong></span>: no fies tu an√°lisis solo a los par√°metros matem√°ticos, la visualizaci√≥n ayuda a entender los datos.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Relaci√≥n entre variables</strong></span>: buscamos predictoras muy correladas (linealmente) con <span class="math inline">\(Y\)</span> y lo m√°s incorreladas/independientes entre ellas.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Modelo</strong></span>: el modelo par√°metrico se resume en <span class="math inline">\(Y = \beta_0 + \beta_1 X + \varepsilon\)</span>, donde <span class="math inline">\(\varepsilon\)</span> es una variable aleatoria (ruido).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Estimaci√≥n</strong></span>: la estimaci√≥n viene modelizada bajo la hip√≥tesis de linealidad</li>
</ul>
<p><span class="math display">\[E[Y|X=x] = \beta_0 + \beta_1 x\]</span></p>
</div>
</section></section>
<section id="clase-11" class="title-slide slide level1 center">
<h1>Clase 11: entrega I</h1>
<p><span style="color:#444442;"><strong>Entrega I</strong></span></p>
</section>

<section>
<section id="clase-12" class="title-slide slide level1 center">
<h1>Clase 12: incumpliendo hip√≥tesis</h1>
<p><span style="color:#444442;"><strong>¬øC√≥mo simular datos que incumplan las hip√≥tesis?</strong></span></p>
</section>
<section id="incumpliendo-hip√≥tesis" class="slide level2">
<h2>Incumpliendo hip√≥tesis</h2>
<p>Los contenidos vistos en esta clase se subir√°n resumidos en formato notebook.</p>
</section></section>
<section>
<section id="clase-13" class="title-slide slide level1 center">
<h1>Clase 13: reg. multivariante</h1>
<p><span style="color:#444442;"><strong>Introducci√≥n a la regresi√≥n multivariante. Formulaci√≥n del modelo y estimaci√≥n</strong></span></p>
</section>
<section id="formulaci√≥n-multivariante" class="slide level2">
<h2>Formulaci√≥n multivariante</h2>
<p>De aqu√≠ en adelante llamaremos <span class="hl-yellow"><strong>modelo multivariante</strong></span> a todo modelo en el que <span class="math inline">\(p &gt; 1\)</span> (es decir, tenemos m√°s de una variable predictora).</p>
<p><span class="math display">\[Y = f\left(X_1, \ldots, X_p \right) + \varepsilon, \quad E \left[Y | \boldsymbol{X} = x \right] =f\left(X_1, \ldots, X_p \right)\]</span> tal que <span class="math inline">\(E \left[ \varepsilon | \left( X_1 = x_1, \ldots, X_p = x_p \right) \right] = 0\)</span>.</p>
<div class="fragment">
<p>En el caso del <span class="hl-yellow"><strong>modelo lineal multivariante</strong></span> se traducir√° por tanto en</p>
<p><span class="math display">\[E \left[Y | \boldsymbol{X} = x \right]  = \beta_0 + \beta_1 X_1 + \ldots + \beta_p X_p, \quad \widehat{Y} = \widehat{\beta_0} + \displaystyle \sum_{j=1}^{p} \widehat{\beta_j} X_j \]</span></p>
<p>El objetivo seguir√° siendo obtener la estimaci√≥n de los <span class="math inline">\(\widehat{\beta}\)</span> tal que <span class="hl-yellow"><strong>minimicemos el error</strong></span></p>
</div>
</section>
<section id="formulaci√≥n-matricial" class="slide level2">
<h2>Formulaci√≥n matricial</h2>
<p>Su formulaci√≥n muestral la podemos expresar mediante la <span class="hl-yellow"><strong>matriz de dise√±o</strong></span></p>
<p><span class="math display">\[\mathbf{X} =\begin{pmatrix} 1 &amp; X_{11} &amp; \ldots &amp; X_{1p} \\ 1 &amp; X_{21} &amp; \ldots &amp; X_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; X_{n1} &amp; \ldots &amp; X_{np}
\end{pmatrix}_{n\times(p+1)}\]</span></p>
<p>tal que <span class="math inline">\(Y_i = \beta_0 + \sum_{j=1}^{p} \beta_j X_j + \varepsilon_i\)</span>, para todo elemento de la muestra <span class="math inline">\(i=1,\ldots, n\)</span></p>
<p><span class="math display">\[ \mathbf{Y} = \mathbf{X} \boldsymbol{\beta} + \boldsymbol{\varepsilon} = \begin{pmatrix} 1 &amp; X_{11} &amp; \ldots &amp; X_{1p} \\ 1 &amp; X_{21} &amp; \ldots &amp; X_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; X_{n1} &amp; \ldots &amp; X_{np}
\end{pmatrix}_{n\times(p+1)}\begin{pmatrix} \beta_0 \\ \beta_1 \\ \vdots \\ \beta_p \end{pmatrix}_{(p+1)\times1} + \begin{pmatrix} \varepsilon_1 \\ \varepsilon_2 \\ \vdots \\ \varepsilon_n \end{pmatrix}_{n\times1}\]</span></p>
</section>
<section id="formulaci√≥n-matricial-1" class="slide level2">
<h2>Formulaci√≥n matricial</h2>
<p>La estimaci√≥n ser√° por tanto</p>
<p><span class="math display">\[\widehat{\mathbf{Y}} = \begin{pmatrix} \widehat{Y}_1 \\ \widehat{Y}_2 \\ \vdots \\ \widehat{Y}_n \end{pmatrix}_{n\times1} = \mathbf{X} \widehat{\boldsymbol{\beta}} = \begin{pmatrix} 1 &amp; X_{11} &amp; \ldots &amp; X_{1p} \\ 1 &amp; X_{21} &amp; \ldots &amp; X_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; X_{n1} &amp; \ldots &amp; X_{np}
\end{pmatrix}_{n\times(p+1)}\begin{pmatrix} \widehat{\beta}_1 \\ \widehat{\beta}_2 \\ \vdots \\ \widehat{\beta}_p \end{pmatrix}_{(p+1)\times1}\]</span></p>
</section>
<section id="varianza-residual-1" class="slide level2">
<h2>Varianza residual</h2>
<p>Como suced√≠a antes, el objetivo ser√° minimizar la <span class="hl-yellow"><strong>varianza residual o error cuadr√°tico medio</strong></span> (varianza del error), o lo que hemos llamado <span class="math inline">\(SSR\)</span></p>
<p><span class="math display">\[SSR \left(\boldsymbol{\beta} \right) =  \displaystyle \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^{2} = \displaystyle \sum_{i=1}^{n} \left(Y_i - \beta_0 - \beta_1 X_{i1} - \ldots - \beta_p X_{ip} \right)^2 \]</span> ¬øC√≥mo quedar√≠a <strong>matricialmente</strong>?</p>
<div class="fragment">
<p><span class="math display">\[SSR \left(\boldsymbol{\beta} \right) =  \displaystyle \sum_{i=1}^{n} \widehat{\varepsilon}_{i}^{2} = \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T}\left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) = \varepsilon^{T} \varepsilon\]</span></p>
<p>As√≠, aplicando el <span class="hl-yellow"><strong>m√©todo de los m√≠nimos cuadrados</strong></span>, los <span class="hl-yellow"><strong>par√°metros √≥ptimos</strong></span> ser√°n aquellos <span class="math inline">\(\widehat{\boldsymbol{\beta}} = \left(\widehat{\beta}_0, \widehat{\beta}_1, \ldots, \widehat{\beta}_p\right)\)</span> que minimicen dicha suma</p>
<p><span class="math display">\[\widehat{\boldsymbol{\beta}} = \left(\widehat{\beta}_0, \widehat{\beta}_1, \ldots, \widehat{\beta}_p \right) = \arg \min_{\boldsymbol{\beta} \in \mathbb{R}^{p+1}} \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T}\left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)\]</span></p>
<p>Y repetimos la idea: <span class="hl-yellow"><strong>calcularemos la derivada respecto a <span class="math inline">\(\widehat{\boldsymbol{\beta}}\)</span> e igualamos a cero</strong></span></p>
</div>
</section>
<section id="m√©todo-m√≠nimos-cuadrados-4" class="slide level2">
<h2>M√©todo m√≠nimos cuadrados</h2>
<p><span class="math display">\[\widehat{\boldsymbol{\beta}} = \left(\widehat{\beta}_0, \widehat{\beta}_1, \ldots, \widehat{\beta}_p \right) = \arg \min_{\boldsymbol{\beta} \in \mathbb{R}^{p+1}} \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T}\left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)\]</span></p>
<p>Derivando matricialmente tenemos (recuerda: <span class="math inline">\(\left(A B \right)^{T} = B^{T} A^{T}\)</span>)</p>
<p><span class="math display">\[\begin{eqnarray}\frac{\partial SSR \left( \boldsymbol{\beta} \right)}{\partial \boldsymbol{\beta}} &amp;=&amp; \frac{\partial \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T}\left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)}{\partial \boldsymbol{\beta}} \nonumber \\  &amp;=&amp; \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T} \frac{\partial \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)}{\partial \boldsymbol{\beta}} + \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) \frac{\partial \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T}}{\partial \boldsymbol{\beta}} \nonumber \\  &amp;=&amp; -\left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)^{T} \mathbf{X} - \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) \mathbf{X}^{T} \nonumber \\  &amp;=&amp; -\mathbf{X}^{T}\left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right)  - \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) \mathbf{X}^{T} \nonumber \\ &amp;=&amp; -2\mathbf{X}^{T} \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) = 0 \end{eqnarray}\]</span></p>
</section>
<section id="m√©todo-m√≠nimos-cuadrados-5" class="slide level2">
<h2>M√©todo m√≠nimos cuadrados</h2>
<p><span class="math display">\[\begin{eqnarray}\frac{\partial SSR \left( \boldsymbol{\beta} \right)}{\partial \boldsymbol{\beta}} &amp;=&amp;  -2\mathbf{X}^{T} \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) = 0 \end{eqnarray}\]</span></p>
<p>Si descartamos el <span class="math inline">\(-2\)</span> como constante, tenemos que</p>
<p><span class="math display">\[\mathbf{X}^{T} \left( \mathbf{Y} - \mathbf{X} \boldsymbol{\beta} \right) = 0 \longrightarrow \mathbf{X}^{T}  \mathbf{Y} = \mathbf{X}^{T} \mathbf{X} \boldsymbol{\beta}\]</span></p>
<p>Si ahora despejamos <span class="math inline">\(\beta\)</span> multiplicando en ambos lados por <span class="math inline">\(\left(\mathbf{X}^{T}\mathbf{X} \right)^{-1}\)</span> tenemos finalmente</p>
<p><span class="math display">\[\widehat{\boldsymbol{\beta}}=\left(\mathbf{X}^{T}\mathbf{X} \right)^{-1}\mathbf{X}^{T}\mathbf{Y}\]</span></p>
</section>
<section id="estimaci√≥n" class="slide level2">
<h2>Estimaci√≥n</h2>
<p>F√≠jate que cuando <span class="math inline">\(p = 1\)</span> tenemos que</p>
<p><span class="math display">\[\widehat{\mathbf{Y}} = \begin{pmatrix} \widehat{Y}_1 \\ \vdots \\ \widehat{Y}_n \end{pmatrix}_{n\times1} = \mathbf{X} \widehat{\boldsymbol{\beta}} = \begin{pmatrix} 1 &amp; X_{11} \\\vdots &amp; \vdots \\ 1 &amp; X_{n1} \end{pmatrix}_{n \times 2}\begin{pmatrix} \widehat{\beta}_0 \\ \widehat{\beta}_1 \end{pmatrix}_{2\times1}\]</span></p>
<p>y que por tanto <span class="math inline">\(\widehat{\boldsymbol{\beta}}= \left(\begin{pmatrix} 1 &amp; \ldots &amp; 1 \\ X_{11} &amp; \ldots &amp; X_{n1} \end{pmatrix} \begin{pmatrix} 1 &amp; X_{11} \\ 1 &amp; X_{21} \\ \vdots &amp; \vdots \\ 1 &amp; X_{n1} \end{pmatrix} \right)^{-1}\mathbf{X}^{T}\mathbf{Y}\)</span></p>
<p><span class="hl-red"><strong>Deberes</strong></span>: ser√≠a interesante que para el examen supieses demostrar que cuando <span class="math inline">\(p=1\)</span> esa expresi√≥n acaba en</p>
<p><span class="math display">\[\widehat{\beta}_1  = \frac{s_{xy}}{s_{x}^{2}}, \quad \widehat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x}\]</span></p>
</section>
<section id="estimaci√≥n-1" class="slide level2">
<h2>Estimaci√≥n</h2>
<p><span class="math display">\[\widehat{\boldsymbol{\beta}}=\left(\mathbf{X}^{T}\mathbf{X} \right)^{-1}\mathbf{X}^{T}\mathbf{Y}\]</span></p>
<ul>
<li>La <span class="hl-yellow"><strong>estimaci√≥n</strong></span> ser√° por tanto</li>
</ul>
<p><span class="math display">\[\widehat{\mathbf{Y}} = \mathbf{X}\hat{\boldsymbol{\beta}}=\mathbf{X}\left(\mathbf{X}^{T}\mathbf{X} \right)^{-1}\mathbf{X}^{T}\mathbf{Y} = \mathbf{H}\mathbf{Y}\]</span></p>
<ul>
<li>La matriz <span class="math inline">\(\mathbf{H} = \mathbf{X}\left(\mathbf{X}^{T}\mathbf{X} \right)^{-1}\mathbf{X}^{T}\)</span> se conoce como <span class="hl-yellow"><strong>hat matrix o matriz de proyecci√≥n</strong></span> (ya que hace que las estimaciones <span class="math inline">\(\hat{y}\)</span> sean en realidad los valores <span class="math inline">\(y\)</span> proyectados verticalmente sobre el plano de regresi√≥n ajustado).</li>
</ul>
</section>
<section id="interpretaci√≥n" class="slide level2">
<h2>Interpretaci√≥n</h2>
<p>Al igual que pasaba antes ser√° importante <span class="hl-yellow"><strong>distinguir lo poblaci√≥n de lo muestral</strong></span></p>
<ul>
<li><p>Los par√°metros <span class="math inline">\(\left( \beta_0, \beta_1, \ldots, \beta_p \right)\)</span> son desconocidos, los <span class="hl-yellow"><strong>par√°metros poblacionales</strong></span></p></li>
<li><p>Los par√°metros <span class="math inline">\(\left( \widehat{\beta}_0, \widehat{\beta}_1 , \ldots, \widehat{\beta}_p\right)\)</span> son estimados a partir de los datos, son <span class="hl-yellow"><strong>variables aleatorias</strong></span> ya que han sido calculados en funci√≥n de una muestra aleatoria.</p></li>
</ul>
<p>&nbsp;</p>
<p><span class="hl-yellow"><strong>¬øC√≥mo se interpretan ahora los par√°metros?</strong></span></p>
</section>
<section id="interpretaci√≥n-1" class="slide level2">
<h2>Interpretaci√≥n</h2>
<p><span class="math display">\[\widehat{\mathbf{Y}} = \mathbf{X}\widehat{\boldsymbol{\beta}}= \widehat{\beta}_0 + \sum_{j=1}^{p} \widehat{\beta}_j X_j\]</span></p>
<ul>
<li><span class="hl-yellow"><strong>Ordenada en el origen</strong></span>: tambi√©n llamado <strong>intercepto</strong>, y denotado como <span class="math inline">\(\beta_0\)</span> su valor real, es el valor de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X_1 = \ldots = X_p = 0\)</span>. Es decir, <span class="math inline">\(\widehat{\beta}_0\)</span> se puede interpretar como la estimaci√≥n <span class="math inline">\(\widehat{Y}\)</span> cuando <span class="hl-purple"><strong>TODAS las predictoras son nulas</strong></span></li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-yellow"><strong>Pendientes</strong></span>: denotadas como <span class="math inline">\(\beta_j\)</span>, para <span class="math inline">\(j=1,\ldots, p\)</span>, su valor real, cuantifica el incremento de <span class="math inline">\(Y\)</span> cuando solo <span class="math inline">\(X_j\)</span> aumenta una unidad. Es decir, <span class="math inline">\(\widehat{\beta}_j\)</span> se puede interpretar como la variaci√≥n de la estimaci√≥n <span class="math inline">\(\widehat{Y}\)</span> cuando <span class="hl-purple"><strong><span class="math inline">\(X_j\)</span> tiene un incremento unitario y el RESTO DE PREDICTORAS permanecen fijas</strong></span>.</li>
</ul>
</div>
</section>
<section id="diagnosis-3" class="slide level2">
<h2>Diagnosis</h2>
<p>En el caso multivariante las <span class="hl-yellow"><strong>4 hip√≥tesis</strong></span> se convierten en</p>
<ol type="1">
<li><span class="hl-green"><strong>Linealidad</strong></span>: el valor esperado de <span class="math inline">\(Y\)</span> es</li>
</ol>
<p><span class="math display">\[E \left[Y | \left( \boldsymbol{X}_1 = x_1, \ldots, \boldsymbol{X}_p = x_p \right) \right] = \beta_0 + \beta_1 x_1 + \ldots + \beta_p x_p\]</span></p>
<ol start="2" type="1">
<li><p><span class="hl-green"><strong>Homocedasticidad</strong></span>: necesitamos que la <span class="hl-yellow"><strong>varianza del error sea finita y constante</strong></span> <span class="math inline">\(\sigma_{r}^2 = \sigma_{\varepsilon}^2 = {\rm Var} \left[\varepsilon | \left( \boldsymbol{X}_1 = x_1, \ldots, \boldsymbol{X}_p = x_p \right) \right] = cte &lt; \infty\)</span></p></li>
<li><p><span class="hl-green"><strong>Normalidad</strong></span>: pediremos que <span class="math inline">\(\varepsilon \sim N \left(0, \sigma_{r}^2 \right)\)</span></p></li>
<li><p><span class="hl-green"><strong>Independencia</strong></span>: los errores <span class="math inline">\(\left\lbrace \varepsilon_i \right\rbrace_{i=1}^{n}\)</span> deben ser en independientes, y en particular <strong>incorrelados</strong> <span class="math inline">\({\rm Cor}_{\varepsilon_i \varepsilon_j} = E \left[\varepsilon_i \varepsilon_j \right] = 0, \quad i \neq j\)</span></p></li>
</ol>
<p><span class="math display">\[Y | \left( \boldsymbol{X}_1 = x_1, \ldots, \boldsymbol{X}_p = x_p \right) \sim N \left(\beta_0 + \beta_1x_1 + \ldots + \beta_p x_p, \sigma_{\varepsilon}^2 \right)\]</span></p>
</section>
<section id="inferencia" class="slide level2">
<h2>Inferencia</h2>
<p>Ahora las hip√≥tesis nos permiten decir que los <span class="hl-yellow"><strong>par√°metros estimados siguen una distribuci√≥n normal multivariante</strong></span> de <span class="hl-purple"><strong>media el vector de par√°metros</strong></span> a estimar y de <span class="hl-purple"><strong>matriz de covarianzas la varianza residual por <span class="math inline">\(\left(\mathbf{X}^{T}\mathbf{X} \right)^{-1}\)</span></strong></span></p>
<p><span class="math display">\[\widehat{\boldsymbol{\beta}} \sim N_{p+1}\left(\boldsymbol{\beta}, \sigma_{\varepsilon}^2 \left( \mathbf{X}^{T}\mathbf{X} \right)^{-1}\right)\]</span></p>
<div class="fragment">
<p>Esa normal multivariante, componente a componente, deriva en</p>
<p><span class="math display">\[\widehat{\beta}_j\sim N \left(\beta_j, SE \left(\widehat{\beta}_j\right)^2 \right), \quad \frac{\widehat{\beta}_j - \beta_j}{SE \left(\widehat{\beta}_j\right)} \sim N \left(0, 1 \right), \quad \frac{\widehat{\beta}_j - \beta_j}{\widehat{SE} \left(\widehat{\beta}_j\right)} \sim t_{n-p-1}\]</span></p>
<p>donde <span class="math inline">\(SE \left(\widehat{\beta}_j\right)^2 = \sigma_{\varepsilon}^2 v_j\)</span> y <span class="math inline">\(\widehat{SE} \left(\widehat{\beta}_j\right)^2 = \widehat{\sigma}_{\varepsilon}^2 v_j\)</span>, con <span class="math inline">\(v_j\)</span> el elemento <span class="math inline">\(j\)</span>-√©simo de la diagonal de <span class="math inline">\(\left( \mathbf{X}^{T}\mathbf{X} \right)^{-1}\)</span> (matriz que representa la <strong>variabilidad de predictores</strong>)</p>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>Vamos a volver a usar nuestros datos <code>wine.csv</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"./datos/wine.csv"</span>)</span>
<span id="cb131-2"><a href="#cb131-2"></a>datos</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 √ó 7
    Year Price WinterRain  AGST HarvestRain   Age FrancePop
   &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1  1952  7.50        600  17.1         160    31    43184.
 2  1953  8.04        690  16.7          80    30    43495.
 3  1955  7.69        502  17.2         130    28    44218.
 4  1957  6.98        420  16.1         110    26    45152.
 5  1958  6.78        582  16.4         187    25    45654.
 6  1959  8.08        485  17.5         187    24    46129.
 7  1960  6.52        763  16.4         290    23    46584.
 8  1961  8.49        830  17.3          38    22    47128.
 9  1962  7.39        697  16.3          52    21    48089.
10  1963  6.71        608  15.7         155    20    48799.
# ‚Ñπ 17 more rows</code></pre>
</div>
</div>
<p>Pero esta vez no vamos a seleccionar ninguna variable previamente. Para <span class="hl-yellow"><strong>ajustar un modelo multivariante</strong></span> basta con a√±adir variables <code>+</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1"></a>ajuste_uni <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> Price <span class="sc">~</span> AGST)</span>
<span id="cb133-2"><a href="#cb133-2"></a>ajuste_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> Price <span class="sc">~</span> AGST <span class="sc">+</span> HarvestRain)</span>
<span id="cb133-3"><a href="#cb133-3"></a>ajuste_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos, <span class="at">formula =</span> Price <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv-1" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>F√≠jate que ahora la tabla <code>coefficients</code> tiene una <span class="hl-yellow"><strong>l√≠nea por covariable</strong></span> (m√°s <span class="math inline">\(\beta_0\)</span>) y adem√°s en este caso dice <code>(1 not defined because of singularities)</code>: la <span class="hl-red"><strong>matriz de covarianzas no es invertible</strong></span> ya que el <span class="hl-red"><strong>determinante es 0</strong></span> (en este caso <code>Year</code> es ‚Äúigual‚Äù que <code>Age</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ ., data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46541 -0.24133  0.00413  0.18974  0.52495 

Coefficients: (1 not defined because of singularities)
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.496e+01  1.081e+02   0.231  0.81956    
Year        -1.377e-02  5.821e-02  -0.237  0.81531    
WinterRain   1.153e-03  4.991e-04   2.311  0.03109 *  
AGST         6.144e-01  9.799e-02   6.270 3.22e-06 ***
HarvestRain -3.837e-03  8.366e-04  -4.587  0.00016 ***
Age                 NA         NA      NA       NA    
FrancePop   -2.213e-05  1.268e-04  -0.175  0.86313    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.293 on 21 degrees of freedom
Multiple R-squared:  0.8278,    Adjusted R-squared:  0.7868 
F-statistic: 20.19 on 5 and 21 DF,  p-value: 2.232e-07</code></pre>
</div>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv-2" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>Una vez eliminada, en la √∫ltima l√≠nea <code>F-statistic: ... p-value: 2.232e-07</code>: se est√° <span class="hl-green"><strong>rechazando la hip√≥tesis nula</strong></span> del contraste de significaci√≥n global (existe <span class="hl-green"><strong>alguna predictora cuyo efecto lineal es significativo</strong></span>). Recuerda que la nula es <span class="math inline">\(H_0:~\beta_1 = \ldots = \beta_5 = 0\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a>ajuste_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> datos <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>Age), <span class="at">formula =</span> Price <span class="sc">~</span> .)</span>
<span id="cb136-2"><a href="#cb136-2"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ ., data = select(datos, -Age))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46541 -0.24133  0.00413  0.18974  0.52495 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.496e+01  1.081e+02   0.231  0.81956    
Year        -1.377e-02  5.821e-02  -0.237  0.81531    
WinterRain   1.153e-03  4.991e-04   2.311  0.03109 *  
AGST         6.144e-01  9.799e-02   6.270 3.22e-06 ***
HarvestRain -3.837e-03  8.366e-04  -4.587  0.00016 ***
FrancePop   -2.213e-05  1.268e-04  -0.175  0.86313    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.293 on 21 degrees of freedom
Multiple R-squared:  0.8278,    Adjusted R-squared:  0.7868 
F-statistic: 20.19 on 5 and 21 DF,  p-value: 2.232e-07</code></pre>
</div>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv-3" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>Si nos fijamos en la tabla de coeficientes el <span class="hl-yellow"><strong>modelo ajustado</strong></span> es</p>
<p><span class="math display">\[\begin{eqnarray}\widehat{Precio} &amp;=&amp; 2.496 - 0.0137 * Year + 0.0012 * WinterRain + 0.614 * AGST \nonumber \\ &amp;-&amp; 0.0038 * HarvestRain - 0.00002 * FrancePop \nonumber \end{eqnarray}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ ., data = select(datos, -Age))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46541 -0.24133  0.00413  0.18974  0.52495 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.496e+01  1.081e+02   0.231  0.81956    
Year        -1.377e-02  5.821e-02  -0.237  0.81531    
WinterRain   1.153e-03  4.991e-04   2.311  0.03109 *  
AGST         6.144e-01  9.799e-02   6.270 3.22e-06 ***
HarvestRain -3.837e-03  8.366e-04  -4.587  0.00016 ***
FrancePop   -2.213e-05  1.268e-04  -0.175  0.86313    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.293 on 21 degrees of freedom
Multiple R-squared:  0.8278,    Adjusted R-squared:  0.7868 
F-statistic: 20.19 on 5 and 21 DF,  p-value: 2.232e-07</code></pre>
</div>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv-4" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p><span class="math display">\[\begin{eqnarray}\widehat{Precio} &amp;=&amp; 2.496 - 0.0137 * Year + 0.0012 * WinterRain + 0.614 * AGST \nonumber \\ &amp;-&amp; 0.0038 * HarvestRain - 0.00002 * FrancePop \nonumber \end{eqnarray}\]</span></p>
<p>La <span class="hl_yellow"><strong>interpretaci√≥n</strong></span> es</p>
<ul>
<li><p>La estimaci√≥n del modelo cuando todas las covariables son 0 (sin poblaci√≥n, sin lluvia ni temperatura, a√±o 0) es de 2.496 (escala log)</p></li>
<li><p>Por ejemplo, si el resto de variables permaneciesen fijas, por cada litro de lluvia que caiga de m√°s durante la cosecha (agosto-septiembre), el modelo estima que el precio baja 3.8 (escala log)</p></li>
</ul>
</section>
<section id="caso-pr√°ctico-wine.csv-5" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>Si nos fijamos en la tabla de coeficientes tenemos <strong>2 predictoras cuyo efecto lineal no se acepta que sea significativo</strong>: <code>Year</code>, <code>FrancePop</code> (adem√°s de <span class="math inline">\(\beta_0\)</span>) ya que el contraste de significaci√≥n <span class="math inline">\(H_0:~\beta_j = 0\)</span> vs <span class="math inline">\(H_1:~\beta_j \neq 0\)</span> nos devuelve un <span class="math inline">\(p-valor &gt; \alpha\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ ., data = select(datos, -Age))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46541 -0.24133  0.00413  0.18974  0.52495 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.496e+01  1.081e+02   0.231  0.81956    
Year        -1.377e-02  5.821e-02  -0.237  0.81531    
WinterRain   1.153e-03  4.991e-04   2.311  0.03109 *  
AGST         6.144e-01  9.799e-02   6.270 3.22e-06 ***
HarvestRain -3.837e-03  8.366e-04  -4.587  0.00016 ***
FrancePop   -2.213e-05  1.268e-04  -0.175  0.86313    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.293 on 21 degrees of freedom
Multiple R-squared:  0.8278,    Adjusted R-squared:  0.7868 
F-statistic: 20.19 on 5 and 21 DF,  p-value: 2.232e-07</code></pre>
</div>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv-6" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>La pregunta que intentaremos resolver en futuras clases es:</p>
<p><span class="hl-yellow"><strong>¬øC√≥mo decidir que predictoras seleccionamos?</strong></span> El problema si quitamos todas las no significativas de manera simult√°nea es que no sabemos qu√© <strong>efectos puede haber entre las propias predictoras</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ ., data = select(datos, -Age))

Residuals:
     Min       1Q   Median       3Q      Max 
-0.46541 -0.24133  0.00413  0.18974  0.52495 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.496e+01  1.081e+02   0.231  0.81956    
Year        -1.377e-02  5.821e-02  -0.237  0.81531    
WinterRain   1.153e-03  4.991e-04   2.311  0.03109 *  
AGST         6.144e-01  9.799e-02   6.270 3.22e-06 ***
HarvestRain -3.837e-03  8.366e-04  -4.587  0.00016 ***
FrancePop   -2.213e-05  1.268e-04  -0.175  0.86313    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.293 on 21 degrees of freedom
Multiple R-squared:  0.8278,    Adjusted R-squared:  0.7868 
F-statistic: 20.19 on 5 and 21 DF,  p-value: 2.232e-07</code></pre>
</div>
</div>
</section>
<section id="caso-pr√°ctico-wine.csv-7" class="slide level2">
<h2>Caso pr√°ctico: wine.csv</h2>
<p>F√≠jate que ahora en la <span class="hl-yellow"><strong>fase de diagnosis</strong></span> tenemos una <strong>sexta gr√°fica a chequear</strong>: una gr√°fica que nos calcula la conocida como <code>VIF</code> (Variance Inflaction), que nos <span class="hl-yellow"><strong>cuantifica la colinealidad (efectos lineales) entre las predictoras</strong></span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="fu">check_model</span>(ajuste_full)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-90-1.png" width="960" class="r-stretch"></section>
<section id="anova-5" class="slide level2">
<h2>ANOVA</h2>
<p>Ahora <code>anova()</code> en realidad nos hace una <span class="hl-yellow"><strong>ANOVA secuencial</strong></span> (variable a variable)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Price
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Year         1 2.2195  2.2195 25.8480 4.916e-05 ***
WinterRain   1 0.2635  0.2635  3.0693 0.0943762 .  
AGST         1 4.3055  4.3055 50.1419 5.495e-07 ***
HarvestRain  1 1.8760  1.8760 21.8485 0.0001298 ***
FrancePop    1 0.0026  0.0026  0.0305 0.8631279    
Residuals   21 1.8032  0.0859                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="anova-6" class="slide level2">
<h2>ANOVA</h2>
<p>Ahora <code>anova()</code> en realidad nos hace una <span class="hl-yellow"><strong>ANOVA secuencial</strong></span> (variable a variable)</p>
<table>
<colgroup>
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Df (grados)</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_1\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(SSR_1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{SSR_1}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F-value = \frac{\frac{SSR_1}{1}}{\frac{SSE}{n-p-1}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(p_1\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">‚Ä¶</td>
<td style="text-align: center;">‚Ä¶</td>
<td style="text-align: center;">‚Ä¶</td>
<td style="text-align: center;">‚Ä¶</td>
<td style="text-align: center;"><span class="math inline">\(F-value = \frac{\frac{SSR}{p}}{\frac{SSE}{n-p-1}}\)</span></td>
<td style="text-align: center;">p-valor F test</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(x_p\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;"><span class="math inline">\(SSR_p\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{SSR_p}{1}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F-value = \frac{\frac{SSR_p}{1}}{\frac{SSE}{n-p-1}}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(p_p\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Residuals</td>
<td style="text-align: center;">n - p - 1</td>
<td style="text-align: center;">SSE</td>
<td style="text-align: center;"><span class="math inline">\(\widehat{\sigma}_{\varepsilon}^{2} = \frac{SSE}{n-p-1}\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
<section id="anova-7" class="slide level2">
<h2>ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a>ajuste_full <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Price
            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Year         1 2.2195  2.2195 25.8480 4.916e-05 ***
WinterRain   1 0.2635  0.2635  3.0693 0.0943762 .  
AGST         1 4.3055  4.3055 50.1419 5.495e-07 ***
HarvestRain  1 1.8760  1.8760 21.8485 0.0001298 ***
FrancePop    1 0.0026  0.0026  0.0305 0.8631279    
Residuals   21 1.8032  0.0859                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Ahora <span class="math inline">\(SSR_j\)</span>, con <span class="math inline">\(j=1,\ldots,p\)</span>, representa la <strong>suma de residuos al cuadrado</strong> <span class="math inline">\(SSR\)</span> cuando incluimos la predictora j-√©sima <span class="math inline">\(X_j\)</span>, frente a cuando no lo hacemos, tal que</p>
<p><span class="math display">\[SSR_j = SSR \left(X_1, \ldots, X_j \right) - SSR \left(X_1, \ldots, X_{j-1} \right)\]</span></p>
<p>As√≠ los p-valores <span class="math inline">\(p_j\)</span> son individuales (los mismos que los de la tabla de coeficientes).</p>
</section></section>
<section>
<section id="clase-14" class="title-slide slide level1 center">
<h1>Clase 14: selecci√≥n de modelos</h1>
<p><span style="color:#444442;"><strong>Selecci√≥n secuencial de modelos</strong></span></p>
</section>
<section id="bondad-de-ajuste-3" class="slide level2">
<h2>Bondad de ajuste</h2>
</section>
<section id="intervalos-predicci√≥n" class="slide level2">
<h2>Intervalos predicci√≥n</h2>
</section>
<section id="multicolinealidad" class="slide level2">
<h2>Multicolinealidad</h2>
</section>
<section id="caso-pr√°ctico-3" class="slide level2">
<h2>Caso pr√°ctico</h2>
</section>
<section id="selecci√≥n-de-modelos" class="slide level2">
<h2>Selecci√≥n de modelos</h2>
</section>
<section id="bic-y-aic" class="slide level2">
<h2>BIC y AIC</h2>
</section>
<section id="consistencia" class="slide level2">
<h2>Consistencia</h2>
</section></section>
<section>
<section id="clase-15" class="title-slide slide level1 center">
<h1>Clase 15: caso pr√°ctico</h1>
<p><span style="color:#444442;"><strong>Caso pr√°ctico con datos de viviendas de Boston</strong></span></p>
</section>
<section id="section" class="slide level2">
<h2>‚Ä¶</h2>
</section></section>
<section>
<section id="clase-16" class="title-slide slide level1 center">
<h1>Clase 16: variables cualitativas</h1>
<p><span style="color:#444442;"><strong>¬øC√≥mo introducir predictoras cualitativas?</strong></span></p>
</section>
<section id="section-1" class="slide level2">
<h2>‚Ä¶</h2>
</section></section>
<section>
<section id="clase-17" class="title-slide slide level1 center">
<h1>Clase 17: depuraci√≥n</h1>
<p><span style="color:#444442;"><strong>‚Ä¶</strong></span></p>
</section>
<section id="interacciones" class="slide level2">
<h2>Interacciones</h2>
</section>
<section id="ausentes" class="slide level2">
<h2>Ausentes</h2>
</section>
<section id="outliers" class="slide level2">
<h2>Outliers</h2>
</section>
<section id="section-2" class="slide level2">
<h2>‚Ä¶</h2>
</section></section>
<section>
<section id="clase-18" class="title-slide slide level1 center">
<h1>Clase 18: ‚Ä¶</h1>
<p><span style="color:#444442;"><strong>‚Ä¶</strong></span></p>
</section>
<section id="section-3" class="slide level2">
<h2>‚Ä¶</h2>
</section></section>
<section>
<section id="el-mundo-github" class="title-slide slide level1 center">
<h1>El mundo Github</h1>
<p><span style="color:#444442;"><strong>Trabajar ordenados, publicar resultados, replicabilidad de lo realizado</strong></span></p>
</section>
<section id="qu√©-es-github" class="slide level2">
<h2>¬øQu√© es Github?</h2>
<p><span class="hl-yellow"><strong>GitHub</strong></span> es la plataforma colaborativa m√°s conocida basada en el <span class="hl-yellow"><strong>sistema de control de versiones Git</strong></span></p>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>¬øQu√© es Git?</strong></span> Git es un sistema de <span class="hl-yellow"><strong>control de versiones</strong></span>: una especie de <span class="hl-yellow"><strong>Dropbox</strong></span> para facilitar la <span class="hl-yellow"><strong>programaci√≥n colaborativa</strong></span> entre un grupo de personas, permitiendo llevar la <span class="hl-yellow"><strong>trazabilidad de los cambios</strong></span> realizados.</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>¬øQu√© es Github?</strong></span> Nuestra <span class="hl-yellow"><strong>plataforma/interfaz</strong></span> para ejecutar el control de versiones: nos servir√° no solo para trabajar colaborativamente sino para <span class="hl-yellow"><strong>hacer transparente</strong></span> el proceso de construcci√≥n de nuestros proyectos de c√≥digo.</li>
</ul>
</div>
<div class="fragment">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Importante</strong></p>
</div>
<div class="callout-content">
<p>Desde el 4 de junio de 2018 Github es de Microsoft (ergo el c√≥digo que subas tambi√©n)</p>
</div>
</div>
</div>
</div>
</section>
<section id="visi√≥n-general" class="slide level2">
<h2>Visi√≥n general</h2>
<p>Tras hacernos una cuenta en Github, <span class="hl-purple"><strong>arriba a la derecha</strong></span> tendremos un c√≠rculo, y haciendo click en <span class="hl-purple"><strong>Your Profile</strong></span>, veremos algo similar a esto</p>
<div class="columns">
<div class="column" style="width:55%;">
<p><img data-src="img/github_1.png"></p>
</div><div class="column" style="width:45%;">
<ul>
<li><p><span class="hl-purple"><strong>Edit profile</strong></span>: nos permite a√±adir una <span class="hl-yellow"><strong>descripci√≥n y foto de perfil</strong></span>.</p></li>
<li><p><span class="hl-purple"><strong>Overview</strong></span>: en ese panel de cuadrados se <span class="hl-yellow"><strong>visualizar√° nuestra actividad</strong></span> a lo largo del tiempo.</p></li>
<li><p><span class="hl-purple"><strong>Repositories</strong></span>: el c√≥dugo ser√° subido a <span class="hl-yellow"><strong>repositorios</strong></span>, el equivalente a nuestras carpetas compartidas en Dropbox.</p></li>
</ul>
</div>
</div>
</section>
<section id="primer-uso-consumidor" class="slide level2">
<h2>Primer uso: consumidor</h2>
<p>Antes de aprender como crear repositorios, Github tambi√©n nos servir√° para</p>
<ul>
<li><span class="hl-purple"><strong>Acceder a c√≥digo</strong></span> ajeno</li>
<li><span class="hl-purple"><strong>Proponer mejoras</strong></span> a otros usuarios, e incluso proponer <span class="hl-yellow"><strong>correcciones de error que detectemos</strong></span> de software que usemos</li>
</ul>
<div class="fragment">
<ul>
<li><span class="hl-purple"><strong>Instalar paquetes de R</strong></span>. En muchas ocasiones los desarrolladores de paquetes suben las actualizaciones a CRAN cada cierto tiempo, y en otras el software no es suficientemente ¬´amplio¬ª para poder ser subido como paquete.</li>
</ul>
<p>El c√≥digo de paquetes que no tengamos subido en CRAN podremos <span class="hl-yellow"><strong>instalarlo como c√≥digo desde Github</strong></span></p>
</div>
</section>
<section id="instalar-desde-github" class="slide level2">
<h2>Instalar desde Github</h2>
<p>Por ejemplo, vamos a instalar un paquete llamado <a href="https://github.com/jbgb13/peRReo"><code>{peRReo}</code></a>, cuya √∫nica funci√≥n es darnos <span class="hl-yellow"><strong>paletas de colores</strong></span> basadas en portadas de <span class="hl-yellow"><strong>√°lbumes de m√∫sica urbana</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/perrreo.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rosalia.png" width="360"></p>
</div>
</div>
<div class="fragment">
<p>Para ello antes tendremos que instalar un <span class="hl-yellow"><strong>conjunto de paquetes para desarrolladores</strong></span> llamado <code>{devtools}</code>, que nos permitir√° la instalaci√≥n desde Github</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="instalar-desde-github-1" class="slide level2">
<h2>Instalar desde Github</h2>
<p>Las <span class="hl-yellow"><strong>instrucciones de instalaci√≥n</strong></span> suelen venir detalladas en la portada del repositorio</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/install_perreo.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/rosalia.png" width="310"></p>
</div>
</div>
<div class="fragment">
<p>En la mayor√≠a de casos bastar√° con la funci√≥n <code>install_github()</code> (del paquete que acabamos de instalar), pas√°ndole como argumento la <span class="hl-yellow"><strong>ruta del repositorio</strong></span> (sin ‚Äúgithub.com/‚Äù).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"jbgb13/peRReo"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ya puedes perrear con ggplot ;)</p>
</div>
</section>
<section id="descargar-desde-github" class="slide level2">
<h2>Descargar desde Github</h2>
<p>La mayor√≠a de veces lo que subamos no ser√° un paquete de R como tal sino que <span class="hl-yellow"><strong>subiremos un c√≥digo m√°s o menos organizado</strong></span> y comentado. En ese caso podremos <span class="hl-yellow"><strong>descargar el repo entero</strong></span> haciendo click <span class="hl-green"><strong>Code</strong></span> y luego Download ZIP.</p>
<p>Por ejemplo, vamos a descargarnos los scripts de dataviz que han subido desde el <a href="https://github.com/ceopinio/bop-grafics">Centre d‚ÄôEstudis d‚ÄôOpini√≥</a></p>

<img data-src="img/ceo_github.png" class="r-stretch"></section>
<section id="ideal" class="slide level2">
<h2>Ideal</h2>

<img data-src="img/abogados_simpson.jpeg" width="600" class="r-stretch"><p><span class="hl-purple"><strong>¬øLo ideal en caso de RTVE?</strong></span> Tener dos tipos de repositorios</p>
<ul>
<li><p>Una <span class="hl-yellow"><strong>colecci√≥n de repositorios p√∫blicos (producci√≥n)</strong></span> donde hacer transparente el c√≥digo y los datos (<span class="hl-purple"><strong>ya validados</strong></span>), coordinado por un n¬∫ reducido de personas.</p></li>
<li><p>Una <span class="hl-yellow"><strong>colecci√≥n de repositorios privados (desarrollo)</strong></span> donde est√© todo el equipo colaborando y donde se haga el <span class="hl-purple"><strong>trabajo del d√≠a</strong></span>, con trazabilidad interna.</p></li>
</ul>
</section>
<section id="nuestro-primer-repositorio" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<p>Vamos a <span class="hl-yellow"><strong>crear nuestro primero repositorio</strong></span> que servir√° adem√°s como <span class="hl-yellow"><strong>carta de presentaci√≥n</strong></span> de nuestro perfil en Github.</p>
<ol type="1">
<li><p><span class="hl-purple"><strong>Repositories</strong></span>: hacemos click en las pesta√±a de Repositories.</p></li>
<li><p><span class="hl-purple"><strong>New</strong></span>: hacemos click en el <span class="hl-green"><strong>bot√≥n verde New</strong></span> para crear un nuevo repositorio</p></li>
</ol>

<img data-src="img/new_repo.png" class="r-stretch"></section>
<section id="nuestro-primer-repositorio-1" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<ul>
<li><p><span class="hl-purple"><strong>Repository name</strong></span>: el <span class="hl-yellow"><strong>nombre del repositorio</strong></span>. En este caso vamos a crear un repositorio muy concreto: el nombre debe <span class="hl-yellow"><strong>coincidir exactamente con tu nombre de usuario</strong></span></p></li>
<li><p><span class="hl-purple"><strong>Description</strong></span>: descripci√≥n de tu repositorio. En este caso ser√° un repo de presentaci√≥n.</p></li>
</ul>

<img data-src="img/repo_init_1.png" class="r-stretch"></section>
<section id="nuestro-primer-repositorio-2" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<ul>
<li><p><span class="hl-purple"><strong>Public vs private</strong></span>: con cada repositorio tendremos la opci√≥n de hacer el repositorio</p>
<ul>
<li><span class="hl-purple"><strong>p√∫blico</strong></span>: todos los usuarios podr√°n ver el c√≥digo as√≠ c√≥mo la trazabilidad de su desarrollo (qu√© se a√±ade y cu√°ndo). Es para m√≠ la opci√≥n m√°s recomendable cuando quieres darle <span class="hl-yellow"><strong>visibilidad y transparencia</strong></span> a tu trabajo</li>
<li><span class="hl-purple"><strong>privado</strong></span>: solo tendr√°n acceso al repositorio aquellos usuarios a los que se lo permitas. No se podr√° visualizar ni instalar nada de √©l fuera de Github.</li>
</ul></li>
</ul>

<img data-src="img/repo_init_2.png" class="r-stretch"><p>En este caso concreto, dado que ser√° un repositorio de presentaci√≥n, lo <span class="hl-yellow"><strong>haremos p√∫blico</strong></span>.</p>
</section>
<section id="nuestro-primer-repositorio-3" class="slide level2">
<h2>Nuestro primer repositorio</h2>
<ul>
<li><span class="hl-purple"><strong>Add a README file</strong></span>: un README file ser√° el archivo donde incluiremos las <span class="hl-yellow"><strong>instrucciones y detalles de uso</strong></span> a los dem√°s (en el caso de <code>{peRReo}</code> era el archivo que conten√≠a los detalles de instalaci√≥n)</li>
</ul>

<img data-src="img/repo_init_3.png" class="r-stretch"><p>De momento <span class="hl-red"><strong>ignoraremos los dem√°s campos</strong></span> para este primer repositorio.</p>
</section>
<section id="nuestro-primer-repositorio-4" class="slide level2">
<h2>Nuestro primer repositorio</h2>

<img data-src="img/repo_init_1.png" class="r-stretch"><p>Por defecto Github asume que este repositorio, con el <span class="hl-yellow"><strong>mismo nombre que nuestro usuario</strong></span> ser√° el repositorio que querremos que se presente de inicio cuando alguien entra en nuestro perfil, y ser√° el repositorio donde [<strong>incluir en el README.md</strong>] una presentaci√≥n de nosotros y un √≠ndice de tu trabajo (si quieres).</p>
</section>
<section id="nuestro-primer-repositorio-5" class="slide level2">
<h2>Nuestro primer repositorio</h2>

<img data-src="img/profile_github_md.png" class="r-stretch"><p>F√≠jate que ahora en nuestra <span class="hl-yellow"><strong>portada tenemos dicho README.md</strong></span> que podemos personalizar a nuestro gusto haciendo uso de <span class="hl-yellow"><strong>html y markdown</strong></span>.</p>
<p>Aqu√≠ puedes ver <a href="https://github.com/matiassingers/awesome-readme"><strong>algunos ejemplos de README.MD</strong></a></p>
</section>
<section id="repo-de-c√≥digo" class="slide level2">
<h2>Repo de c√≥digo</h2>
<p>Una vez que tenemos nuestro README de presentaci√≥n (recuerda que puedes <span class="hl-yellow"><strong>personalizar a tu gusto con html y markdown</strong></span>) vamos a crear un <span class="hl-yellow"><strong>repositorio de c√≥digo</strong></span>.</p>
<div class="fragment">
<p>Si ya era importante <span class="hl-yellow"><strong>trabajar con proyectos</strong></span> en <code>RStudio</code>, cuando lo combinamos con Github es a√∫n m√°s crucial que creemos un proyecto antes de subir el c√≥digo, as√≠ que vamos a crear uno de prueba que se llame <code>repo-github-1</code>.</p>
</div>
<div class="fragment">
<p>En dicho proyecto vamos a <span class="hl-yellow"><strong>crear un script</strong></span> (en mi caso llamado <strong>codigo.R</strong>) en el que deber√°s hacer los siguientes pasos:</p>
</div>
</section>
<section id="repo-de-c√≥digo-1" class="slide level2">
<h2>Repo de c√≥digo</h2>
<ol type="1">
<li><span class="hl-yellow"><strong>Carga</strong></span> directamente desde la p√°gina del <a href="https://cnecovid.isciii.es/covid19/resources">ISCIII</a> el archivo llamado <code>casos_hosp_uci_def_sexo_edad_provres.csv</code></li>
</ol>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="co"># Carga de datos desde ISCIII</span></span>
<span id="cb151-2"><a href="#cb151-2"></a>datos_covid <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"https://cnecovid.isciii.es/covid19/resources/casos_hosp_uci_def_sexo_edad_provres.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><span class="hl-yellow"><strong>Filtra</strong></span> datos de Madrid (<code>"M"</code>), de 2020 y con sexo conocido (hombre/mujer). Tras ello qu√©date con las columnas <code>fecha</code>, <code>sexo</code>, <code>grupo_edad</code>, <code>num_casos</code> (ese orden). Por √∫ltimo obt√©n la suma de casos diarios por fecha y sexo.</li>
</ol>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1"></a><span class="co"># Depuraci√≥n</span></span>
<span id="cb152-2"><a href="#cb152-2"></a>datos_madrid <span class="ot">&lt;-</span></span>
<span id="cb152-3"><a href="#cb152-3"></a>  datos_covid <span class="sc">|&gt;</span></span>
<span id="cb152-4"><a href="#cb152-4"></a>  <span class="co"># Filtrado por Madrid y fecha</span></span>
<span id="cb152-5"><a href="#cb152-5"></a>  <span class="fu">filter</span>(provincia_iso <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">&amp;</span> fecha <span class="sc">&lt;=</span> <span class="st">"2020-12-31"</span> <span class="sc">&amp;</span> sexo <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb152-6"><a href="#cb152-6"></a>  <span class="co"># Selecci√≥n de columnas</span></span>
<span id="cb152-7"><a href="#cb152-7"></a>  <span class="fu">select</span>(provincia_iso<span class="sc">:</span>fecha, num_casos) <span class="sc">|&gt;</span> </span>
<span id="cb152-8"><a href="#cb152-8"></a>  <span class="co"># Resumen de casos diarios por fecha y sexo</span></span>
<span id="cb152-9"><a href="#cb152-9"></a>  <span class="fu">summarise</span>(<span class="at">num_casos =</span> <span class="fu">sum</span>(num_casos), <span class="at">.by =</span> <span class="fu">c</span>(fecha, sexo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="repo-de-c√≥digo-2" class="slide level2">
<h2>Repo de c√≥digo</h2>
<ol start="3" type="1">
<li><span class="hl-yellow"><strong>Exporta el dataset a un csv</strong></span> en una carpeta que se llame <code>exportado</code></li>
</ol>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="co"># Exportamos datos</span></span>
<span id="cb153-2"><a href="#cb153-2"></a><span class="fu">write_csv</span>(datos_madrid, <span class="at">file =</span> <span class="st">"./exportado/datos_madrid.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:40%;">
<ol start="4" type="1">
<li>Crea una <span class="hl-yellow"><strong>gr√°fica de l√≠neas</strong></span> que tenga en el eje x fecha, en el eje y casos, con una curva por sexo (gr√°ficas separadas).</li>
</ol>
<div class="cell">
<details>
<summary>C√≥digo</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1"></a><span class="co"># Gr√°fica</span></span>
<span id="cb154-2"><a href="#cb154-2"></a><span class="fu">ggplot</span>(datos_madrid) <span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> fecha, <span class="at">y =</span> num_casos, <span class="at">color =</span> sexo),</span>
<span id="cb154-4"><a href="#cb154-4"></a>            <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb154-5"><a href="#cb154-5"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#85519D"</span>, <span class="st">"#278862"</span>)) <span class="sc">+</span></span>
<span id="cb154-6"><a href="#cb154-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sexo) <span class="sc">+</span></span>
<span id="cb154-7"><a href="#cb154-7"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb154-8"><a href="#cb154-8"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div><div class="column" style="width:60%;">
<p><img data-src="./img/ggplot.png" width="380"></p>
</div>
</div>
</div>
<div class="fragment">
<ol start="5" type="1">
<li>Tras ello <span class="hl-yellow"><strong>exportamos la gr√°fica</strong></span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"./exportado/ggplot.png"</span>, <span class="at">plot =</span> <span class="fu">last_plot</span>(),</span>
<span id="cb155-2"><a href="#cb155-2"></a>       <span class="at">bg =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="repo-de-c√≥digo-3" class="slide level2">
<h2>Repo de c√≥digo</h2>
<p>¬øC√≥mo <span class="hl-yellow"><strong>subimos el proyecto</strong></span>? Vamos de nuevo a <span class="hl-yellow"><strong>crear un proyecto de cero</strong></span>. Antes no hemos hablado de dos campos importantes:</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/repo-1.png" width="460"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p><code>Add .gitignore</code> nos permitir√° <span class="hl-yellow"><strong>seleccionar el lenguaje</strong></span> en el que estar√° nuestro proyecto para que Github lo entienda al sincronizar (y no actualice cosas que no deba).</p></li>
<li><p><code>Choose a license</code> nos permitir√° <span class="hl-yellow"><strong>seleccionar la licencia</strong></span> que determinar√° las condiciones en las que otros podr√°n reusar tu c√≥digo.</p></li>
</ul>
</div>
</div>
</section>
<section id="repo-de-c√≥digo-4" class="slide level2">
<h2>Repo de c√≥digo</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/repo-1-1.png"></p>
</div><div class="column" style="width:50%;">
<p>Si te fijas traer crearlo tenemos solo 3 archivos: el de licencia, el .gitignore y el readme.md (donde deber√≠amos escribir una gu√≠a de uso de lo que hayamos subido)</p>
</div>
</div>
<p>Para subir los archivos vamos a clickar en <span class="hl-purple"><strong>Add file &lt; Upload File</strong></span> y <span class="hl-yellow"><strong>arrastraremos TODOS los archivos</strong></span> de la carpeta de nuestro proyecto.</p>
</section>
<section id="repo-de-c√≥digo-5" class="slide level2">
<h2>Repo de c√≥digo</h2>
<p>Tras la subida de archivos tendremos un cuadro llamado <span class="hl-purple"><strong>Commit changes</strong></span></p>

<img data-src="./img/commit-1.png" class="r-stretch"><p>Un <span class="hl-purple"><strong>commit</strong></span> es una <span class="hl-yellow"><strong>modificaci√≥n del repositorio</strong></span> con algo que se a√±ade/elimine/modifique, y dicho cuadro es recomendable usarlo para <span class="hl-yellow"><strong>resumir en qu√© consiste la modificaci√≥n</strong></span>, de manera que quede trazado el cambio.</p>
</section>
<section id="repo-de-c√≥digo-6" class="slide level2">
<h2>Repo de c√≥digo</h2>
<p>Haciendo click en el reloj donde indica el <span class="hl-yellow"><strong>n√∫mero de commits</strong></span> accedemos al <span class="hl-yellow"><strong>hist√≥rico de commits (cambios)</strong></span> con hora, d√≠a, autor, comentarios, etc.</p>

<img data-src="./img/commit-reloj.png" class="r-stretch"></section>
<section id="repo-de-c√≥digo-7" class="slide level2">
<h2>Repo de c√≥digo</h2>
<p>Vamos a realizar un <span class="hl-yellow"><strong>cambio en nuestro c√≥digo</strong></span>: en tu c√≥digo local (local ‚Äì&gt; tu ordenador), en lugar de filtrar por Madrid haz el <span class="hl-yellow"><strong>filtro por Barcelona</strong></span>, guarda el c√≥digo y sube en el repositorio el nuevo archivo (con el mismo nombre, Github har√° la sobrescritura)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a>datos_bcn <span class="ot">&lt;-</span></span>
<span id="cb156-2"><a href="#cb156-2"></a>  datos_covid <span class="sc">|&gt;</span></span>
<span id="cb156-3"><a href="#cb156-3"></a>  <span class="fu">filter</span>(provincia_iso <span class="sc">==</span> <span class="st">"B"</span> <span class="sc">&amp;</span> fecha <span class="sc">&lt;=</span> <span class="st">"2020-12-31"</span> <span class="sc">&amp;</span> sexo <span class="sc">!=</span> <span class="st">"NC"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb156-4"><a href="#cb156-4"></a>  <span class="fu">select</span>(fecha, sexo, grupo_edad, num_casos) <span class="sc">|&gt;</span> </span>
<span id="cb156-5"><a href="#cb156-5"></a>  <span class="fu">summarise</span>(<span class="at">num_casos =</span> <span class="fu">sum</span>(num_casos), <span class="at">.by =</span> <span class="fu">c</span>(fecha, sexo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="consulta-de-commits" class="slide level2">
<h2>Consulta de commits</h2>
<p><img data-src="./img/barcelona_covid.png" width="550"></p>
<div class="columns">
<div class="column" style="width:40%;">
<p>Si ahora <span class="hl-yellow"><strong>consultamos el commit</strong></span>, al lado hay un n√∫mero que lo identifica, y clickando en √©l nos resume los cambios: no solo <span class="hl-yellow"><strong>almacena todas las versiones pasadas</strong></span> sino que adem√°s nos <span class="hl-yellow"><strong>muestra las diferencias entre los archivos cambiados</strong></span></p>
</div><div class="column" style="width:60%;">
<p><img data-src="./img/commit_cambio.png"></p>
</div>
</div>
</section>
<section id="trazabilidad-de-cambios" class="slide level2">
<h2>Trazabilidad de cambios</h2>
<div class="columns">
<div class="column" style="width:72%;">
<p><img data-src="./img/commit_split.png"> <img data-src="./img/commit_unified.png"></p>
</div><div class="column" style="width:28%;">
<p>Tenemos <span class="hl-yellow"><strong>dos modos de visualizaci√≥n</strong></span> de los cambios: el modo split nos muestra el antiguo y el nuevo, con las inclusiones en verde y lo que ya no est√° en rojo; y el modo unified nos muestra todo en un mismo documento.</p>
</div>
</div>
</section>
<section id="recuperaci√≥n-de-commits" class="slide level2">
<h2>Recuperaci√≥n de commits</h2>

<img data-src="./img/browse-repo.png" class="r-stretch"><p>Github nos permite incluso <span class="hl-yellow"><strong>recuperar una versi√≥n del pasado</strong></span> de nuestro repositorio, haciendo click en el tercer icono del commit.</p>
</section>
<section id="recuperaci√≥n-de-commits-1" class="slide level2">
<h2>Recuperaci√≥n de commits</h2>

<img data-src="./img/branch-commit.png" class="r-stretch"><p>Si te fijas ahora al lado de <code>1 branch</code> tenemos un <span class="hl-yellow"><strong>men√∫ desplegable</strong></span> en el que antes pon√≠a <code>main</code> y ahora un n√∫mero identificador del commit. Ya hablaremos de la idea de <span class="hl-yellow"><strong>rama (branch)</strong></span></p>
</section>
<section id="repo-con-rmdqmd" class="slide level2">
<h2>Repo con rmd/qmd</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>Vamos a poner en pr√°ctica lo aprendido:</p>
<ol type="1">
<li><p>Crea un nuevo repositorio en Github (llamado <code>repo-github-2</code>) donde habr√° alojado con proyecto de R.</p></li>
<li><p>Crea un proyecto en <code>RStudio</code> que se llame (por ejemplo) <code>proyecto-qmd</code></p></li>
<li><p>Una vez dentro del proyecto en <code>RStudio</code> haz click en <code>File &lt; New File &lt; Quarto Document</code></p></li>
</ol>
</div><div class="column" style="width:40%;">
<p><img data-src="./img/primer-qmd.png"></p>
</div>
</div>
<p>Deber√°s tener un documento similar a este: un <span class="hl-yellow"><strong>quarto markdown (.qmd)</strong></span>, un documento que nos permitir√° incluir <span class="hl-yellow"><strong>markdown + c√≥digo</strong></span> (puede ser <code>R</code> o puede ser <code>Observable</code>, <code>D3</code>, etc).</p>
</section>
<section id="repo-con-rmdqmd-1" class="slide level2">
<h2>Repo con rmd/qmd</h2>
<p>Este formato es ideal para:</p>
<ul>
<li><span class="hl-yellow"><strong>Trabajar en equipo</strong></span> construyendo el borrador de una pieza.</li>
<li>Tomar <span class="hl-yellow"><strong>apuntes o informes</strong></span> para uno mismo.</li>
<li><span class="hl-yellow"><strong>Presentar</strong></span> tu trabajo a tus compa√±eros.</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/prueba-qmd-html.png"></p>
</div><div class="column" style="width:50%;">
<p>Si te fijas ahora nuestro repositorio tiene un archivo con formato <code>.html</code>‚Ä¶es decir‚Ä¶</p>
<p><span class="hl-yellow"><strong>¬°Es una web!</strong></span></p>
</div>
</div>
</section>
<section id="github-pages" class="slide level2">
<h2>Github pages</h2>
<p>¬øC√≥mo <span class="hl-yellow"><strong>convertir nuestro repositorio en una web</strong></span>?</p>

<img data-src="./img/github-pages.png" class="r-stretch"><ol type="1">
<li>Haz click en <code>Settings</code></li>
<li>Ve al apartado <code>Pages</code></li>
<li>En el subapartado <code>branch</code> selecciona la √∫nica rama que tenemos ahora (<code>main</code>)</li>
<li>Selecciona la carpeta donde tengas el <code>.html</code> (en web complejas estar√° como en cualquier web en <code>docs</code>, en algo simple estar√° en la ruta raiz del repositorio)</li>
<li>Haz click en <code>Save</code></li>
</ol>
</section>
<section id="github-pages-1" class="slide level2">
<h2>Github pages</h2>
<p>Si te fijas en la <span class="hl-yellow"><strong>parte superior del repositorio</strong></span> ahora tenemos un icono naranja, que nos indica que la <span class="hl-orange"><strong>web est√° en proceso de ser desplegada (deploy)</strong></span></p>

<img data-src="./img/github-naranja.png" class="r-stretch"></section>
<section id="github-pages-2" class="slide level2">
<h2>Github pages</h2>
<p>Pasados unos segundos (dependiendo del tama√±o de la web y tu conexi√≥n a internet) ese <span class="hl-green"><strong>icono pasar√° a ser un check verde</strong></span>: habemus web</p>

<img data-src="./img/github-verde.png" class="r-stretch"><p>El <span class="hl-yellow"><strong>link de la web por defecto</strong></span> ser√° <code>{nombre_usuario}.github.io/{nombre_repo}</code></p>
</section>
<section id="github-pages-3" class="slide level2">
<h2>Github pages</h2>

<img data-src="./img/github-pages-deploy.png" class="r-stretch"><p>¬°Un momento! Ahora mismo nuestra web <span class="hl-red"><strong>no nos est√° mostrando nuestro .qmd</strong></span>, sino por defecto el <span class="hl-yellow"><strong>README.md</strong></span>.</p>
<div class="fragment">
<p>Para que Github entienda que queremos visualizar ese <code>.html</code> que hemos generado a partir del <code>.qmd</code> vamos en nuestro proyecto local a <span class="hl-yellow"><strong>borrar</strong></span> todo lo que no sea nuestro archivo <code>.Rproj</code> y nuestro archivo <code>.qmd</code>, y vamos a <span class="hl-yellow"><strong>cambiar el nombre</strong></span> a este √∫ltimo llam√°ndolo <code>index.qmd</code>, y volvemos a compilarlo para <span class="hl-yellow"><strong>generar un index.html</strong></span></p>
</div>
</section>
<section id="github-pages-4" class="slide level2">
<h2>Github pages</h2>
<p>Vamos a <span class="hl-yellow"><strong>subir a Github ese nuevo proyecto</strong></span> con el cambio de nombre (llamado <code>repo-github-3</code>) para ver luego las diferencias entre uno y otro</p>

<img data-src="./img/repo-index-html.png" class="r-stretch"></section>
<section id="github-pages-5" class="slide level2">
<h2>Github pages</h2>
<p>Si <span class="hl-yellow"><strong>repetimos el proceso para hacer una Page</strong></span> y esperamos al tick verde‚Ä¶</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="./img/index-html-qmd.png"></p>
</div><div class="column" style="width:50%;">
<p>Si a tu <code>.qmd</code> ya le llamas de inicio <code>index.qmd</code>, autom√°ticamente, al detectar Github un <code>index.html</code>, interpreta que ese <span class="hl-yellow"><strong>archivo index.html</strong></span> es el que define la web (y puedes personalizar a√±adiendo un archivo <code>css</code> de estilos)</p>
<p><span class="hl-green"><strong>Habemus web</strong></span> simplemente clickando en Pages :)</p>
</div>
</div>
</section>
<section id="repo-con-diapositivas" class="slide level2">
<h2>Repo con diapositivas</h2>
<p>Vamos a crear el √∫ltimo repositorio que se llamar√° <code>repo-diapos</code>, y crear un proyecto en <code>RStudio</code> del mismo nombre (por ejemplo). Una vez creado le daremos a <code>File &lt; New File &lt; Quarto Presentation</code>.</p>
<div class="columns">
<div class="column" style="width:45%;">
<p><img data-src="img/quarto-slides.png"></p>
</div><div class="column" style="width:55%;">
<p>La forma de escribir ser√° igual que un <code>.qmd</code> normal solo que ahora <span class="hl-yellow"><strong>cada diapositiva la separaremos</strong></span> con un <code>---</code> (usando archivos de estilos podemos personalizar lo que queramos)</p>
<p>Llama al archivo directamente <code>index.qmd</code>, s√∫belo a Github y con un click en Pages tienes una <span class="hl-yellow"><strong>web con tus diapositivas</strong></span></p>
</div>
</div>
</section>
<section id="uso-de-gitkraken" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>La forma m√°s <span class="hl-yellow"><strong>sencilla para trabajar de manera colaborativa</strong></span> en Github, y tenerlo sincronizado con nuestro local, es hacer uso de <a href="https://www.gitkraken.com/download">Gitkraken</a></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/gitkraken-repo.png"></p>
</div><div class="column" style="width:50%;">
<p>Una vez dentro clickamos en el icono de la carpeta (<code>Repo Management</code>) y si ya tenemos el repositorio en Github seleccionamos <code>Clone</code>, indicando donde queremos clonar (en nuestro local) y que <span class="hl-yellow"><strong>repositorio de Github queremos clonar</strong></span>.</p>
</div>
</div>
</section>
<section id="uso-de-gitkraken-1" class="slide level2">
<h2>Uso de Gitkraken</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/view-change.png"></p>
</div><div class="column" style="width:50%;">
<p>Una vez clonado, la idea es que cada <span class="hl-yellow"><strong>cambio que hagamos en local nos aparecer√° en Gitkraken</strong></span> como <code>View changes</code>.</p>
</div>
</div>
</section>
<section id="uso-de-gitkraken-2" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Cuando tengas suficientes cambios como para <span class="hl-yellow"><strong>actualizar el repositorio</strong></span> (tampoco tiene sentido actualizar con cada edici√≥n), ver√°s algo similar a esto con todos los <span class="hl-yellow"><strong>commits realizados</strong></span></p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/stage-all-changes.png"></p>
</div><div class="column" style="width:50%;">
<p>Podr√°s decidir cu√°les de los <span class="hl-yellow"><strong>commits locales quieres incluir en remoto</strong></span>, bien uno a uno o en <code>Stage all changes</code> (para todos)</p>
</div>
</div>
</section>
<section id="uso-de-gitkraken-3" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Tras incluir los commits deber√°s incluir un <span class="hl-yellow"><strong>t√≠tulo y descripci√≥n del commit</strong></span></p>

<img data-src="img/titulo-commit.png" class="r-stretch"></section>
<section id="uso-de-gitkraken-4" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Tras hacerlo ver√°s que ahora tenemos <span class="hl-yellow"><strong>dos iconos separados en una especie de √°rbol</strong></span> (¬øte acuerdas de la <code>branch</code> o rama?):</p>
<ul>
<li><p><span class="hl-purple"><strong>Ordenador</strong></span>: la versi√≥n del repositorio que tienes en tu <span class="hl-yellow"><strong>ordenador</strong></span>.</p></li>
<li><p><span class="hl-purple"><strong>Logo</strong></span>: la versi√≥n del repositorio que tienes <span class="hl-yellow"><strong>subida en remoto</strong></span></p></li>
</ul>

<img data-src="img/split-gitkraken.png" class="r-stretch"></section>
<section id="uso-de-gitkraken-5" class="slide level2">
<h2>Uso de Gitkraken</h2>
<p>Mientras eso suceda solo tendr√°s sincronizado tu ordenador con Gitkraken, pero no con Github. Para ello haremos <span class="hl-yellow"><strong>click en Push</strong></span> (con <code>Pull</code> podr√°s forzar a tener en local lo mismo que en remoto).</p>

<img data-src="img/push-gitkraken.png" class="r-stretch"></section>
<section id="branchs" class="slide level2">
<h2>Branchs</h2>
<p>Como hemos mencionado ya en varias ocasiones, hay un elefante en la habitaci√≥n que a√∫n no hemos mentado: las <span class="hl-yellow"><strong>ramas o branchs</strong></span> de un repositorio.</p>
<div class="fragment">
<p>Imagina que est√°is trabajando varios en un proyecto y tene√≠s una versi√≥n que funciona pero que quer√©is <span class="hl-yellow"><strong>modificar en paralelo a partir del estado actual</strong></span> del repositorio.</p>
</div>
<div class="fragment">
<p>Las <span class="hl-yellow"><strong>ramas</strong></span> nos permiten partir de una versi√≥n com√∫n del repositorio y hacer cambios que <span class="hl-yellow"><strong>no afecten a los dem√°s</strong></span></p>
</div>
</section>
<section id="branchs-1" class="slide level2">
<h2>Branchs</h2>
<p>Para <span class="hl-yellow"><strong>crear una rama</strong></span> a partir del estado actual de repositorio haremos click en <code>Branch</code> y le pondremos un nombre</p>

<img data-src="img/branch-button.png" class="r-stretch"><p>Una vez creada ver√°s <span class="hl-yellow"><strong>dos iconos</strong></span> y un <span class="hl-yellow"><strong>men√∫ desplegable</strong></span> con las distintas ramas en las que quieres hacer el commit. Imagina que realizas un cambio pero <span class="hl-yellow"><strong>no quieres a√±adirlo a la rama principal</strong></span>: puedes hacer el <span class="hl-yellow"><strong>commit en tu rama propia en LOCAL</strong></span> (lo har√°s en la rama activa de tu men√∫ de branchs).</p>
</section>
<section id="branchs-2" class="slide level2">
<h2>Branchs</h2>
<p>La primera vez te pedir√° que escribas la <span class="hl-yellow"><strong>rama en REMOTO</strong></span> con la quieres sincronizar tu rama en local. <span class="hl-green"><strong>Consejo</strong></span>: ponle el mismo nombre en remoto que en local.</p>

<img data-src="img/name-branch.png" class="r-stretch"></section>
<section id="branchs-3" class="slide level2">
<h2>Branchs</h2>
<p>F√≠jate que ahora tenemos el ordenador y el logo en el mismo sitio. Esto no significa que tengas ambas ramas en tu local, solo que <span class="hl-yellow"><strong>Gitkraken tiene ambas sincronizadas</strong></span>: clickando en cualquiera de ellas, tus archivos en tu ordenador cambiar√°n.</p>

<img data-src="img/both-branchs.png" class="r-stretch"></section>
<section id="pull-request" class="slide level2">
<h2>Pull request</h2>
<p>Lo m√°s recomendable es que <span class="hl-yellow"><strong>solo se incorpore de una rama secundaria</strong></span> a la rama principal aquello que est√° <span class="hl-yellow"><strong>validado por un/a coordinador/a</strong></span> del repositorio, asegur√°ndose que todo funciona correctamente.</p>
<p>Cuando queramos incluirlo haremos <span class="hl-yellow"><strong>click con bot√≥n derecho</strong></span> en el icono de la rama secundaria y seleccionamos <code>Start a pull request to origin from...</code></p>

<img data-src="img/pull-request-menu.png" class="r-stretch"><div class="fragment">
<p>Una <span class="hl-yellow"><strong>pull request</strong></span> ser√° una <span class="hl-yellow"><strong>petici√≥n al responsable de la rama principal</strong></span> para incluir los cambios</p>
</div>
</section>
<section id="pull-request-1" class="slide level2">
<h2>Pull request</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p><img data-src="img/create-pull-request.png"></p>
</div><div class="column" style="width:40%;">
<p>En el cuadro que no se abre deberemos escribir:</p>
<ul>
<li>La <span class="hl-yellow"><strong>rama</strong></span> a la que hacer el <code>merge</code> (normalmente la <code>main</code>)</li>
<li>T√≠tulo y resumen de los cambios</li>
<li>Puedes incluso asignar un <span class="hl-yellow"><strong>revisor</strong></span> entre los colaboradores del repo.</li>
<li>Puedes asignar <span class="hl-yellow"><strong>etiquetas</strong></span></li>
</ul>
</div>
</div>
</section>
<section id="pull-request-2" class="slide level2">
<h2>Pull request</h2>
<p>Mientras no se acepte aparecer√° un <span class="hl-yellow"><strong>icono de rama</strong></span> y un +1 en Pull Requests</p>
<p><img data-src="img/pending-branch.png" width="500"></p>
<div class="fragment">
<p>Si somos al mantenedor del repositorio, haciendo click en el men√∫ nos saldr√°n las ramas que nos quieren hacer hacer <code>merge</code></p>
<p><img data-src="img/menu-pr.png" width="500"></p>
</div>
</section>
<section id="pull-request-3" class="slide level2">
<h2>Pull request</h2>
<p>Al hacer click se abrir√° un <span class="hl-yellow"><strong>cuadro de Pull Request</strong></span> para decidir si</p>
<ul>
<li><span class="hl-yellow"><strong>Revisar</strong></span> los cambios</li>
<li><span class="hl-yellow"><strong>Aprobar</strong></span> el <code>merge</code></li>
<li><span class="hl-yellow"><strong>A√±adir comentarios</strong></span> al que ha solicitado el <code>merge</code> por si queremos solicitar alg√∫n cambio <span class="hl-yellow"><strong>antes de ser aprobado</strong></span></li>
</ul>
</section>
<section id="section-4" class="slide level2">
<h2><img data-src="img/menu-pr-2.png"></h2>
</section>
<section id="pull-request-4" class="slide level2">
<h2>Pull request</h2>
<p>Tras revisar todo y aprobarlo clickaremos en <code>Confirm merge</code>, y tras ello podremos decidir si esa rama que era paralela a la principal la queremos <span class="hl-yellow"><strong>eliminar</strong></span> o dejar visible a todos (consejo: dejar visible para tene <span class="hl-yellow"><strong>trazabilidad</strong></span> del proyecto de trabajo)</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/merge-branch.png"></p>
</div><div class="column" style="width:50%;">
<p><img data-src="img/delete-branch.png"></p>
</div>
</div>
<div class="footer footer-default">
<p><a href="..."><strong>Javier √Ålvarez Li√©bana</strong></a> ‚Ä¢ Grado en Ciencia de Datos Aplicada (UCM) ‚Ä¢ curso 2023-2024</p>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="index_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="index_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"normal"},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"1686123117478505345","id":"1b0ff0461e955904","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>